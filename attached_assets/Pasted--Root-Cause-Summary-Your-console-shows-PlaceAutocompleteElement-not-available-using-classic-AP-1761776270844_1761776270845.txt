ğŸ” Root Cause Summary

Your console shows:

PlaceAutocompleteElement not available, using classic API: InvalidValueError: Unknown property 'fields'
Youâ€™re calling a legacy API, which is not enabled for your project. 
To get newer features and more functionality, switch to the Places API (New)


ğŸ‘‰ That means your app is still using legacy Places endpoints â€” and your Google Cloud project doesnâ€™t have the â€œPlaces API (New)â€ enabled.

ğŸš¨ 1. The Immediate Fix
Step 1 â€” Enable the correct APIs in Google Cloud

Go to Google Cloud Console â†’ APIs & Services â†’ Library

âœ… Make sure these are enabled:

Maps JavaScript API

Places API (New) â† this is the crucial one
(âš ï¸ â€œPlaces APIâ€ â‰  â€œPlaces API (New)â€)

Geocoding API (optional, but good to have)

Step 2 â€” Remove the fields property

In your GooglePlacesAutocomplete.tsx, you still have:

const autocomplete = new PlaceAutocompleteElement({
  componentRestrictions: { country: ['us', 'ca'] },
  fields: ['formattedAddress', 'location', 'displayName'], // âŒ invalid
});


âœ… Change to:

const autocomplete = new PlaceAutocompleteElement({
  componentRestrictions: { country: ['us', 'ca'] },
});

Step 3 â€” Use the correct event name

Replace:

autocomplete.addEventListener('gmp-placeselect', async (event: any) => {


âœ… With:

autocomplete.addEventListener('gmpx-placechange', async (event: any) => {

Step 4 â€” Use updated script loader

Your script URL is correct but ensure it loads after the DOM and with proper params:

script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&v=weekly&libraries=places&loading=async`;


âœ… The key must belong to a project where â€œPlaces API (New)â€ is enabled.

Step 5 â€” Deploy HTTPS / non-sandbox URL

Youâ€™re running inside:

https://d46b7393-caba-4efd-9d61-5fc30f617148-00-2s7j2l715e34a.janeway.replit.dev/


Googleâ€™s Places components often fail in sandboxed or preview environments (like Replit dev domains), especially with service workers.
âœ… Test from a live deployed HTTPS domain or localhost (http://localhost:5173 etc.) instead of Replit preview.

âš™ï¸ 2. Why the â€œlegacy APIâ€ error appears

Your app tried to fall back to this line:

new google.maps.places.Autocomplete(...)


That class is now deprecated for new customers (as of March 1, 2025).
Because your project is new, it only supports PlaceAutocompleteElement (the new web component).

âœ… Solution:
Delete the fallback (initClassicAutocomplete()) from your file.
Use only the PlaceAutocompleteElement path.

ğŸ§© 3. Optional: Confirm youâ€™re using â€œPlaces API (New)â€

In Cloud Console â†’ Dashboard â†’ APIs & Services, it should list:

Places API (New) â€” not just Places API

If you only see the old one:

Disable it

Enable the â€œNewâ€ version

Regenerate your API key or remove key restrictions temporarily to test

âœ… 4. After applying these

Once the new API is active and your code cleaned up:

The InvalidValueError: Unknown property 'fields' will disappear

The LegacyApiNotActivatedMapError will disappear

The autocomplete input will render correctly and show address predictions