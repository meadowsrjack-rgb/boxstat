Last login: Wed Dec  3 11:56:27 on ttys000
jackmeadows@Jacks-MacBook-Air ~ % grep "Account Manager" ~/Documents/boxstat/ios/App/App/public/assets/*.js
jackmeadows@Jacks-MacBook-Air ~ % rm -rf ~/Library/Developer/Xcode/DerivedData/App-*
jackmeadows@Jacks-MacBook-Air ~ % grep -o ".{50}Who.*BoxStat.{100}" ~/Documents/boxstat/ios/App/App/public/assets/*.js 2>/dev/null || grep "Who's Using" ~/Documents/boxstat/ios/App/App/public/assets/*.js
/Users/jackmeadows/Documents/boxstat/ios/App/App/public/assets/index-BnVbWN2e.js:                  `,onClick:()=>T(ae),children:[Yn(ae,"d"),pe&&s.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1.5 h-1.5 bg-red-500 rounded-full"})]},oe)})})]})]}),t&&s.jsx(Ly,{event:f,userId:t.id,userRole:t.role,open:y,onOpenChange:x})]})}function F_e(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[r,i]=j.useState(""),[a,o]=j.useState(null),l=j.useRef(null),{data:c}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"team"],enabled:!!(e!=null&&e.id)}),{data:d=[]}=Ge({queryKey:["/api/teams",c==null?void 0:c.id,"messages"],enabled:!!(c!=null&&c.id)}),{data:u=[]}=Ge({queryKey:["/api/teams",c==null?void 0:c.id,"players"],enabled:!!(c!=null&&c.id)}),h=ot({mutationFn:async y=>{await bt("POST","/api/messages",y)},onSuccess:()=>{i(""),n.invalidateQueries({queryKey:["/api/teams",c==null?void 0:c.id,"messages"]})},onError:y=>{t({title:"Error",description:"Failed to send message",variant:"destructive"})}});j.useEffect(()=>{if(!e||!c)return;let y=null;const x=()=>{try{const g=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;y=new WebSocket(g),y.onopen=()=>{console.log("Connected to WebSocket"),y&&(e!=null&&e.id)&&(y.send(JSON.stringify({type:"join",userId:e.id})),o(y))},y.onmessage=v=>{try{JSON.parse(v.data).type==="message"&&(c!=null&&c.id)&&n.invalidateQueries({queryKey:["/api/teams",c.id,"messages"]})}catch(_){console.error("Failed to parse WebSocket message:",_)}},y.onclose=v=>{console.log("Disconnected from WebSocket",v.code,v.reason),o(null),v.code!==1e3&&v.code!==1001&&(console.log("Attempting to reconnect in 5 seconds..."),setTimeout(x,5e3))},y.onerror=v=>{console.error("WebSocket error:",v),o(null)}}catch(b){console.error("Failed to create WebSocket connection:",b),o(null)}};return x(),()=>{y&&y.close(1e3,"Component unmounting")}},[e,c,n]),j.useEffect(()=>{var y;(y=l.current)==null||y.scrollIntoView({behavior:"smooth"})},[d]);const f=()=>{if(!r.trim()||!c)return;const y={content:r,teamId:c==null?void 0:c.id,messageType:"text"};a&&a.send(JSON.stringify({type:"message",senderId:e==null?void 0:e.id,...y})),h.mutate(y)};if(!e||!c)return s.jsx("div",{children:"Loading..."});const m=(e==null?void 0:e.userType)==="player";return s.jsxs("div",{className:`scrollable-page safe-bottom ${m?"bg-gradient-to-br from-green-500 to-blue-600":"bg-gray-50"}`,children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ga,{href:"/",children:s.jsx(te,{variant:"ghost",size:"icon",className:"mr-2",children:s.jsx(vn,{className:"h-5 w-5"})})}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3",style:{backgroundColor:c.color},children:s.jsx(xa,{className:"h-5 w-5 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-lg font-bold text-gray-900",children:[c.name," Chat"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[u==null?void 0:u.length," members online"]})]})]})]}),s.jsxs(et,{variant:"outline",className:"flex items-center",children:[s.jsx(vs,{className:"h-3 w-3 mr-1"}),u==null?void 0:u.length]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsxs(ye,{className:"hidden lg:block",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-sm",children:"Team Members"})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-3",children:u==null?void 0:u.map(y=>{var x,b;return s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(wr,{className:"h-8 w-8",children:[s.jsx(Ur,{src:y.profileImageUrl}),s.jsxs(br,{className:"text-xs",children:[(x=y.firstName)==null?void 0:x[0],(b=y.lastName)==null?void 0:b[0]]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[y.firstName," ",y.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:y.userType==="player"?"Player":"Coach"})]}),y.id===e.id&&s.jsx(et,{variant:"secondary",className:"text-xs",children:"You"})]},y.id)})})})]}),s.jsxs(ye,{className:"lg:col-span-3",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(xa,{className:"h-5 w-5 mr-2"}),"Team Chat"]})}),s.jsxs(we,{className:"p-0",children:[s.jsxs("div",{className:"h-96 overflow-y-auto p-4 space-y-4",children:[d==null?void 0:d.map(y=>{var g,v;const x=y.senderId===e.id,b=u==null?void 0:u.find(_=>_.id===y.senderId);return s.jsx("div",{className:`flex ${x?"justify-end":"justify-start"}`,children:s.jsxs("div",{className:`flex space-x-2 max-w-xs ${x?"flex-row-reverse space-x-reverse":""}`,children:[s.jsxs(wr,{className:"h-6 w-6",children:[s.jsx(Ur,{src:b==null?void 0:b.profileImageUrl}),s.jsxs(br,{className:"text-xs",children:[(g=b==null?void 0:b.firstName)==null?void 0:g[0],(v=b==null?void 0:b.lastName)==null?void 0:v[0]]})]}),s.jsxs("div",{className:`rounded-lg px-3 py-2 ${x?"bg-primary text-primary-foreground":"bg-gray-100 text-gray-900"}`,children:[s.jsx("p",{className:"text-sm",children:y.content}),s.jsx("p",{className:`text-xs mt-1 ${x?"text-primary-foreground/70":"text-gray-500"}`,children:Yn(new Date(y.createdAt),"h:mm a")})]})]})},y.id)}),s.jsx("div",{ref:l})]}),s.jsx("div",{className:"border-t p-4",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(qe,{value:r,onChange:y=>i(y.target.value),placeholder:m?"Type a message! ðŸ˜Š":"Type a message...",onKeyPress:y=>{y.key==="Enter"&&f()},className:"flex-1"}),m&&s.jsx(te,{variant:"outline",size:"icon",children:s.jsx(Tne,{className:"h-4 w-4"})}),s.jsx(te,{onClick:f,disabled:!r.trim()||h.isPending,className:m?"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700":"",children:s.jsx(By,{className:"h-4 w-4"})})]})})]})]})]})})]})}const T_e=q.object({email:q.string().email("Valid email is required")}),I_e=q.object({registrationType:q.enum(["myself","my_child"])}),L_e=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required"),email:q.string().email("Valid email is required"),phoneNumber:q.string().optional(),dateOfBirth:q.string().optional()}),U_e=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required"),dateOfBirth:q.string().optional(),gender:q.string().optional()}),D_e=q.object({password:q.string().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[0-9!@#$%^&*]/,"Password must contain at least one number or symbol"),confirmPassword:q.string(),acceptTerms:q.boolean().refine(e=>e===!0,"You must accept the terms and conditions"),marketingOptIn:q.boolean().optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function WL(){const[,e]=Wt(),{toast:t}=Tt(),n=new URLSearchParams(window.location.search),r=n.get("email"),i=n.get("verified")==="true",[a,o]=j.useState(r&&i?2:1),[l,c]=j.useState(!1),[d,u]=j.useState({email:r||void 0,players:[]}),h=d.registrationType==="my_child"?5:4,f=ot({mutationFn:async g=>await bt("/api/registration/complete",{method:"POST",data:g.data}),onSuccess:async(g,v)=>{const{password:_}=v,B=v.data.email;try{(await bt("/api/auth/login",{method:"POST",data:{email:B,password:_}})).success&&(t({title:"Registration Complete!",description:"Welcome! Redirecting to your account..."}),setTimeout(()=>{window.location.href="/account"},1e3))}catch{t({title:"Registration Successful!",description:"Please login to access your account."}),e("/login")}},onError:g=>{t({title:"Registration Failed",description:g.message||"Something went wrong. Please try again.",variant:"destructive"})}}),m=()=>{a<h&&o(a+1)},y=()=>{a>1&&o(a-1)},x=g=>{const v={...d,password:g.password,acceptTerms:g.acceptTerms,marketingOptIn:g.marketingOptIn};f.mutate({data:v,password:g.password})},b=()=>a===1?"Enter Your Email":a===2?"Who are you registering for?":a===3&&d.registrationType==="myself"?"Your Information":a===3&&d.registrationType==="my_child"?"Parent/Guardian Information":a===4&&d.registrationType==="my_child"?"Player Information":a===4&&d.registrationType==="myself"||a===5&&d.registrationType==="my_child"?"Create Account":"Email Verification";return s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-br from-gray-900 via-gray-800 to-black safe-bottom",children:[s.jsx("div",{className:"absolute top-6 left-6 safe-top z-10",children:s.jsx("button",{onClick:()=>a===1?e("/"):y(),className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 transition-colors","data-testid":"button-back",children:s.jsx(wa,{className:"w-5 h-5 text-white"})})}),s.jsx("div",{className:"flex flex-col min-h-screen-safe px-8 py-16 safe-top",children:s.jsxs("div",{className:"w-full max-w-lg mx-auto flex-1 flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8 pt-8",children:[s.jsx("div",{className:"flex gap-2 flex-1",children:Array.from({length:h}).map((g,v)=>s.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${v+1<=a?"bg-red-500":"bg-white/20"}`,"data-testid":`progress-step-${v+1}`},v))}),s.jsxs("span",{className:"text-sm text-gray-400 ml-4","data-testid":"step-counter",children:[a,"/",h]})]}),s.jsx("h1",{className:"text-3xl font-bold text-white mb-8 tracking-tight",children:b()}),s.jsxs("div",{className:"flex-1",children:[a===1&&!l&&s.jsx(Q_e,{onSubmit:(g,v)=>{u({...d,email:g.email,emailCheckData:v}),c(!0)}}),a===1&&l&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"mx-auto w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mb-6",children:s.jsx($i,{className:"w-10 h-10 text-red-500"})}),s.jsx("h3",{className:"text-2xl font-semibold text-white mb-3",children:"Check Your Email"}),s.jsx("p",{className:"text-gray-400 mb-2",children:"We sent a verification link to"}),s.jsx("p",{className:"text-white font-medium mb-6",children:d.email}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Please click the link in your email to verify your account and continue with registration."}),s.jsx("p",{className:"text-gray-600 text-xs mt-4",children:"Don't see it? Check your spam folder."})]}),a===2&&s.jsx(M_e,{email:d.email,emailCheckData:d.emailCheckData,onSubmit:g=>{u({...d,registrationType:g.registrationType}),m()}}),a===3&&d.registrationType==="myself"&&s.jsx(QZ,{email:d.email,emailCheckData:d.emailCheckData,onSubmit:g=>{u({...d,players:[{...g,id:"player-1"}]}),m()},isSelf:!0}),a===3&&d.registrationType==="my_child"&&s.jsx(R_e,{email:d.email,emailCheckData:d.emailCheckData,onSubmit:g=>{u({...d,parentInfo:g}),m()}}),a===4&&d.registrationType==="my_child"&&s.jsx(O_e,{players:d.players,onUpdate:g=>{u({...d,players:g})},onNext:m}),(a===4&&d.registrationType==="myself"||a===5&&d.registrationType==="my_child")&&s.jsx(H_e,{onSubmit:x,isLoading:f.isPending}),a>h&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"mx-auto w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-6",children:s.jsx(vc,{className:"w-10 h-10 text-green-500"})}),s.jsx("h3",{className:"text-2xl font-semibold text-white mb-3",children:"Check Your Email"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"A verification link has been sent to your email address. Please click the link to verify your account and complete registration."}),s.jsx(te,{onClick:()=>e("/login"),className:"bg-red-600 hover:bg-red-700","data-testid":"button-go-to-login",children:"Go to Login"})]})]}),a<=h&&s.jsx("div",{className:"mt-8 text-center",children:s.jsx("button",{onClick:()=>e("/privacy-policy"),className:"text-gray-500 text-xs hover:text-gray-400 underline transition-colors","data-testid":"link-privacy-policy",children:"Privacy Policy"})})]})})]})}function Q_e({onSubmit:e}){var d;const{toast:t}=Tt(),[n,r]=j.useState(null),[i,a]=j.useState(!1),o=Dr({resolver:Qr(T_e),defaultValues:{email:""}}),l=async u=>{if(!u||!u.includes("@"))return null;a(!0);try{const h=await bt("/api/registration/check-email",{method:"POST",data:{email:u,organizationId:"default-org"}});return h.exists&&h.stripeCustomer?(r(h),t({title:"Welcome Back!",description:"We found your account and payment history."})):h.exists?(r({exists:!0,hasRegistered:h.hasRegistered}),t({title:"Account Found",description:h.hasRegistered?"We found your account.":"Email exists in our system."})):r(null),h}catch(h){return console.error("Error checking email:",h),null}finally{a(!1)}},c=async u=>{var f;const h=await l(u.email);try{(await bt("/api/auth/send-verification",{method:"POST",data:{email:u.email,organizationId:"default-org"}})).success&&t({title:"Verification Email Sent!",description:"Please check your inbox and verify your email before completing registration."})}catch(m){if((f=m.message)!=null&&f.includes("already registered")){t({title:"Email Already Registered",description:"This email is already verified. Please login instead.",variant:"destructive"});return}console.error("Error sending verification:",m)}e(u,h)};return s.jsx(Mr,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(c),className:"space-y-6",children:[s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Please enter your email address to get started. We'll check if you have an existing account with us."}),s.jsx(it,{control:o.control,name:"email",render:({field:u})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Email Address"}),s.jsx(ut,{children:s.jsx(qe,{...u,type:"email",placeholder:"your@email.com","data-testid":"input-email",disabled:i,className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"})}),s.jsx(ft,{className:"text-red-400"})]})}),(n==null?void 0:n.exists)&&s.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:[s.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"Account Found"}),n.hasRegistered&&s.jsx("p",{className:"text-sm text-blue-300",children:"This email is already registered in our system."}),n.stripeCustomer&&s.jsxs("div",{className:"mt-3 space-y-2",children:[s.jsx("h5",{className:"font-medium text-blue-300 text-sm",children:"Payment History:"}),((d=n.activeSubscriptions)==null?void 0:d.length)>0&&s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-medium text-green-400",children:"Active Subscriptions:"}),s.jsx("ul",{className:"list-disc list-inside ml-2 text-gray-300",children:n.activeSubscriptions.map((u,h)=>s.jsxs("li",{children:[u.product," - $",(u.amount/100).toFixed(2),"/",u.interval]},h))})]})]})]}),s.jsxs(te,{type:"submit",disabled:i,className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold","data-testid":"button-continue-email",children:[i?"Checking...":"Continue",s.jsx(Gs,{className:"ml-2 h-4 w-4"})]})]})})}function M_e({email:e,emailCheckData:t,onSubmit:n}){const r=Dr({resolver:Qr(I_e)});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-6",children:[e&&s.jsx("div",{className:"p-3 bg-white/5 border border-white/10 rounded-xl",children:s.jsxs("p",{className:"text-sm text-gray-400",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"})," ",s.jsx("span",{className:"text-white",children:e})]})}),(t==null?void 0:t.exists)&&s.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:s.jsx("p",{className:"text-sm text-blue-300",children:t.hasRegistered?"We found your existing account. Continue to add a new registration.":"Email found in our system. Continue to complete your registration."})}),s.jsx(it,{control:r.control,name:"registrationType",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(ut,{children:s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsx("button",{type:"button",onClick:()=>{i.onChange("myself"),r.handleSubmit(n)()},className:`p-6 border-2 rounded-2xl transition-all text-left ${i.value==="myself"?"border-red-500 bg-red-500/10":"border-white/10 bg-white/5 hover:border-white/30"}`,"data-testid":"option-myself",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center ${i.value==="myself"?"bg-red-500/20":"bg-white/10"}`,children:s.jsx(Gu,{className:`w-7 h-7 ${i.value==="myself"?"text-red-500":"text-gray-400"}`})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg text-white mb-1",children:"Myself"}),s.jsx("p",{className:"text-sm text-gray-400",children:"I am registering for myself"})]})]})}),s.jsx("button",{type:"button",onClick:()=>{i.onChange("my_child"),r.handleSubmit(n)()},className:`p-6 border-2 rounded-2xl transition-all text-left ${i.value==="my_child"?"border-red-500 bg-red-500/10":"border-white/10 bg-white/5 hover:border-white/30"}`,"data-testid":"option-my-child",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center ${i.value==="my_child"?"bg-red-500/20":"bg-white/10"}`,children:s.jsx(vs,{className:`w-7 h-7 ${i.value==="my_child"?"text-red-500":"text-gray-400"}`})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg text-white mb-1",children:"My Child"}),s.jsx("p",{className:"text-sm text-gray-400",children:"I am registering my child or another player"})]})]})})]})}),s.jsx(ft,{className:"text-red-400"})]})})]})})}function R_e({email:e,emailCheckData:t,onSubmit:n}){var a;const r=((a=t==null?void 0:t.stripeCustomer)==null?void 0:a.prefillData)||{},i=Dr({resolver:Qr(L_e),defaultValues:{firstName:r.firstName||"",lastName:r.lastName||"",email:e||r.email||"",phoneNumber:r.phone||"",dateOfBirth:""}});return s.jsx(Mr,{...i,children:s.jsxs("form",{onSubmit:i.handleSubmit(n),className:"space-y-5",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"firstName",render:({field:o})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"First Name"}),s.jsx(ut,{children:s.jsx(qe,{...o,"data-testid":"input-parent-first-name",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(ft,{className:"text-red-400"})]})}),s.jsx(it,{control:i.control,name:"lastName",render:({field:o})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Last Name"}),s.jsx(ut,{children:s.jsx(qe,{...o,"data-testid":"input-parent-last-name",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(ft,{className:"text-red-400"})]})})]}),s.jsx(it,{control:i.control,name:"email",render:({field:o})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Email"}),s.jsx(ut,{children:s.jsx(qe,{...o,type:"email","data-testid":"input-parent-email",readOnly:!0,className:"h-12 bg-white/10 border-white/10 text-gray-400 cursor-not-allowed"})}),s.jsx(Fr,{className:"text-xs text-gray-500",children:"Email verified in previous step"}),s.jsx(ft,{className:"text-red-400"})]})}),(t==null?void 0:t.stripeCustomer)&&s.jsx("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-4 space-y-3","data-testid":"stripe-customer-info",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(vc,{className:"w-5 h-5 text-green-500 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-green-400",children:"Welcome Back!"}),s.jsx("p",{className:"text-sm text-green-300/80",children:"We found your payment history."})]})]})}),s.jsx(it,{control:i.control,name:"phoneNumber",render:({field:o})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Phone Number"}),s.jsx(ut,{children:s.jsx(qe,{...o,type:"tel","data-testid":"input-parent-phone",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})})]})}),s.jsx(it,{control:i.control,name:"dateOfBirth",render:({field:o})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Date of Birth"}),s.jsx(ut,{children:s.jsx(qe,{...o,type:"date","data-testid":"input-parent-dob",className:"h-12 bg-white/5 border-white/10 text-white focus:border-red-500"})})]})}),s.jsxs(te,{type:"submit",className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold mt-6","data-testid":"button-next",children:["Continue",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})})}function QZ({email:e,emailCheckData:t,onSubmit:n,isSelf:r}){var d;const i=((d=t==null?void 0:t.stripeCustomer)==null?void 0:d.prefillData)||{},[a,o]=j.useState(!1),l=Dr({resolver:Qr(U_e),defaultValues:{firstName:i.firstName||"",lastName:i.lastName||"",dateOfBirth:"",gender:""}}),c=l.watch("dateOfBirth");return j.useEffect(()=>{if(r&&c){const u=new Date(c),h=new Date;let f=h.getFullYear()-u.getFullYear();const m=h.getMonth()-u.getMonth();(m<0||m===0&&h.getDate()<u.getDate())&&f--,o(f<18)}else o(!1)},[c,r]),s.jsx(Mr,{...l,children:s.jsxs("form",{onSubmit:l.handleSubmit(n),className:"space-y-5",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:l.control,name:"firstName",render:({field:u})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"First Name"}),s.jsx(ut,{children:s.jsx(qe,{...u,"data-testid":"input-player-first-name",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(ft,{className:"text-red-400"})]})}),s.jsx(it,{control:l.control,name:"lastName",render:({field:u})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Last Name"}),s.jsx(ut,{children:s.jsx(qe,{...u,"data-testid":"input-player-last-name",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(ft,{className:"text-red-400"})]})})]}),s.jsx(it,{control:l.control,name:"dateOfBirth",render:({field:u})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Date of Birth"}),s.jsx(ut,{children:s.jsx(qe,{...u,type:"date","data-testid":"input-player-dob",className:"h-12 bg-white/5 border-white/10 text-white focus:border-red-500"})}),a&&s.jsxs("div",{className:"mt-2 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg","data-testid":"age-warning",children:[s.jsx("p",{className:"text-sm text-yellow-400 font-medium",children:"Players under 18 years old must have a parent or guardian register on their behalf."}),s.jsx("p",{className:"text-xs text-yellow-500/80 mt-1",children:`Please go back and select "I'm registering my child" to continue.`})]})]})}),s.jsx(it,{control:l.control,name:"gender",render:({field:u})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Gender"}),s.jsxs(Qt,{onValueChange:u.onChange,value:u.value,children:[s.jsx(ut,{children:s.jsx(Ut,{"data-testid":"select-player-gender",className:"h-12 bg-white/5 border-white/10 text-white focus:border-red-500",children:s.jsx(Mt,{placeholder:"Select gender"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"male",children:"Male"}),s.jsx(xe,{value:"female",children:"Female"}),s.jsx(xe,{value:"other",children:"Other"}),s.jsx(xe,{value:"prefer-not-to-say",children:"Prefer not to say"})]})]})]})}),s.jsxs(te,{type:"submit",disabled:a,className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold mt-6 disabled:opacity-50","data-testid":"button-next",children:["Continue",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})})}function O_e({players:e,onUpdate:t,onNext:n}){const[r,i]=j.useState(null),a=()=>{const c={id:`player-${Date.now()}`,firstName:"",lastName:"",dateOfBirth:"",gender:""};i(c)},o=c=>{if(r){const d={...r,...c},u=e.findIndex(h=>h.id===r.id);if(u>=0){const h=[...e];h[u]=d,t(h)}else t([...e,d]);i(null)}},l=c=>{t(e.filter(d=>d.id!==c))};return r?s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>i(null),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[s.jsx(wa,{className:"w-4 h-4 mr-1"}),"Back to player list"]}),s.jsx(QZ,{onSubmit:o})]}):s.jsxs("div",{className:"space-y-5",children:[s.jsx("div",{className:"space-y-3",children:e.map(c=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 border border-white/10 rounded-xl","data-testid":`player-card-${c.id}`,children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-white",children:[c.firstName," ",c.lastName]}),s.jsx("p",{className:"text-sm text-gray-400",children:c.dateOfBirth&&new Date(c.dateOfBirth).toLocaleDateString()})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{type:"button",size:"sm",variant:"ghost",onClick:()=>i(c),className:"text-gray-400 hover:text-white hover:bg-white/10","data-testid":`button-edit-player-${c.id}`,children:"Edit"}),s.jsx(te,{type:"button",size:"sm",variant:"ghost",onClick:()=>l(c.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","data-testid":`button-remove-player-${c.id}`,children:"Remove"})]})]},c.id))}),s.jsxs(te,{type:"button",variant:"outline",onClick:a,className:"w-full h-12 bg-transparent border-white/20 text-white hover:bg-white/10","data-testid":"button-add-player",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add Player"]}),s.jsxs(te,{type:"button",onClick:n,disabled:e.length===0,className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold disabled:opacity-50","data-testid":"button-next",children:["Continue",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})}function H_e({onSubmit:e,isLoading:t}){const[,n]=Wt(),r=Dr({resolver:Qr(D_e),defaultValues:{password:"",confirmPassword:"",acceptTerms:!1,marketingOptIn:!1}});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(e),className:"space-y-5",children:[s.jsx(it,{control:r.control,name:"password",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Password"}),s.jsx(ut,{children:s.jsx(qe,{...i,type:"password","data-testid":"input-password",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(Fr,{className:"text-xs text-gray-500",children:"Must be at least 8 characters with 1 uppercase letter and 1 number/symbol"}),s.jsx(ft,{className:"text-red-400"})]})}),s.jsx(it,{control:r.control,name:"confirmPassword",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-gray-300 text-sm font-medium",children:"Confirm Password"}),s.jsx(ut,{children:s.jsx(qe,{...i,type:"password","data-testid":"input-confirm-password",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500"})}),s.jsx(ft,{className:"text-red-400"})]})}),s.jsx(it,{control:r.control,name:"acceptTerms",render:({field:i})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0 py-2",children:[s.jsx(ut,{children:s.jsx(js,{checked:i.value,onCheckedChange:i.onChange,"data-testid":"checkbox-accept-terms",className:"border-white/30 data-[state=checked]:bg-red-500 data-[state=checked]:border-red-500"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsxs(at,{className:"text-gray-300 text-sm font-normal",children:["I accept the"," ",s.jsx("button",{type:"button",onClick:()=>n("/privacy-policy"),className:"text-red-400 hover:text-red-300 underline",children:"Terms and Conditions"})]}),s.jsx(ft,{className:"text-red-400"})]})]})}),s.jsx(it,{control:r.control,name:"marketingOptIn",render:({field:i})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0 py-2",children:[s.jsx(ut,{children:s.jsx(js,{checked:i.value,onCheckedChange:i.onChange,"data-testid":"checkbox-marketing",className:"border-white/30 data-[state=checked]:bg-red-500 data-[state=checked]:border-red-500"})}),s.jsx("div",{className:"space-y-1 leading-none",children:s.jsx(at,{className:"text-gray-300 text-sm font-normal",children:"I'd like to receive updates and promotional emails"})})]})}),s.jsx(te,{type:"submit",disabled:t,className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold mt-6","data-testid":"button-complete-registration",children:t?"Creating Account...":"Complete Registration"})]})})}function V_e(e,t,n,r,i){var d;if(!e||e.length===0)return{status:"inactive",plan:null};const a=e.filter(u=>{const h=t==null?void 0:t.find(f=>f.id===u.programId||f.id===u.packageId);if(u.userId===n)return!0;if(u.playerId)return u.playerId===n;if(r&&u.userId===r){const f=(h==null?void 0:h.billingModel)||(h==null?void 0:h.pricingModel),m=(f==null?void 0:f.toLowerCase().replace(/[-\s]/g,"_"))||"";return!!(m.includes("family")||m==="per_family"||m==="perfamily"||m.includes("organization")||m==="organization_wide"||i&&(u.programId===i||u.packageId===i)||!f)}return!1});if(a.length===0)return{status:"inactive",plan:null};const o=a.find(u=>u.status==="completed"||u.status==="active"||u.status==="paid");if(o){const u=t==null?void 0:t.find(f=>f.id===o.programId||f.id===o.packageId);return(u==null?void 0:u.type)==="Subscription"||(u==null?void 0:u.billingCycle)||((d=o.paymentType)==null?void 0:d.includes("subscription"))?{status:"active",plan:(u==null?void 0:u.name)||o.description||"Active Subscription"}:{status:"paid_one_time",plan:(u==null?void 0:u.name)||o.description||"One-Time Purchase"}}const l=a.find(u=>u.status==="past_due"||u.status==="expired"||u.status==="failed");if(l){const u=t==null?void 0:t.find(h=>h.id===l.programId||h.id===l.packageId);return{status:"overdue",plan:(u==null?void 0:u.name)||l.description||"Overdue Payment"}}const c=a.find(u=>u.status==="pending"||u.status==="processing");if(c){const u=t==null?void 0:t.find(h=>h.id===c.programId||h.id===c.packageId);return{status:"inactive",plan:(u==null?void 0:u.name)||"Pending Payment"}}return{status:"inactive",plan:null}}function K_e(e){switch(e){case"active":return"bg-green-500";case"overdue":return"bg-red-500";case"paid_one_time":return"bg-purple-500";case"inactive":default:return"bg-gray-300"}}function z_e(e){switch(e){case"active":return"Active";case"overdue":return"Overdue";case"paid_one_time":return"One-Time Paid";case"inactive":default:return"Inactive"}}function $_e(){const{data:e,isLoading:t,isError:n,error:r}=Ge({queryKey:["/api/payments/history"]});if(t)return s.jsx(ye,{"data-testid":"payment-history-loading",children:s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Payment History"}),s.jsx(zn,{children:"Loading your payment history..."})]})});if(n)return s.jsxs(ye,{"data-testid":"payment-history-error",children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Payment History"}),s.jsx(zn,{children:"Unable to load payment history"})]}),s.jsx(we,{children:s.jsx("p",{className:"text-sm text-red-600",children:r instanceof Error?r.message:"An error occurred while loading your payment history. Please try again later."})})]});if(!e||e.length===0)return s.jsxs(ye,{"data-testid":"payment-history-empty",children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Payment History"}),s.jsx(zn,{children:"No payments found"})]}),s.jsx(we,{children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your payment history will appear here after making your first payment."})})]});const i=e.filter(u=>{var h,f,m,y;return((h=u.stripeData)==null?void 0:h.type)==="subscription"&&(((f=u.stripeData)==null?void 0:f.status)==="active"||((y=(m=u.stripeData)==null?void 0:m.subscriptionDetails)==null?void 0:y.status)==="active")}),a=e.filter(u=>{var h;return!u.stripeData||((h=u.stripeData)==null?void 0:h.type)==="one_time"}),o=e.filter(u=>{var h,f,m,y;return((h=u.stripeData)==null?void 0:h.type)==="subscription"&&((f=u.stripeData)==null?void 0:f.status)!=="active"&&((y=(m=u.stripeData)==null?void 0:m.subscriptionDetails)==null?void 0:y.status)!=="active"}),l=u=>{switch(u){case"completed":case"paid":case"active":return s.jsx(Ra,{className:"h-4 w-4 text-green-600"});case"pending":return s.jsx(Ar,{className:"h-4 w-4 text-yellow-600"});case"failed":case"canceled":return s.jsx(rh,{className:"h-4 w-4 text-red-600"});default:return s.jsx(jd,{className:"h-4 w-4 text-gray-600"})}},c=u=>{const h={completed:"default",paid:"default",active:"default",pending:"secondary",failed:"destructive",canceled:"destructive",refunded:"outline"};return s.jsx(et,{variant:h[u]||"outline",className:"capitalize",children:u})},d=(u,h)=>new Intl.NumberFormat("en-US",{style:"currency",currency:h.toUpperCase()}).format(u/100);return s.jsxs("div",{className:"space-y-6","data-testid":"payment-history",children:[i.length>0&&s.jsxs(ye,{"data-testid":"active-subscriptions",children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Active Subscriptions"]}),s.jsx(zn,{children:"Your ongoing subscription payments"})]}),s.jsx(we,{className:"space-y-4",children:i.map(u=>{var m,y,x,b;const h=(m=u.stripeData)==null?void 0:m.subscriptionDetails,f=(h==null?void 0:h.currentPeriodEnd)||((y=u.stripeData)==null?void 0:y.currentPeriodEnd);return s.jsxs("div",{className:"flex flex-col gap-3 p-4 rounded-lg border bg-card","data-testid":`subscription-${u.id}`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold","data-testid":`subscription-description-${u.id}`,children:u.description||"Subscription"}),u.playerInfo&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(Us,{className:"h-3 w-3"}),s.jsxs("span",{"data-testid":`subscription-player-${u.id}`,children:[u.playerInfo.firstName," ",u.playerInfo.lastName]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-lg","data-testid":`subscription-amount-${u.id}`,children:d(u.amount,u.currency)}),(h==null?void 0:h.interval)&&s.jsxs("p",{className:"text-xs text-muted-foreground capitalize",children:["per ",h.interval]})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[l((h==null?void 0:h.status)||((x=u.stripeData)==null?void 0:x.status)||"active"),c((h==null?void 0:h.status)||((b=u.stripeData)==null?void 0:b.status)||"active")]}),(h==null?void 0:h.cancelAtPeriodEnd)&&s.jsx(et,{variant:"outline",className:"text-orange-600",children:"Cancels at period end"})]}),f&&s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[s.jsx(dr,{className:"h-3 w-3"}),s.jsxs("span",{children:["Renews ",Yn(new Date(f*1e3),"MMM dd, yyyy")]})]})]})]},u.id)})})]}),a.length>0&&s.jsxs(ye,{"data-testid":"one-time-payments",children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ih,{className:"h-5 w-5"}),"One-Time Payments"]}),s.jsx(zn,{children:"Your completed and pending payments"})]}),s.jsx(we,{className:"space-y-3",children:a.map((u,h)=>{var f;return s.jsxs("div",{children:[h>0&&s.jsx(Fl,{className:"my-3"}),s.jsxs("div",{className:"flex items-start justify-between","data-testid":`payment-${u.id}`,children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium","data-testid":`payment-description-${u.id}`,children:u.description||u.paymentType}),c(((f=u.stripeData)==null?void 0:f.status)||u.status)]}),u.playerInfo&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(Us,{className:"h-3 w-3"}),s.jsxs("span",{"data-testid":`payment-player-${u.id}`,children:[u.playerInfo.firstName," ",u.playerInfo.lastName]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Yn(new Date(u.createdAt),"MMM dd, yyyy Â· h:mm a")})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"font-bold","data-testid":`payment-amount-${u.id}`,children:d(u.amount,u.currency)})})]})]},u.id)})})]}),o.length>0&&s.jsxs(ye,{"data-testid":"inactive-subscriptions",children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"h-5 w-5"}),"Past Subscriptions"]}),s.jsx(zn,{children:"Cancelled or expired subscriptions"})]}),s.jsx(we,{className:"space-y-3",children:o.map((u,h)=>{var f,m,y;return s.jsxs("div",{children:[h>0&&s.jsx(Fl,{className:"my-3"}),s.jsxs("div",{className:"flex items-start justify-between opacity-60","data-testid":`inactive-subscription-${u.id}`,children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium",children:u.description||"Subscription"}),c(((m=(f=u.stripeData)==null?void 0:f.subscriptionDetails)==null?void 0:m.status)||((y=u.stripeData)==null?void 0:y.status)||"canceled")]}),u.playerInfo&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(Us,{className:"h-3 w-3"}),s.jsxs("span",{children:[u.playerInfo.firstName," ",u.playerInfo.lastName]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Yn(new Date(u.createdAt),"MMM dd, yyyy")})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"font-bold",children:d(u.amount,u.currency)})})]})]},u.id)})})]})]})}function q_e(){const e=j.useRef(null),[t,n]=j.useState(!1),[r,i]=j.useState(0),[a,o]=j.useState(0);return j.useEffect(()=>{const l=e.current;if(!l)return;const c=f=>{n(!0),i(f.pageX-l.offsetLeft),o(l.scrollLeft)},d=()=>{n(!1)},u=()=>{n(!1)},h=f=>{if(!t)return;f.preventDefault();const y=(f.pageX-l.offsetLeft-r)*2;l.scrollLeft=a-y};return l.addEventListener("mousedown",c),l.addEventListener("mouseleave",d),l.addEventListener("mouseup",u),l.addEventListener("mousemove",h),()=>{l.removeEventListener("mousedown",c),l.removeEventListener("mouseleave",d),l.removeEventListener("mouseup",u),l.removeEventListener("mousemove",h)}},[t,r,a]),e}function W_e({user:e}){const{toast:t}=Tt(),[n,r]=j.useState(!1),[i,a]=j.useState(""),[o,l]=j.useState(!1),c=(e==null?void 0:e.email)||"",d=(e==null?void 0:e.role)||"",u=async()=>{if(i!==c){t({title:"Email doesn't match",description:"Please enter your email exactly as shown.",variant:"destructive"});return}l(!0);try{const h=await fetch("/api/account/delete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmEmail:i})});if(h.ok)t({title:"Account deleted",description:"Your account has been deactivated successfully."}),hn.clear(),window.location.href="/";else{const f=await h.json();t({title:"Delete failed",description:f.message||"Could not delete account.",variant:"destructive"})}}catch{t({title:"Delete failed",description:"An error occurred. Please try again.",variant:"destructive"})}finally{l(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs(ye,{className:"border-red-200",children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"text-red-600 flex items-center gap-2",children:[s.jsx(qi,{className:"w-5 h-5"}),"Danger Zone"]}),s.jsx(zn,{children:"Irreversible actions that affect your account"})]}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-red-700",children:"Delete account"}),s.jsxs("div",{className:"text-xs text-red-600",children:["Your account will be deactivated and data removed.",(d==="parent"||d==="admin")&&" This includes all linked player profiles."]})]}),s.jsx(te,{variant:"destructive",onClick:()=>r(!0),"data-testid":"button-unified-delete-account",children:"Delete"})]})})]}),s.jsx($n,{open:n,onOpenChange:r,children:s.jsxs(Qn,{className:"max-w-md",children:[s.jsx(es,{children:s.jsxs(qn,{className:"text-red-600 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Delete Your Account"]})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-red-800 font-medium mb-2",children:"This action cannot be undone!"}),s.jsxs("ul",{className:"text-xs text-red-700 list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Your account will be deactivated"}),s.jsx("li",{children:"Your login credentials will be removed"}),(d==="parent"||d==="admin")&&s.jsx("li",{children:"All linked player profiles will also be deactivated"}),s.jsx("li",{children:"Any active subscriptions will be cancelled"}),s.jsx("li",{children:"You will lose access to all features and history"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"To confirm, please type your email address:"}),s.jsx("p",{className:"text-sm font-mono bg-gray-100 p-2 rounded",children:c}),s.jsx(qe,{type:"email",placeholder:"Enter your email to confirm",value:i,onChange:h=>a(h.target.value),className:"border-red-200 focus:border-red-500","data-testid":"input-unified-confirm-email"})]})]}),s.jsxs(IA,{className:"gap-2",children:[s.jsx(te,{variant:"outline",onClick:()=>{r(!1),a("")},disabled:o,"data-testid":"button-unified-cancel-delete",children:"Cancel"}),s.jsx(te,{variant:"destructive",onClick:u,disabled:o||i!==c,"data-testid":"button-unified-confirm-delete",children:o?"Deleting...":"Permanently Delete Account"})]})]})})]})}function G_e({player:e,payments:t,programs:n,parentId:r,onViewDashboard:i,onToggleLock:a}){var y,x;const[o,l]=j.useState(localStorage.getItem("deviceLockedToPlayer")===e.id),{data:c}=Ge({queryKey:[`/api/users/${e.id}/team`],enabled:!!e.id});j.useEffect(()=>{const b=()=>{l(localStorage.getItem("deviceLockedToPlayer")===e.id)};return window.addEventListener("deviceLockChanged",b),window.addEventListener("storage",b),()=>{window.removeEventListener("deviceLockChanged",b),window.removeEventListener("storage",b)}},[e.id]);const{status:d,plan:u}=V_e(t,n,e.id,r,e.packageSelected),h=K_e(d),f=z_e(d),m=e.activeSubscriptions||[];return s.jsx(ye,{className:"transition-all hover:shadow-md border-0 shadow-sm bg-white","data-testid":`player-card-${e.id}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(wr,{className:"w-12 h-12 flex-shrink-0",children:[s.jsx(Ur,{src:e.profileImageUrl,alt:`${e.firstName} ${e.lastName}`}),s.jsxs(br,{className:"bg-gradient-to-br from-red-500 to-red-600 text-white text-lg font-bold",children:[(y=e.firstName)==null?void 0:y[0],(x=e.lastName)==null?void 0:x[0]]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 truncate","data-testid":`player-name-${e.id}`,children:[e.firstName," ",e.lastName]}),e.teamAssignmentStatus==="pending"&&s.jsx(et,{variant:"outline",className:"bg-yellow-50 text-yellow-700 text-[10px] px-1.5 py-0",children:"Pending"}),o&&s.jsx(jh,{className:"h-3 w-3 text-red-500 flex-shrink-0"})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[(c==null?void 0:c.name)&&s.jsx("span",{className:"text-xs text-gray-500 truncate",children:c.name}),(c==null?void 0:c.name)&&s.jsx("span",{className:"text-gray-300",children:"â€¢"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${h}`,"data-testid":`status-indicator-${e.id}`}),s.jsx("span",{className:"text-xs text-gray-500","data-testid":`status-label-${e.id}`,children:f})]})]}),m.length>0&&s.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:m.map(b=>s.jsx(et,{variant:"outline",className:"bg-emerald-50 text-emerald-700 border-emerald-200 text-[10px] px-1.5 py-0","data-testid":`subscription-badge-${b.id}`,children:b.productName},b.id))})]})]})})})}function Z_e(){var pe,Y,H;const[,e]=Wt(),{toast:t}=Tt(),[n,r]=j.useState({}),[i,a]=j.useState(null),[o,l]=j.useState(!1),[c,d]=j.useState(""),u=q_e(),[h,f]=j.useState(!1),[m,y]=j.useState(null),[x,b]=j.useState(!1),[g,v]=j.useState(""),[_,B]=j.useState(""),[I,Q]=j.useState(!1);j.useEffect(()=>{const z=localStorage.getItem("deviceLockedToPlayer");z&&(localStorage.setItem("selectedPlayerId",z),e("/player-dashboard"))},[e]),j.useEffect(()=>{const z=new URLSearchParams(window.location.search),J=z.get("session_id");z.get("payment")==="success"&&J?bt("/api/payments/verify-session",{method:"POST",data:{sessionId:J}}).then(le=>{le.success?(t({title:"Payment Successful!",description:"Your payment has been processed successfully."}),hn.invalidateQueries({queryKey:["/api/payments"]}),hn.invalidateQueries({queryKey:["/api/payments/history"]}),hn.invalidateQueries({queryKey:["/api/account/players"]})):t({title:"Payment Verification",description:le.message||"Payment is being processed.",variant:"default"})}).catch(le=>{console.error("Error verifying payment:",le),t({title:"Payment Status",description:"Payment completed. Refresh the page to see updates.",variant:"default"})}).finally(()=>{window.history.replaceState({},"","/unified-account")}):z.get("payment")==="success"&&(t({title:"Payment Successful!",description:"Your payment has been processed."}),hn.invalidateQueries({queryKey:["/api/payments"]}),hn.invalidateQueries({queryKey:["/api/payments/history"]}),window.history.replaceState({},"","/unified-account"))},[t]);const{data:F}=Ge({queryKey:["/api/auth/user"]}),{data:P=[],isLoading:T}=Ge({queryKey:["/api/account/players"]}),{data:$=[],isLoading:D}=Ge({queryKey:["/api/events"]}),{data:O=[]}=Ge({queryKey:["/api/payments"]}),{data:V=[]}=Ge({queryKey:["/api/programs"]});$.filter(z=>new Date(z.startTime)>new Date).slice(0,3);const K=$.filter(z=>new Date(z.startTime)>new Date).sort((z,J)=>new Date(z.startTime).getTime()-new Date(J.startTime).getTime()),oe=O.filter(z=>z.status==="pending");oe.length>0&&oe[0];const ae=z=>{localStorage.setItem("selectedPlayerId",z),e("/player-dashboard")},ie=z=>{localStorage.getItem("deviceLockedToPlayer")===z?(localStorage.removeItem("deviceLockedToPlayer"),localStorage.removeItem("deviceLockPIN"),window.dispatchEvent(new Event("deviceLockChanged")),t({title:"Device Unlocked",description:"You can now access all player dashboards and the account page."})):(y(z),f(!0))},U=z=>{var J;m&&(localStorage.setItem("deviceLockPIN",z),localStorage.setItem("deviceLockedToPlayer",m),localStorage.setItem("selectedPlayerId",m),window.dispatchEvent(new Event("deviceLockChanged")),t({title:"Device Locked",description:`This device is now locked to ${(J=P.find(le=>le.id===m))==null?void 0:J.firstName}'s dashboard.`}),e("/player-dashboard"))},Z=async()=>{try{await bt("POST","/api/auth/logout",{}),t({title:"Signed out successfully"}),e("/")}catch{t({title:"Sign out failed",description:"Please try again",variant:"destructive"})}};return T?s.jsx("div",{className:"flex-1 bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):s.jsxs("div",{className:"flex-1 bg-gray-50 safe-bottom overflow-y-auto",children:[s.jsx("div",{className:"bg-white border-b safe-top",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>e("/profile-gateway"),"data-testid":"button-switch-profile",children:s.jsx(wa,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900","data-testid":"text-welcome",children:["Welcome, ",(F==null?void 0:F.firstName)||"User","!"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account and players"})]})]}),s.jsx(Tj,{})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsx(Ij,{}),s.jsxs(My,{defaultValue:"home",children:[s.jsx("div",{ref:u,className:"overflow-x-auto hide-scrollbar drag-scroll mb-6 -mx-4 px-4 sm:mx-0 sm:px-0",children:s.jsxs(Fg,{className:"inline-flex w-auto min-w-full sm:w-auto bg-transparent border-b border-gray-200 rounded-none p-0 h-auto gap-0",children:[s.jsxs(Wr,{value:"home","data-testid":"tab-home",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-red-600 data-[state=active]:bg-transparent bg-transparent px-6 py-3",children:[s.jsx(Us,{className:"w-4 h-4 mr-2"}),"Home"]}),s.jsxs(Wr,{value:"payments","data-testid":"tab-payments",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-red-600 data-[state=active]:bg-transparent bg-transparent px-6 py-3",children:[s.jsx(ih,{className:"w-4 h-4 mr-2"}),"Payments"]}),s.jsxs(Wr,{value:"messages","data-testid":"tab-messages",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-red-600 data-[state=active]:bg-transparent bg-transparent px-6 py-3",children:[s.jsx(kS,{className:"w-4 h-4 mr-2"}),"Messages"]}),s.jsxs(Wr,{value:"settings","data-testid":"tab-settings",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-red-600 data-[state=active]:bg-transparent bg-transparent px-6 py-3",children:[s.jsx(dj,{className:"w-4 h-4 mr-2"}),"Settings"]}),s.jsxs(Wr,{value:"events","data-testid":"tab-events",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-red-600 data-[state=active]:bg-transparent bg-transparent px-6 py-3",children:[s.jsx(dr,{className:"w-4 h-4 mr-2"}),"Events"]})]})}),s.jsx(Gr,{value:"home",className:"space-y-6",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"My Players"}),s.jsxs(te,{onClick:()=>e("/add-player"),variant:"outline","data-testid":"button-add-player",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add Player"]})]}),P.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx(Us,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Players Yet"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Add your first player to get started"}),s.jsxs(te,{onClick:()=>e("/add-player"),"data-testid":"button-add-first-player",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add Player"]})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(z=>s.jsx(G_e,{player:z,payments:O,programs:V,parentId:F==null?void 0:F.id,onViewDashboard:ae,onToggleLock:ie},z.id))})]})}),s.jsxs(Gr,{value:"payments",className:"space-y-4",children:[s.jsx(ye,{children:s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Ke,{children:"Make a Payment"}),s.jsx(zn,{children:"Purchase packages and memberships"})]}),s.jsxs($n,{open:x,onOpenChange:b,children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{"data-testid":"button-make-payment",children:[s.jsx(sl,{className:"w-4 h-4 mr-2"}),"Make Payment"]})}),s.jsxs(Qn,{className:"max-w-md","data-testid":"dialog-make-payment",children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Make a Payment"}),s.jsx(ch,{children:"Select a package and player to purchase"})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Package"}),s.jsxs(Qt,{value:g,onValueChange:v,children:[s.jsx(Ut,{"data-testid":"select-package",children:s.jsx(Mt,{placeholder:"Select a package"})}),s.jsxs(Dt,{children:[V==null?void 0:V.filter(z=>z.price&&z.price>0).map(z=>s.jsx(xe,{value:z.id,"data-testid":`package-option-${z.id}`,children:z.name},z.id)),(!V||V.filter(z=>z.price&&z.price>0).length===0)&&s.jsx(xe,{value:"none",disabled:!0,children:"No packages available"})]})]})]}),g&&(()=>{const z=V==null?void 0:V.find(Ae=>Ae.id===g),J=((z==null?void 0:z.billingModel)||"Per Player").toLowerCase().replace(/[^a-z]/g,"");return J.includes("player")&&!J.includes("family")&&!J.includes("organization")?s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Player *"}),s.jsxs(Qt,{value:_,onValueChange:B,children:[s.jsx(Ut,{"data-testid":"select-player",children:s.jsx(Mt,{placeholder:"Select a player"})}),s.jsx(Dt,{children:P==null?void 0:P.map(Ae=>s.jsxs(xe,{value:Ae.id,"data-testid":`player-option-${Ae.id}`,children:[Ae.firstName," ",Ae.lastName]},Ae.id))})]}),s.jsx("p",{className:"text-xs text-gray-600",children:"This is a per-player package. Select which player this payment is for."})]}):null})(),g&&(()=>{const z=V==null?void 0:V.find(J=>J.id===g);return z&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[s.jsx("h4",{className:"font-semibold",children:z.name}),z.description&&s.jsx("p",{className:"text-sm text-gray-600",children:z.description}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[z.type&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:z.type}),z.billingModel&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800",children:z.billingModel}),z.type==="Subscription"&&z.billingCycle&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800",children:z.billingCycle})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[s.jsx("span",{className:"font-medium",children:"Total:"}),s.jsxs("div",{className:"text-right",children:[s.jsxs("span",{className:"text-lg font-bold",children:["$",((z.price||0)/100).toFixed(2)]}),z.type==="Subscription"&&z.billingCycle&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["per ",z.billingCycle.toLowerCase()]})]})]})]})})(),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(te,{variant:"outline",onClick:()=>b(!1),className:"flex-1","data-testid":"button-cancel-payment",children:"Cancel"}),s.jsx(te,{onClick:async()=>{if(!g){t({title:"Error",description:"Please select a package",variant:"destructive"});return}const z=V==null?void 0:V.find(Ae=>Ae.id===g),J=((z==null?void 0:z.billingModel)||"Per Player").toLowerCase().replace(/[^a-z]/g,"");if(J.includes("player")&&!J.includes("family")&&!J.includes("organization")&&!_){t({title:"Error",description:"Please select a player for this per-player package",variant:"destructive"});return}Q(!0);try{const Ae=await bt("/api/payments/create-checkout",{method:"POST",data:{packageId:g,playerId:_||null}});window.location.href=Ae.url}catch(Ae){t({title:"Error",description:Ae.message||"Failed to create checkout session",variant:"destructive"}),Q(!1)}},className:"flex-1",disabled:!g||I,"data-testid":"button-proceed-payment",children:I?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"w-4 h-4 mr-2"}),"Proceed to Checkout"]})})]})]})]})]})]})})}),s.jsx($_e,{})]}),s.jsx(Gr,{value:"messages",className:"space-y-4",children:s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Messages"}),s.jsx(zn,{children:"Communication and notifications"})]}),s.jsx(we,{children:s.jsx("p",{className:"text-center text-gray-500 py-8",children:"No messages yet"})})]})}),s.jsxs(Gr,{value:"settings",className:"space-y-4",children:[s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Account Settings"}),s.jsx(zn,{children:"Manage your account preferences"})]}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Personal Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Name:"}),s.jsxs("span",{children:[F==null?void 0:F.firstName," ",F==null?void 0:F.lastName]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Email:"}),s.jsx("span",{children:F==null?void 0:F.email})]}),(F==null?void 0:F.phoneNumber)&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Phone:"}),s.jsx("span",{children:F.phoneNumber})]})]})]}),s.jsx("div",{className:"pt-4 border-t",children:s.jsxs(te,{variant:"outline",className:"w-full",onClick:Z,"data-testid":"button-logout",children:[s.jsx(Hb,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})]}),s.jsx(W_e,{user:F})]}),s.jsx(Gr,{value:"events",className:"space-y-4",children:s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Upcoming Events"}),s.jsx(zn,{children:"Check in your children to upcoming events"})]}),s.jsx(we,{children:D?s.jsx("div",{className:"flex justify-center py-8","data-testid":"loading-events",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):P.length===0?s.jsxs("div",{className:"text-center py-8","data-testid":"no-children-message",children:[s.jsx(Us,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Children Added"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Add a child to your account to check them in to events"}),s.jsxs(te,{onClick:()=>e("/add-player"),"data-testid":"button-add-child-from-events",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add Child"]})]}):K.length===0?s.jsxs("div",{className:"text-center py-8","data-testid":"no-events-message",children:[s.jsx(dr,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Upcoming Events"}),s.jsx("p",{className:"text-gray-600",children:"There are no upcoming events scheduled at this time"})]}):s.jsx("div",{className:"space-y-6",children:K.map(z=>{var he;const J=String(z.id),le=n[J]||((he=P[0])==null?void 0:he.id),Ae=P.find(Ce=>Ce.id===le);return s.jsx(ye,{className:"border-2 cursor-pointer hover:border-red-500 transition-colors","data-testid":`event-card-${z.id}`,onClick:()=>{a(z),d(le),l(!0)},children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-xl font-semibold","data-testid":`event-title-${z.id}`,children:z.title}),s.jsx(et,{variant:"outline","data-testid":`event-type-${z.id}`,children:z.eventType||"Event"})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),s.jsx("span",{"data-testid":`event-time-${z.id}`,children:new Date(z.startTime).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),s.jsx("span",{"data-testid":`event-location-${z.id}`,children:z.location})]})]})]}),P.length>1&&s.jsxs("div",{className:"space-y-2",onClick:Ce=>Ce.stopPropagation(),children:[s.jsx("label",{className:"text-sm font-medium","data-testid":`label-select-child-${z.id}`,children:"Select Child for RSVP/Check-In"}),s.jsxs(Qt,{value:le,onValueChange:Ce=>r(Le=>({...Le,[J]:Ce})),children:[s.jsx(Ut,{className:"w-full","data-testid":`select-child-${z.id}`,children:s.jsx(Mt,{placeholder:"Select a child"})}),s.jsx(Dt,{children:P.map(Ce=>s.jsxs(xe,{value:Ce.id,"data-testid":`select-child-option-${z.id}-${Ce.id}`,children:[Ce.firstName," ",Ce.lastName]},Ce.id))})]})]}),P.length===1&&s.jsxs("div",{className:"flex items-center gap-2 text-sm","data-testid":`single-child-${z.id}`,children:[s.jsx(Us,{className:"w-4 h-4 text-gray-600"}),s.jsxs("span",{className:"font-medium",children:["For: ",Ae==null?void 0:Ae.firstName," ",Ae==null?void 0:Ae.lastName]})]}),s.jsx("div",{className:"pt-2 border-t text-sm text-gray-500 text-center",children:"Click to view details and RSVP/Check-In"})]})})},z.id)})})})]})})]})]}),s.jsx(IK,{open:h,onOpenChange:f,mode:"set",onSuccess:U,title:"Set Lock PIN",description:`Create a 4-digit PIN to lock this device to ${(pe=P.find(z=>z.id===m))==null?void 0:pe.firstName}'s dashboard`}),c&&s.jsxs(s.Fragment,{children:[s.jsx(Ly,{event:i,userId:c,userRole:"parent",open:o,onOpenChange:l}),o&&i&&s.jsx("div",{className:"fixed bottom-4 right-4 bg-white shadow-lg rounded-lg p-4 border-2 border-blue-500 z-50",children:s.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["RSVP/Check-In for: ",s.jsxs("span",{className:"text-blue-600 font-semibold",children:[(Y=P.find(z=>z.id===c))==null?void 0:Y.firstName," ",(H=P.find(z=>z.id===c))==null?void 0:H.lastName]})]})})]})]})}function Y_e(){const{user:e,isLoading:t}=dn(),[,n]=Wt(),{data:r=[],isLoading:i}=Ge({queryKey:["/api/account/players"],enabled:!!e,staleTime:5*60*1e3});if(t||i)return s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-white border-t-transparent rounded-full"})});if(!e)return n("/"),null;const a=e==null?void 0:e.role,o=a==="coach"||a==="admin",l=a==="admin",c=a==="parent",d=(u,h)=>{localStorage.setItem("lastViewedProfileType",u),u==="parent"?(localStorage.removeItem("selectedPlayerId"),localStorage.removeItem("viewingAsParent"),n("/parent-dashboard")):u==="coach"?n("/coach-dashboard"):u==="admin"?n("/admin-dashboard"):u==="player"&&h&&(localStorage.setItem("selectedPlayerId",h),localStorage.setItem("viewingAsParent","true"),n("/player-dashboard"))};return s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black p-6 safe-top safe-bottom",children:s.jsxs("div",{className:"max-w-md mx-auto pt-8",children:[s.jsxs("div",{className:"text-center mb-10",children:[s.jsx("h1",{className:"text-3xl font-bold text-white mb-2","data-testid":"text-who-is-watching",children:"Who's Using BoxStat?"}),s.jsx("p",{className:"text-gray-400",children:"Select a profile to continue"})]}),s.jsxs("div",{className:"space-y-4",children:[(c||l)&&s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("parent"),"data-testid":"card-parent-profile",children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:s.jsx(vs,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Manage billing, players & settings"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),o&&s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("coach"),"data-testid":"card-coach-profile",children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:s.jsx(Us,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Coach View"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Manage teams, rosters & evaluations"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),l&&s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("admin"),"data-testid":"card-admin-profile",children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:s.jsx(Fi,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Admin View"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Full system administration"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),r.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-gray-700 my-6 pt-4",children:s.jsx("h2",{className:"text-sm font-medium text-gray-400 mb-4 px-1",children:"PLAYER PROFILES"})}),r.map(u=>{var h,f;return s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("player",u.id),"data-testid":`card-player-${u.id}`,children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsxs(wr,{className:"w-16 h-16",children:[s.jsx(Ur,{src:u.profileImageUrl,alt:`${u.firstName} ${u.lastName}`}),s.jsxs(br,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white text-xl font-bold",children:[(h=u.firstName)==null?void 0:h[0],(f=u.lastName)==null?void 0:f[0]]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white",children:[u.firstName," ",u.lastName]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Player Dashboard"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})},u.id)})]})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("button",{onClick:async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}localStorage.removeItem("authToken"),localStorage.removeItem("selectedPlayerId"),localStorage.removeItem("viewingAsParent"),localStorage.removeItem("lastViewedProfileType"),n("/")},className:"text-gray-500 hover:text-gray-300 text-sm transition-colors","data-testid":"button-sign-out",children:"Sign Out"})})]})})}function X_e(){const{user:e,isLoading:t}=dn(),[,n]=Wt(),r=j.useRef(!1),{data:i=[],isLoading:a}=Ge({queryKey:["/api/account/players"],enabled:!!e,staleTime:5*60*1e3});return j.useEffect(()=>{if(t||a||r.current)return;if(!e){n("/");return}r.current=!0;const o=e==null?void 0:e.role,l=e==null?void 0:e.id,c=e==null?void 0:e.activeProfileId,d=e==null?void 0:e.defaultDashboardView,u=o==="coach",h=o==="admin",f=o==="parent",m=o==="player",y=i&&i.length>0,x=localStorage.getItem("lastViewedProfileType"),b=localStorage.getItem("selectedPlayerId"),g=(_,B)=>{localStorage.setItem("selectedPlayerId",_),B?localStorage.setItem("viewingAsParent","true"):localStorage.removeItem("viewingAsParent"),n("/player-dashboard")},v=()=>{localStorage.removeItem("selectedPlayerId"),localStorage.removeItem("viewingAsParent"),n("/parent-dashboard")};if(d){if(d==="player"&&c){g(c,f||h);return}else if(d==="coach"&&(u||h)){n("/coach-dashboard");return}else if(d==="admin"&&h){n("/admin-dashboard");return}else if(d==="parent"){v();return}}if(x){if(x==="player"&&b){g(b,f||h);return}else if(x==="coach"&&(u||h)){n("/coach-dashboard");return}else if(x==="admin"&&h){n("/admin-dashboard");return}else if(x==="parent"){v();return}}h||u||f&&y?n("/profile-gateway"):f&&!y?v():m?g(l,!1):v()},[e,t,i,a,n]),s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})}function J_e(){const[,e]=Wt(),{toast:t}=Tt(),[n,r]=j.useState(""),[i,a]=j.useState(""),[o,l]=j.useState(!1),[c,d]=j.useState(""),[u,h]=j.useState(!1),[f,m]=j.useState(!1),y=async b=>{var g;b.preventDefault(),l(!0);try{console.log("ðŸ” Attempting login with email:",n),console.log("ðŸŒ Current window location:",window.location.href),console.log("ðŸ“¡ Sending POST to /api/auth/login");const v=await bt("POST","/api/auth/login",{email:n,password:i});if(console.log("âœ… Login response received:",v),v.success){if(console.log("ðŸŽ¯ Login success branch - token present?",!!v.token),v.token){console.log("ðŸ’¾ About to store JWT token..."),localStorage.setItem("authToken",v.token),console.log("âœ… Token stored! Verifying...");const B=localStorage.getItem("authToken");console.log("ðŸ” Token retrieved from storage:",B?B.substring(0,20)+"...":"NULL")}else console.warn("âš ï¸ No token in response!");t({title:"Login Successful",description:"Welcome back!"});let _="/account";(g=v.user)!=null&&g.defaultDashboardView&&(v.user.defaultDashboardView==="parent"?_="/unified-account":(localStorage.setItem("selectedPlayerId",v.user.defaultDashboardView),_="/player-dashboard")),console.log("ðŸš€ Redirecting to:",_),await new Promise(B=>setTimeout(B,100)),window.location.href=_}else throw new Error(v.message||"Login failed")}catch(v){console.error("âŒ Login error:",v),console.error("âŒ Error message:",v.message),console.error("âŒ Error stack:",v.stack),v.message&&v.message.includes("verify your email")?t({title:"Email Verification Required",description:v.message,variant:"destructive"}):t({title:"Login Failed",description:v.message||"Invalid email or password",variant:"destructive"})}finally{l(!1)}},x=async b=>{b.preventDefault(),h(!0);try{const g=await bt("POST","/api/auth/request-magic-link",{email:c});if(g.success)t({title:"Magic Link Sent!",description:"Check your email for the login link."}),d("");else throw new Error(g.message||"Failed to send magic link")}catch(g){t({title:"Failed to Send Magic Link",description:g.message||"Please try again later.",variant:"destructive"})}finally{h(!1)}};return s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-br from-gray-900 via-gray-800 to-black safe-bottom",children:[s.jsx("div",{className:"absolute top-6 left-6 safe-top",children:s.jsx("button",{onClick:()=>e("/"),className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 transition-colors","data-testid":"button-back-to-home",children:s.jsx(wa,{className:"w-5 h-5 text-white"})})}),s.jsx("div",{className:"flex flex-col justify-center min-h-screen-safe px-8 py-16 safe-top",children:s.jsxs("div",{className:"w-full max-w-sm mx-auto space-y-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h1",{className:"text-4xl font-bold text-white tracking-tight",children:"Welcome Back"}),s.jsx("p",{className:"text-gray-400 text-lg",children:"Login to access your account"})]}),f?s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"magic-link-email",className:"text-gray-300 text-sm font-medium",children:"Email"}),s.jsx(qe,{id:"magic-link-email",type:"email",placeholder:"your.email@example.com",value:c,onChange:b=>d(b.target.value),required:!0,"data-testid":"input-magic-link-email",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"}),s.jsx("p",{className:"text-sm text-gray-500",children:"We'll send you a secure login link to your email"})]}),s.jsxs(te,{type:"submit",className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold",disabled:u,"data-testid":"button-send-magic-link",children:[s.jsx($i,{className:"w-4 h-4 mr-2"}),u?"Sending...":"Send Magic Link"]})]}),s.jsxs(te,{variant:"ghost",className:"w-full text-gray-400 hover:text-white hover:bg-white/5",onClick:()=>m(!1),"data-testid":"button-back-to-password",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back to Password Login"]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:y,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"email",className:"text-gray-300 text-sm font-medium",children:"Email"}),s.jsx(qe,{id:"email",type:"email",placeholder:"your.email@example.com",value:n,onChange:b=>r(b.target.value),required:!0,"data-testid":"input-email",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"password",className:"text-gray-300 text-sm font-medium",children:"Password"}),s.jsx(qe,{id:"password",type:"password",placeholder:"Enter your password",value:i,onChange:b=>a(b.target.value),required:!0,"data-testid":"input-password",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"})]}),s.jsxs(te,{type:"submit",className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold",disabled:o,"data-testid":"button-login",children:[s.jsx(_ne,{className:"w-4 h-4 mr-2"}),o?"Logging in...":"Login"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Fl,{className:"bg-white/10"}),s.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-900 px-4 text-sm text-gray-500",children:"or"})]}),s.jsxs(te,{variant:"outline",className:"w-full h-12 bg-transparent border-white/20 text-white hover:bg-white/10",onClick:()=>m(!0),"data-testid":"button-show-magic-link",children:[s.jsx($i,{className:"w-4 h-4 mr-2"}),"Login with Magic Link"]})]}),s.jsxs("div",{className:"space-y-4 pt-4",children:[s.jsxs("p",{className:"text-center text-gray-400",children:["Don't have an account?"," ",s.jsx(te,{variant:"link",className:"p-0 h-auto text-red-500 hover:text-red-400",onClick:()=>e("/register"),"data-testid":"link-register",children:"Register here"})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/privacy-policy"),className:"text-gray-500 text-xs hover:text-gray-400 underline transition-colors","data-testid":"link-privacy-policy",children:"Privacy Policy"})})]})]})})]})}var Gk="Radio",[e5e,MZ]=bi(Gk),[t5e,n5e]=e5e(Gk),RZ=j.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:i=!1,required:a,disabled:o,value:l="on",onCheck:c,form:d,...u}=e,[h,f]=j.useState(null),m=In(t,b=>f(b)),y=j.useRef(!1),x=h?d||!!h.closest("form"):!0;return s.jsxs(t5e,{scope:n,checked:i,disabled:o,children:[s.jsx(zt.button,{type:"button",role:"radio","aria-checked":i,"data-state":VZ(i),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:m,onClick:Rt(e.onClick,b=>{i||c==null||c(),x&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),x&&s.jsx(s5e,{control:h,bubbles:!y.current,name:r,value:l,checked:i,required:a,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});RZ.displayName=Gk;var OZ="RadioIndicator",HZ=j.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...i}=e,a=n5e(OZ,n);return s.jsx(qa,{present:r||a.checked,children:s.jsx(zt.span,{"data-state":VZ(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t})})});HZ.displayName=OZ;var s5e=e=>{const{control:t,checked:n,bubbles:r=!0,...i}=e,a=j.useRef(null),o=Sy(n),l=ky(t);return j.useEffect(()=>{const c=a.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==n&&h){const f=new Event("click",{bubbles:r});h.call(c,n),c.dispatchEvent(f)}},[o,n,r]),s.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:a,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function VZ(e){return e?"checked":"unchecked"}var r5e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Zk="RadioGroup",[i5e,F4e]=bi(Zk,[Uj,MZ]),KZ=Uj(),zZ=MZ(),[a5e,o5e]=i5e(Zk),$Z=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:i,value:a,required:o=!1,disabled:l=!1,orientation:c,dir:d,loop:u=!0,onValueChange:h,...f}=e,m=KZ(n),y=em(d),[x,b]=vo({prop:a,defaultProp:i,onChange:h});return s.jsx(a5e,{scope:n,name:r,required:o,disabled:l,value:x,onValueChange:b,children:s.jsx(RK,{asChild:!0,...m,orientation:c,dir:y,loop:u,children:s.jsx(zt.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:y,...f,ref:t})})})});$Z.displayName=Zk;var qZ="RadioGroupItem",WZ=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...i}=e,a=o5e(qZ,n),o=a.disabled||r,l=KZ(n),c=zZ(n),d=j.useRef(null),u=In(t,d),h=a.value===i.value,f=j.useRef(!1);return j.useEffect(()=>{const m=x=>{r5e.includes(x.key)&&(f.current=!0)},y=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",y)}},[]),s.jsx(OK,{asChild:!0,...l,focusable:!o,active:h,children:s.jsx(RZ,{disabled:o,required:a.required,checked:h,...c,...i,name:a.name,ref:u,onCheck:()=>a.onValueChange(i.value),onKeyDown:Rt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:Rt(i.onFocus,()=>{var m;f.current&&((m=d.current)==null||m.click())})})})});WZ.displayName=qZ;var l5e="RadioGroupIndicator",GZ=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,i=zZ(n);return s.jsx(HZ,{...i,...r,ref:t})});GZ.displayName=l5e;var ZZ=$Z,YZ=WZ,c5e=GZ;const XZ=j.forwardRef(({className:e,...t},n)=>s.jsx(ZZ,{className:_t("grid gap-2",e),...t,ref:n}));XZ.displayName=ZZ.displayName;const JZ=j.forwardRef(({className:e,...t},n)=>s.jsx(YZ,{ref:n,className:_t("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(c5e,{className:"flex items-center justify-center",children:s.jsx(y8,{className:"h-2.5 w-2.5 fill-current text-current"})})}));JZ.displayName=YZ.displayName;const d5e=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required")}),A5e=q.object({dateOfBirth:q.string().min(1,"Date of birth is required")}),u5e=q.object({gender:q.enum(["male","female","other"],{required_error:"Please select a gender"})}),h5e=q.object({packageId:q.string().min(1,"Please select a package")});function f5e(){const[,e]=Wt(),{toast:t}=Tt(),[n,r]=j.useState(1),[i,a]=j.useState({}),{data:o=[],isLoading:l}=Ge({queryKey:["/api/programs"],enabled:n>=4}),c=o.reduce((y,x)=>{const b=x.category||"Other";return y[b]||(y[b]=[]),y[b].push(x),y},{}),d=ot({mutationFn:async y=>await bt("/api/account/players",{method:"POST",data:y}),onSuccess:y=>{y.checkoutUrl?(t({title:"Redirecting to Payment",description:"Please complete payment to finalize player registration."}),setTimeout(()=>{window.location.href=y.checkoutUrl},1e3)):(hn.invalidateQueries({queryKey:["/api/account/players"]}),hn.invalidateQueries({queryKey:["/api/payments"]}),t({title:"Player Added!",description:"Player has been successfully added to your account."}),setTimeout(()=>{e("/unified-account")},1e3))},onError:y=>{t({title:"Failed to Add Player",description:y.message||"Something went wrong. Please try again.",variant:"destructive"})}}),u=()=>r(y=>Math.min(y+1,5)),h=()=>r(y=>Math.max(y-1,1)),f=n/5*100,m=o.find(y=>y.id===i.packageId);return s.jsx("div",{className:"scrollable-page bg-gray-50 safe-bottom py-8 px-4",children:s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Gu,{className:"w-6 h-6"}),"Add Player"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${f}%`}})}),s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Step ",n," of 5"]})]}),s.jsxs(we,{children:[n===1&&s.jsx(m5e,{defaultValues:{firstName:i.firstName||"",lastName:i.lastName||""},onSubmit:y=>{a({...i,...y}),u()},onBack:()=>e("/unified-account")}),n===2&&s.jsx(p5e,{defaultValues:{dateOfBirth:i.dateOfBirth||""},onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===3&&s.jsx(g5e,{defaultValues:{gender:i.gender||""},onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===4&&s.jsx(x5e,{defaultValues:{packageId:i.packageId||""},programs:o,programsByCategory:c,isLoading:l,onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===5&&s.jsx(y5e,{playerData:i,selectedProgram:m,onSubmit:()=>{const y={...i};d.mutate(y)},onBack:h,isSubmitting:d.isPending})]})]})})})}function m5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(d5e),defaultValues:e});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"firstName",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"First Name *"}),s.jsx(ut,{children:s.jsx(qe,{...i,"data-testid":"input-firstName"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:r.control,name:"lastName",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Last Name *"}),s.jsx(ut,{children:s.jsx(qe,{...i,"data-testid":"input-lastName"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function p5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(A5e),defaultValues:e});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"dateOfBirth",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Date of Birth *"}),s.jsx(ut,{children:s.jsx(qe,{type:"date",...i,"data-testid":"input-dateOfBirth"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function g5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(u5e),defaultValues:{gender:e.gender}});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"gender",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Gender *"}),s.jsxs(Qt,{onValueChange:i.onChange,defaultValue:i.value,children:[s.jsx(ut,{children:s.jsx(Ut,{"data-testid":"select-gender",children:s.jsx(Mt,{placeholder:"Select gender"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"male","data-testid":"option-male",children:"Male"}),s.jsx(xe,{value:"female","data-testid":"option-female",children:"Female"}),s.jsx(xe,{value:"other","data-testid":"option-other",children:"Other"})]})]}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function x5e({defaultValues:e,programs:t,programsByCategory:n,isLoading:r,onSubmit:i,onBack:a}){const o=Dr({resolver:Qr(h5e),defaultValues:{packageId:e.packageId||""}});return r?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(Nc,{className:"w-8 h-8 animate-spin text-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Loading programs..."})]}):t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-gray-600",children:"No programs available at this time."}),s.jsxs(te,{onClick:a,variant:"outline",className:"mt-4","data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]})]}):s.jsx(Mr,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(i),className:"space-y-6",children:[s.jsx(it,{control:o.control,name:"packageId",render:({field:l})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Select a Program *"}),s.jsx(ut,{children:s.jsx(XZ,{onValueChange:l.onChange,defaultValue:l.value,className:"space-y-3","data-testid":"radiogroup-packages",children:Object.entries(n).map(([c,d])=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"font-semibold text-gray-700 text-sm mt-4",children:c}),d.map(u=>s.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-gray-50 transition","data-testid":`package-option-${u.id}`,children:[s.jsx(JZ,{value:u.id,id:u.id,"data-testid":`radio-${u.id}`}),s.jsx(yt,{htmlFor:u.id,className:"flex-1 cursor-pointer",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900","data-testid":`text-program-name-${u.id}`,children:u.name}),u.description&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.description}),s.jsxs("div",{className:"flex gap-2 mt-2 flex-wrap",children:[u.type&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:u.type}),u.billingModel&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800",children:u.billingModel}),u.type==="Subscription"&&u.billingCycle&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800",children:u.billingCycle})]})]}),u.price&&s.jsxs("div",{className:"text-right ml-4",children:[s.jsxs("p",{className:"font-bold text-blue-600","data-testid":`text-program-price-${u.id}`,children:["$",(u.price/100).toFixed(2)]}),u.type==="Subscription"&&u.billingCycle&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["per ",u.billingCycle.toLowerCase()]})]})]})})]},u.id))]},c))})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:a,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function y5e({playerData:e,selectedProgram:t,onSubmit:n,onBack:r,isSubmitting:i}){return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Payment Summary"}),s.jsxs("div",{className:"border rounded-lg p-4 mb-4 bg-gray-50",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Player Information"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("p",{"data-testid":"text-player-name",children:[s.jsx("span",{className:"text-gray-600",children:"Name:"})," ",s.jsxs("span",{className:"font-medium",children:[e.firstName," ",e.lastName]})]}),s.jsxs("p",{"data-testid":"text-player-dob",children:[s.jsx("span",{className:"text-gray-600",children:"Date of Birth:"})," ",s.jsx("span",{className:"font-medium",children:e.dateOfBirth})]}),s.jsxs("p",{"data-testid":"text-player-gender",children:[s.jsx("span",{className:"text-gray-600",children:"Gender:"})," ",s.jsx("span",{className:"font-medium capitalize",children:e.gender})]})]})]}),t&&s.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50 border-blue-200",children:[s.jsxs("h4",{className:"font-medium text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(ih,{className:"w-4 h-4"}),"Selected Package"]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold text-gray-900","data-testid":"text-selected-program-name",children:t.name}),t.description&&s.jsx("p",{className:"text-sm text-gray-600",children:t.description}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-blue-200",children:[s.jsx("span",{className:"text-gray-700 font-medium",children:"Total Amount:"}),s.jsxs("span",{className:"text-2xl font-bold text-blue-600","data-testid":"text-total-amount",children:["$",t.price?(t.price/100).toFixed(2):"0.00"]})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," You will be redirected to a secure payment page to complete your transaction. The player will be added to your account after successful payment."]})})]}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:r,disabled:i,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx(te,{onClick:n,disabled:i,"data-testid":"button-proceed-payment",children:i?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"w-4 h-4 mr-2"}),"Proceed to Payment"]})})]})]})}function v5e(){const[,e]=Wt(),[t,n]=j.useState("loading"),[r,i]=j.useState(""),[a,o]=j.useState(!1);return j.useEffect(()=>{(async()=>{const c=new URLSearchParams(window.location.search),d=c.get("token"),u=c.get("email");if(!d){n("error"),i("Invalid verification link. No token provided.");return}try{let h=`/api/auth/verify-email?token=${encodeURIComponent(d)}`;u&&(h+=`&email=${encodeURIComponent(u)}`);const f=await fetch(h),m=await f.json();if(f.ok&&m.success){n("success"),i(m.message),o(m.stripeDataFound||!1);const y=m.email||c.get("email");setTimeout(()=>{e(`/registration?verified=${encodeURIComponent(y||"")}&continue=true`)},2e3)}else n("error"),i(m.message||"Verification failed. Please try again.")}catch{n("error"),i("An error occurred during verification. Please try again.")}})()},[e]),s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-blue-50 to-indigo-100 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center mb-4",children:[t==="loading"&&s.jsx(Nc,{className:"h-16 w-16 text-blue-600 animate-spin","data-testid":"icon-loading"}),t==="success"&&s.jsx(Ra,{className:"h-16 w-16 text-green-600","data-testid":"icon-success"}),t==="error"&&s.jsx(rh,{className:"h-16 w-16 text-red-600","data-testid":"icon-error"})]}),s.jsxs(Ke,{children:[t==="loading"&&"Verifying Your Email...",t==="success"&&"Email Verified!",t==="error"&&"Verification Failed"]}),s.jsx(zn,{children:r})]}),t!=="loading"&&s.jsxs(we,{className:"flex flex-col gap-3",children:[t==="success"&&a&&s.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg mb-3","data-testid":"stripe-data-found",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ba,{className:"h-5 w-5 text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900 text-sm",children:"Payment History Found"}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"We found your information from previous payments and have prefilled your profile."})]})]})}),t==="success"&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Nc,{className:"h-8 w-8 text-blue-600 animate-spin mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Redirecting you to continue registration..."})]}),t==="error"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{onClick:()=>e("/register"),className:"w-full","data-testid":"button-back-to-register",children:"Back to Registration"}),s.jsx(te,{variant:"outline",onClick:()=>e("/login"),className:"w-full","data-testid":"button-go-to-login",children:"Go to Login"})]})]})]})})}function w5e(){const[,e]=Wt(),[t,n]=j.useState("loading"),[r,i]=j.useState("");return j.useEffect(()=>{(async()=>{var c;const l=new URLSearchParams(window.location.search).get("token");if(!l){n("error"),i("Invalid magic link. No token provided.");return}try{const d=await fetch(`/api/auth/magic-link-login?token=${l}`),u=await d.json();if(d.ok&&u.success){n("success"),i(u.message);let h="/account";(c=u.user)!=null&&c.defaultDashboardView&&(u.user.defaultDashboardView==="parent"?h="/unified-account":(localStorage.setItem("selectedPlayerId",u.user.defaultDashboardView),h="/player-dashboard")),setTimeout(()=>{window.location.href=h},1e3)}else n("error"),i(u.message||"Magic link login failed. Please try again.")}catch{n("error"),i("An error occurred during login. Please try again.")}})()},[]),s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-blue-50 to-indigo-100 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center mb-4",children:[t==="loading"&&s.jsx(Nc,{className:"h-16 w-16 text-blue-600 animate-spin"}),t==="success"&&s.jsx(Ra,{className:"h-16 w-16 text-green-600"}),t==="error"&&s.jsx(rh,{className:"h-16 w-16 text-red-600"})]}),s.jsxs(Ke,{children:[t==="loading"&&"Logging You In...",t==="success"&&"Login Successful!",t==="error"&&"Login Failed"]}),s.jsxs(zn,{children:[t==="loading"&&"Please wait while we verify your magic link...",t==="success"&&"Redirecting to your account...",t==="error"&&r]})]}),t==="error"&&s.jsx(we,{className:"flex flex-col gap-3",children:s.jsx(te,{onClick:()=>e("/login"),className:"w-full","data-testid":"button-back-to-login",children:"Back to Login"})})]})})}function GL(){const{toast:e}=Tt(),t=os(),[n,r]=j.useState(null),[i,a]=j.useState(""),{data:o=[],isLoading:l}=Ge({queryKey:["/api/sportsengine/events-with-roster"]}),{data:c=[],isLoading:d}=Ge({queryKey:["/api/sportsengine/schedule-requests"]}),u=ot({mutationFn:async({rosterId:g,status:v,notes:_})=>bt("PUT",`/api/sportsengine/roster/${g}/status`,{status:v,notes:_}),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/sportsengine/events-with-roster"]}),e({title:"Roster Updated",description:"Player status has been updated successfully."})},onError:g=>{e({title:"Update Failed",description:"Failed to update roster status. Please try again.",variant:"destructive"})}}),h=async(g,v)=>{u.mutate({rosterId:g,status:v,notes:i}),a("")},f=g=>{switch(g){case"confirmed":return s.jsxs(et,{variant:"default",className:"bg-green-100 text-green-800",children:[s.jsx(Ra,{className:"w-3 h-3 mr-1"}),"Confirmed"]});case"pending":return s.jsxs(et,{variant:"secondary",children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Pending"]});case"declined":return s.jsxs(et,{variant:"destructive",children:[s.jsx(rh,{className:"w-3 h-3 mr-1"}),"Declined"]});case"unavailable":return s.jsxs(et,{variant:"outline",children:[s.jsx(jd,{className:"w-3 h-3 mr-1"}),"Unavailable"]});default:return s.jsx(et,{variant:"outline",children:g})}},m=g=>{switch(g){case"high":return s.jsx(et,{variant:"destructive",children:"High Priority"});case"medium":return s.jsx(et,{variant:"secondary",children:"Medium Priority"});case"low":return s.jsx(et,{variant:"outline",children:"Low Priority"});default:return s.jsx(et,{variant:"outline",children:g})}},y=g=>{switch(g){case"approved":return s.jsx(et,{variant:"default",className:"bg-green-100 text-green-800",children:"Approved"});case"pending":return s.jsx(et,{variant:"secondary",children:"Pending Review"});case"denied":return s.jsx(et,{variant:"destructive",children:"Denied"});default:return s.jsx(et,{variant:"outline",children:g})}};if(l||d)return s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading roster management data..."})]})});const x=o.filter(g=>new Date(g.startTime)>new Date),b=c.filter(g=>g.status==="pending");return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Roster & Schedule Management"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage team rosters and schedule requests through SportsEngine"})]}),s.jsxs(My,{defaultValue:"events",className:"space-y-6",children:[s.jsxs(Fg,{className:"grid w-full grid-cols-3",children:[s.jsx(Wr,{value:"events",children:"Event Rosters"}),s.jsx(Wr,{value:"requests",children:"Schedule Requests"}),s.jsx(Wr,{value:"analytics",children:"Team Analytics"})]}),s.jsx(Gr,{value:"events",className:"space-y-4",children:s.jsx("div",{className:"grid gap-4",children:x.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-5 h-5"}),g.title]}),s.jsxs(zn,{className:"flex items-center gap-4 mt-2",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"w-4 h-4"}),new Date(g.startTime).toLocaleDateString()," at ",new Date(g.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Yi,{className:"w-4 h-4"}),g.location]})]})]}),s.jsx(et,{variant:g.type==="game"?"default":"secondary",children:g.type.charAt(0).toUpperCase()+g.type.slice(1)})]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:g.description}),s.jsxs("div",{className:"flex gap-4 text-sm",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(vs,{className:"w-4 h-4"}),"Total: ",g.rosterStats.total]}),s.jsxs("span",{className:"text-green-600",children:["Confirmed: ",g.rosterStats.confirmed]}),s.jsxs("span",{className:"text-yellow-600",children:["Pending: ",g.rosterStats.pending]}),s.jsxs("span",{className:"text-red-600",children:["Declined: ",g.rosterStats.declined]})]}),g.rosterDeadline&&s.jsxs("div",{className:"text-sm text-orange-600",children:[s.jsx(Ar,{className:"w-4 h-4 inline mr-1"}),"Roster deadline: ",new Date(g.rosterDeadline).toLocaleDateString()," at ",new Date(g.rosterDeadline).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium",children:"Team Roster:"}),s.jsx("div",{className:"grid gap-2",children:g.roster.map(v=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Us,{className:"w-4 h-4"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:v.playerName}),v.position&&s.jsx("p",{className:"text-sm text-muted-foreground",children:v.position})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[f(v.status),v.status==="pending"&&s.jsxs($n,{children:[s.jsx(ja,{asChild:!0,children:s.jsx(te,{size:"sm",variant:"outline",onClick:()=>r(g),children:"Respond"})}),s.jsxs(Qn,{children:[s.jsxs(es,{children:[s.jsxs(qn,{children:["Roster Response - ",v.playerName]}),s.jsxs(ch,{children:["Confirm availability for ",g.title]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(yt,{htmlFor:"notes",children:"Notes (optional)"}),s.jsx(Vs,{id:"notes",placeholder:"Any additional notes...",value:i,onChange:_=>a(_.target.value)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(te,{onClick:()=>h(v.id,"confirmed"),disabled:u.isPending,className:"flex-1",children:[s.jsx(Ra,{className:"w-4 h-4 mr-2"}),"Confirm"]}),s.jsxs(te,{variant:"destructive",onClick:()=>h(v.id,"declined"),disabled:u.isPending,className:"flex-1",children:[s.jsx(rh,{className:"w-4 h-4 mr-2"}),"Decline"]})]})]})]})]})]})]},v.id))})]})]})})]},g.id))})}),s.jsx(Gr,{value:"requests",className:"space-y-4",children:s.jsxs("div",{className:"grid gap-4",children:[b.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{children:[g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{children:["Requested on ",new Date(g.requestDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[m(g.priority),y(g.status)]})]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Date:"})," ",new Date(g.requestedDate).toLocaleDateString()]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Time:"})," ",g.requestedTime]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Duration:"})," ",g.duration," minutes"]}),g.location&&s.jsxs("div",{children:[s.jsx("strong",{children:"Location:"})," ",g.location]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"Opponent:"})," ",g.opponent]})]}),g.notes&&s.jsxs("div",{children:[s.jsx("strong",{children:"Notes:"})," ",g.notes]})]})})]},g.id)),b.length===0&&s.jsx(ye,{children:s.jsx(we,{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"No pending schedule requests"})})})]})}),s.jsx(Gr,{value:"analytics",className:"space-y-4",children:s.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Event Overview"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Events:"}),s.jsx("span",{className:"font-medium",children:o.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Upcoming:"}),s.jsx("span",{className:"font-medium",children:x.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Games:"}),s.jsx("span",{className:"font-medium",children:o.filter(g=>g.type==="game").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Practices:"}),s.jsx("span",{className:"font-medium",children:o.filter(g=>g.type==="practice").length})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Roster Statistics"})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-2",children:x.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Avg Confirmed:"}),s.jsx("span",{className:"font-medium",children:Math.round(x.reduce((g,v)=>g+v.rosterStats.confirmed,0)/x.length)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Avg Pending:"}),s.jsx("span",{className:"font-medium",children:Math.round(x.reduce((g,v)=>g+v.rosterStats.pending,0)/x.length)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Response Rate:"}),s.jsxs("span",{className:"font-medium",children:[Math.round(x.reduce((g,v)=>g+v.rosterStats.confirmed+v.rosterStats.declined,0)/x.reduce((g,v)=>g+v.rosterStats.total,0)*100),"%"]})]})]})})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Schedule Requests"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Requests:"}),s.jsx("span",{className:"font-medium",children:c.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Pending:"}),s.jsx("span",{className:"font-medium",children:c.filter(g=>g.status==="pending").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Approved:"}),s.jsx("span",{className:"font-medium",children:c.filter(g=>g.status==="approved").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Approval Rate:"}),s.jsxs("span",{className:"font-medium",children:[c.length>0?Math.round(c.filter(g=>g.status==="approved").length/c.length*100):0,"%"]})]})]})})]})]})})]})]})}const b5e=q.object({teamId:q.string().min(1,"Team is required"),requestType:q.enum(["game","tournament","camp","exhibition","practice","skills","workshop","talk","combine","training","meeting","course","tryout","skills-assessment","team-building","parent-meeting","equipment-pickup","photo-day","award-ceremony","fnh"]),requestedDate:q.string().min(1,"Date is required"),requestedTime:q.string().min(1,"Time is required"),duration:q.number().min(30,"Duration must be at least 30 minutes"),location:q.string().optional(),opponent:q.string().optional(),priority:q.enum(["high","medium","low"]),notes:q.string().optional()});function ZL(){const{toast:e}=Tt(),t=os(),[n,r]=j.useState(!1),i=Dr({resolver:Qr(b5e),defaultValues:{requestType:"practice",priority:"medium",duration:90}}),{data:a=[],isLoading:o}=Ge({queryKey:["/api/sportsengine/my-teams"]}),{data:l=[],isLoading:c}=Ge({queryKey:["/api/sportsengine/schedule-requests"]}),d=ot({mutationFn:async g=>bt("POST","/api/sportsengine/schedule-requests",g),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/sportsengine/schedule-requests"]}),r(!1),i.reset(),e({title:"Request Submitted",description:"Your schedule request has been submitted for review."})},onError:g=>{e({title:"Request Failed",description:"Failed to submit schedule request. Please try again.",variant:"destructive"})}}),u=g=>{d.mutate(g)},h=g=>{switch(g){case"high":return s.jsx(et,{variant:"destructive",children:"High Priority"});case"medium":return s.jsx(et,{variant:"secondary",children:"Medium Priority"});case"low":return s.jsx(et,{variant:"outline",children:"Low Priority"});default:return s.jsx(et,{variant:"outline",children:g})}},f=g=>{switch(g){case"approved":return s.jsxs(et,{variant:"default",className:"bg-green-100 text-green-800",children:[s.jsx(Ra,{className:"w-3 h-3 mr-1"}),"Approved"]});case"pending":return s.jsxs(et,{variant:"secondary",children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Pending Review"]});case"denied":return s.jsxs(et,{variant:"destructive",children:[s.jsx(rh,{className:"w-3 h-3 mr-1"}),"Denied"]});default:return s.jsx(et,{variant:"outline",children:g})}},m=g=>{switch(g){case"game":return"ðŸ€";case"practice":return"ðŸƒ";case"tournament":return"ðŸ†";default:return"ðŸ“…"}};if(o||c)return s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading schedule requests..."})]})});const y=l.filter(g=>g.status==="pending"),x=l.filter(g=>g.status==="approved"),b=l.filter(g=>g.status==="denied");return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Schedule Requests"}),s.jsx("p",{className:"text-muted-foreground",children:"Request new games, practices, and tournament slots"})]}),s.jsxs($n,{open:n,onOpenChange:r,children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{children:[s.jsx(sl,{className:"w-4 h-4 mr-2"}),"New Request"]})}),s.jsxs(Qn,{className:"max-w-2xl",children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Create Schedule Request"}),s.jsx(ch,{children:"Submit a request for a new game, practice, or tournament slot"})]}),s.jsx(Mr,{...i,children:s.jsxs("form",{onSubmit:i.handleSubmit(u),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"teamId",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Team"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select team"})})}),s.jsx(Dt,{children:a.map(v=>s.jsx(xe,{value:v.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:v.name}),s.jsx("span",{className:"text-gray-500",children:v.program==="Youth-Club"?"Youth Club":v.ageGroup})]})},v.id))})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"requestType",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Request Type"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select type"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"game",children:"Game"}),s.jsx(xe,{value:"tournament",children:"Tournament"}),s.jsx(xe,{value:"camp",children:"Camp"}),s.jsx(xe,{value:"exhibition",children:"Exhibition"}),s.jsx(xe,{value:"practice",children:"Practice"}),s.jsx(xe,{value:"skills",children:"Skills"}),s.jsx(xe,{value:"workshop",children:"Workshop"}),s.jsx(xe,{value:"talk",children:"Talk"}),s.jsx(xe,{value:"combine",children:"Combine"}),s.jsx(xe,{value:"training",children:"Training"}),s.jsx(xe,{value:"meeting",children:"Meeting"}),s.jsx(xe,{value:"course",children:"Course"}),s.jsx(xe,{value:"tryout",children:"Tryout"}),s.jsx(xe,{value:"skills-assessment",children:"Skills Assessment"}),s.jsx(xe,{value:"team-building",children:"Team Building"}),s.jsx(xe,{value:"parent-meeting",children:"Parent Meeting"}),s.jsx(xe,{value:"equipment-pickup",children:"Equipment Pickup"}),s.jsx(xe,{value:"photo-day",children:"Photo Day"}),s.jsx(xe,{value:"award-ceremony",children:"Award Ceremony"}),s.jsx(xe,{value:"fnh",children:"FNH"})]})]}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"requestedDate",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Requested Date"}),s.jsx(ut,{children:s.jsx(qe,{type:"date",...g})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"requestedTime",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Requested Time"}),s.jsx(ut,{children:s.jsx(qe,{type:"time",...g})}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"duration",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Duration (minutes)"}),s.jsx(ut,{children:s.jsx(qe,{type:"number",...g,onChange:v=>g.onChange(parseInt(v.target.value))})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"priority",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Priority"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select priority"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"low",children:"Low Priority"}),s.jsx(xe,{value:"medium",children:"Medium Priority"}),s.jsx(xe,{value:"high",children:"High Priority"})]})]}),s.jsx(ft,{})]})})]}),s.jsx(it,{control:i.control,name:"location",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Preferred Location (optional)"}),s.jsx(ut,{children:s.jsx(qe,{placeholder:"e.g., Momentous Sports Center - Court A",...g})}),s.jsx(ft,{})]})}),i.watch("requestType")==="game"&&s.jsx(it,{control:i.control,name:"opponent",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Opponent (optional)"}),s.jsx(ut,{children:s.jsx(qe,{placeholder:"e.g., Thunder, Eagles",...g})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"notes",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Additional Notes (optional)"}),s.jsx(ut,{children:s.jsx(Vs,{placeholder:"Any additional details or special requirements...",...g})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(te,{type:"submit",disabled:d.isPending,className:"flex-1",children:d.isPending?"Submitting...":"Submit Request"}),s.jsx(te,{type:"button",variant:"outline",onClick:()=>r(!1),className:"flex-1",children:"Cancel"})]})]})})]})]})]}),s.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:l.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Requests"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:y.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Denied"})]})})]}),y.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Pending Requests"}),s.jsx("div",{className:"grid gap-4",children:y.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx("span",{children:m(g.requestType)}),g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{children:["Submitted on ",new Date(g.requestDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[h(g.priority),f(g.status)]})]})}),s.jsxs(we,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(g.requestedDate).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),s.jsxs("span",{children:[g.requestedTime," (",g.duration," min)"]})]}),g.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),s.jsx("span",{children:g.location})]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"vs"})," ",g.opponent]})]}),g.notes&&s.jsx("div",{className:"mt-3 p-3 bg-muted rounded-lg",children:s.jsx("p",{className:"text-sm",children:g.notes})})]})]},g.id))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"All Requests"}),s.jsx("div",{className:"grid gap-4",children:l.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"text-center py-8",children:[s.jsx("p",{className:"text-muted-foreground",children:"No schedule requests yet"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "New Request" to submit your first schedule request'})]})}):l.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx("span",{children:m(g.requestType)}),g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{className:"flex items-center gap-4",children:[s.jsxs("span",{children:["Submitted: ",new Date(g.requestDate).toLocaleDateString()]}),g.approvalDate&&s.jsxs("span",{children:["Processed: ",new Date(g.approvalDate).toLocaleDateString()]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[h(g.priority),f(g.status)]})]})}),s.jsxs(we,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(g.requestedDate).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),s.jsxs("span",{children:[g.requestedTime," (",g.duration," min)"]})]}),g.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),s.jsx("span",{children:g.location})]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"vs"})," ",g.opponent]})]}),g.notes&&s.jsx("div",{className:"mt-3 p-3 bg-muted rounded-lg",children:s.jsx("p",{className:"text-sm",children:g.notes})})]})]},g.id))})]})]})}const Yk="/assets/UYP%20Logo%20nback-DsWwmSx0.png",YL=[{id:1,title:"Elite Ball Handling",description:"Master advanced dribbling techniques and ball control skills used by professional players. Perfect for players looking to improve their handles and court vision.",previewVideoUrl:"https://player.vimeo.com/video/example1",monthlyPrice:19.99,annualPrice:199.99,duration:"8 weeks",difficulty:"Advanced",totalVideos:24,category:"Skills Development"},{id:2,title:"Advanced Shooting Techniques",description:"Develop consistent shooting form and accuracy from all areas of the court. Includes drills for catch-and-shoot, off-the-dribble, and contested shots.",previewVideoUrl:"https://player.vimeo.com/video/example2",monthlyPrice:24.99,annualPrice:249.99,duration:"10 weeks",difficulty:"Intermediate",totalVideos:30,category:"Shooting"},{id:3,title:"Vertical Jump Program",description:"Increase your vertical leap and explosiveness with scientifically-proven training methods. Includes strength training and plyometric exercises.",previewVideoUrl:"https://player.vimeo.com/video/example3",monthlyPrice:29.99,annualPrice:299.99,duration:"12 weeks",difficulty:"Advanced",totalVideos:36,category:"Athletic Performance"},{id:4,title:"Youth Fundamentals",description:"Perfect for young players starting their basketball journey. Covers basic dribbling, shooting, and defensive fundamentals in an age-appropriate way.",previewVideoUrl:"https://player.vimeo.com/video/example4",monthlyPrice:14.99,annualPrice:149.99,duration:"6 weeks",difficulty:"Beginner",totalVideos:18,category:"Fundamentals"}];function j5e(){const{user:e}=dn(),n=new URLSearchParams(window.location.search).get("mode")==="player"?"player":"parent",[,r]=Wt(),{toast:i}=Tt(),[a,o]=j.useState(null),[l,c]=j.useState("monthly"),{data:d}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"subscriptions"],enabled:!!(e!=null&&e.id)}),u=ot({mutationFn:async m=>{const y=YL.find(b=>b.id===m.programId);if(!y)throw new Error("Program not found");const x=m.type==="monthly"?y.monthlyPrice:y.annualPrice;return await bt("POST","/api/payments/sportsengine/create",{type:"training_subscription",amount:x,description:`${y.title} - ${m.type} subscription`,metadata:{programId:m.programId,subscriptionType:m.type}})},onSuccess:m=>{i({title:"Payment Initiated",description:"Redirecting to SportsEngine payment..."}),window.location.href=`/payment/training/${a==null?void 0:a.id}?type=${l}`},onError:m=>{i({title:"Payment Failed",description:m.message,variant:"destructive"})}}),h=m=>d==null?void 0:d.some(y=>y.programId===m&&y.status==="active"),f=(m,y)=>{o(m),c(y),u.mutate({programId:m.id,type:y})};return e?s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"BoxStat Academy"})]}),s.jsx(te,{variant:"ghost",onClick:()=>r("/"),className:"text-gray-600 hover:text-gray-900",children:"Back to Dashboard"})]})})}),s.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:n==="player"?"Your Training Programs":"Premium Training Programs"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:n==="player"?"Practice and improve your basketball skills with these training videos assigned to you.":"Take your game to the next level with our professional training programs. Learn from expert coaches and improve your skills with structured, progressive training."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8",children:YL.map(m=>s.jsxs(ye,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsx(Ve,{className:"p-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"aspect-video bg-gray-900 flex items-center justify-center",children:s.jsx("iframe",{src:m.previewVideoUrl,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx(et,{variant:m.difficulty==="Beginner"?"default":m.difficulty==="Intermediate"?"secondary":"destructive",children:m.difficulty})})]})}),s.jsxs(we,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Ke,{className:"text-xl",children:m.title}),h(m.id)&&s.jsxs(et,{variant:"default",className:"bg-green-500",children:[s.jsx(Ra,{className:"h-3 w-3 mr-1"}),"Subscribed"]})]}),s.jsx("p",{className:"text-gray-600 mb-4",children:m.description}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ar,{className:"h-4 w-4 mr-1"}),m.duration]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(PS,{className:"h-4 w-4 mr-1"}),m.totalVideos," videos"]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Aj,{className:"h-4 w-4 mr-1"}),m.category]})]}),n==="player"?h(m.id)?s.jsx(te,{className:"w-full",onClick:()=>r(`/training/${m.id}`),children:"Continue Training"}):s.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg text-center",children:[s.jsx(jh,{className:"h-6 w-6 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Ask your parent to unlock this training program"})]}):h(m.id)?s.jsx(te,{className:"w-full",onClick:()=>r(`/training/${m.id}`),children:"Access Training"}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx("span",{className:"text-sm font-medium",children:"Subscription Options:"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(te,{variant:"outline",className:"text-sm",onClick:()=>f(m,"monthly"),disabled:u.isPending,children:[s.jsx(ih,{className:"h-4 w-4 mr-1"}),"$",m.monthlyPrice,"/month"]}),s.jsxs(te,{variant:"outline",className:"text-sm",onClick:()=>f(m,"annual"),disabled:u.isPending,children:[s.jsx(Ai,{className:"h-4 w-4 mr-1"}),"$",m.annualPrice,"/year"]})]}),s.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Save $",(m.monthlyPrice*12-m.annualPrice).toFixed(2)," with annual plan"]})]})]})]},m.id))})]})]}):s.jsx("div",{children:"Loading..."})}function N5e(){const{user:e}=dn(),n=new URLSearchParams(window.location.search).get("mode")==="player"?"player":"parent",[,r]=Wt(),[i,a]=j.useState(null),{data:o}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"training-programs"],enabled:!!(e!=null&&e.id)}),c=o||[{id:1,title:"Elite Ball Handling",progress:65,totalModules:8,completedModules:5,modules:[{id:1,title:"Basic Dribbling Foundation",description:"Master the fundamental dribbling techniques",videoUrl:"https://player.vimeo.com/video/example1",duration:"12:30",completed:!0,order:1},{id:2,title:"Advanced Crossover Moves",description:"Learn professional crossover techniques",videoUrl:"https://player.vimeo.com/video/example2",duration:"15:45",completed:!0,order:2},{id:3,title:"Behind-the-Back Dribbling",description:"Master behind-the-back moves in game situations",videoUrl:"https://player.vimeo.com/video/example3",duration:"18:20",completed:!1,order:3}]}];return e?s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"My Training Library"})]}),s.jsxs(te,{variant:"ghost",onClick:()=>r("/training"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Programs"]})]})})}),s.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(une,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Training Programs Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:n==="player"?"Ask your parent to add training programs for you to practice and improve your skills.":"Subscribe to training programs to access exclusive content and improve your skills."}),n==="parent"&&s.jsx(te,{onClick:()=>r("/training"),children:"Browse Training Programs"})]}):s.jsx("div",{className:"space-y-8",children:c.map(d=>s.jsxs(ye,{className:"overflow-hidden",children:[s.jsx(Ve,{className:"bg-primary/5",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Ke,{className:"text-2xl",children:d.title}),s.jsxs("p",{className:"text-gray-600 mt-1",children:[d.completedModules," of ",d.totalModules," modules completed"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx(Ai,{className:"h-5 w-5 text-yellow-500 mr-2"}),s.jsxs("span",{className:"text-lg font-bold",children:[d.progress,"%"]})]}),s.jsx(xd,{value:d.progress,className:"w-32"})]})]})}),s.jsx(we,{className:"p-6",children:s.jsx("div",{className:"grid gap-4",children:d.modules.map(u=>s.jsx("div",{className:`p-4 rounded-lg border-2 transition-all cursor-pointer ${u.completed?"bg-green-50 border-green-200 hover:border-green-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,onClick:()=>a(u),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${u.completed?"bg-green-500":"bg-gray-400"}`,children:u.completed?s.jsx(Ra,{className:"h-4 w-4 text-white"}):s.jsx(PS,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:u.title}),s.jsx("p",{className:"text-sm text-gray-500",children:u.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(et,{variant:"secondary",className:"flex items-center",children:[s.jsx(Ar,{className:"h-3 w-3 mr-1"}),u.duration]}),s.jsx(te,{size:"sm",variant:u.completed?"secondary":"default",children:u.completed?"Rewatch":"Watch"})]})]})},u.id))})})]},d.id))})}),i&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h3",{className:"text-lg font-medium",children:i.title}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>a(null),children:"Ã—"})]}),s.jsx("div",{className:"aspect-video",children:s.jsx("iframe",{src:i.videoUrl,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(et,{variant:"secondary",className:"flex items-center",children:[s.jsx(Ar,{className:"h-3 w-3 mr-1"}),i.duration]}),s.jsx(te,{onClick:()=>{a(null)},disabled:i.completed,children:i.completed?"Completed":"Mark as Complete"})]})]})]})})]}):s.jsx("div",{children:"Loading..."})}function C5e(){var y,x;const{user:e}=dn(),[,t]=Wt(),{data:n,isLoading:r}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),{data:i}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"payments"],enabled:!!(e!=null&&e.id)}),{data:a}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"subscriptions"],enabled:!!(e!=null&&e.id)}),{data:o}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"badges"],enabled:!!(e!=null&&e.id)}),{data:l}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"stats"],enabled:!!(e!=null&&e.id)}),{data:c}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"team"],enabled:!!(e!=null&&e.id),staleTime:5*60*1e3,gcTime:30*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:!1});if(!e||r)return s.jsx("div",{children:"Loading..."});const d=e.role==="parent",u=e.role==="player",h=(n==null?void 0:n.firstName)||e.firstName,f=(n==null?void 0:n.lastName)||e.lastName,m=(n==null?void 0:n.profileImageUrl)||e.profileImageUrl;return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"My Profile"})]}),s.jsxs(te,{variant:"ghost",onClick:()=>t("/"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsx(ye,{className:"overflow-hidden",children:s.jsxs(we,{className:"p-0",children:[s.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[s.jsx("div",{className:"w-full aspect-square rounded-2xl overflow-hidden shadow-2xl ring-4 ring-white",children:s.jsxs(wr,{className:"w-full h-full rounded-none",children:[s.jsx(Ur,{src:m,alt:h,className:"object-cover"}),s.jsxs(br,{className:"text-6xl font-bold bg-gradient-to-br from-red-100 to-red-50 text-red-600 rounded-none",children:[h==null?void 0:h[0],f==null?void 0:f[0]]})]})}),s.jsxs("div",{className:"absolute top-4 right-4 text-right space-y-1",children:[s.jsxs("div",{className:"opacity-50",children:[s.jsx("h1",{className:"text-3xl font-black tracking-tight leading-none text-white",children:h}),s.jsx("h2",{className:"text-3xl font-black tracking-tight leading-none text-white",children:f})]}),s.jsxs("div",{className:"text-white text-sm font-bold uppercase tracking-wide opacity-50",children:[((y=e.role)==null?void 0:y.charAt(0).toUpperCase())+((x=e.role)==null?void 0:x.slice(1)),c&&` | ${c.name}`]})]})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx($i,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:e.email})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(dr,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Joined ",Yn(new Date(e.createdAt),"MMMM yyyy")]})]}),s.jsxs(te,{className:"w-full mt-4",variant:"outline",onClick:()=>t("/settings"),children:[s.jsx(dj,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),s.jsx(te,{className:"w-full",variant:"outline",onClick:()=>window.location.href="/api/logout",children:"Sign Out"})]})]})})}),s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[d&&s.jsxs(s.Fragment,{children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(ba,{className:"h-5 w-5 mr-2"}),"Payment History"]})}),s.jsx(we,{children:(i==null?void 0:i.length)>0?s.jsxs("div",{className:"space-y-3",children:[i.slice(0,5).map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:b.description}),s.jsx("p",{className:"text-sm text-gray-500",children:Yn(new Date(b.createdAt),"MMM d, yyyy")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-medium",children:["$",b.amount]}),s.jsx(et,{variant:b.status==="completed"?"default":"secondary",children:b.status})]})]},b.id)),s.jsx(te,{variant:"outline",className:"w-full",onClick:()=>t("/payment"),children:"View All Payments"})]}):s.jsx("p",{className:"text-gray-500",children:"No payment history yet."})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Jp,{className:"h-5 w-5 mr-2"}),"Training Subscriptions"]})}),s.jsx(we,{children:(a==null?void 0:a.length)>0?s.jsxs("div",{className:"space-y-3",children:[a.map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:b.programTitle}),s.jsxs("p",{className:"text-sm text-gray-500",children:[b.type," subscription"]})]}),s.jsx(et,{variant:b.status==="active"?"default":"secondary",children:b.status})]},b.id)),s.jsx(te,{variant:"outline",className:"w-full",onClick:()=>t("/training-library"),children:"Access Training Library"})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-gray-500 mb-3",children:"No active training subscriptions."}),s.jsx(te,{onClick:()=>t("/training"),children:"Browse Training Programs"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(vs,{className:"h-5 w-5 mr-2"}),"Linked Children"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(wr,{className:"w-10 h-10 mr-3",children:s.jsx(br,{children:"AJ"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Alex Johnson"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Lightning Bolts â€¢ Age 10"})]})]}),s.jsx(te,{variant:"outline",className:"w-full",children:"Manage Children"})]})})]})]}),u&&s.jsxs(s.Fragment,{children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Ai,{className:"h-5 w-5 mr-2"}),"Badges & Achievements"]})}),s.jsx(we,{children:(o==null?void 0:o.length)>0?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:o.map(b=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-500 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(Ai,{className:"h-6 w-6 text-white"})}),s.jsx("p",{className:"text-sm font-medium",children:b.title}),s.jsx("p",{className:"text-xs text-gray-500",children:Yn(new Date(b.earnedAt),"MMM d, yyyy")})]},b.id))}):s.jsx("p",{className:"text-gray-500",children:"No badges earned yet. Keep training!"})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Jp,{className:"h-5 w-5 mr-2"}),"Player Statistics"]})}),s.jsx(we,{children:(l==null?void 0:l.length)>0?s.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map(b=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:b.value}),s.jsx("p",{className:"text-sm text-gray-600",children:b.statType})]},b.id))}):s.jsx("p",{className:"text-gray-500",children:"No statistics recorded yet."})})]})]})]})]})})]})}const _5e=q.object({playerEmail:q.string().email("Valid email is required"),relationship:q.enum(["parent","guardian","sibling","grandparent"]),canMakePayments:q.boolean(),canViewReports:q.boolean(),emergencyContact:q.boolean()}),B5e=q.object({playerId:q.string().min(1,"Player selection is required"),contact:q.string().min(1,"Contact information is required"),code:q.string().length(6,"Verification code must be 6 digits")});function Ew(){dn();const{toast:e}=Tt(),t=os(),[,n]=Wt(),[r,i]=j.useState(!1),[a,o]=j.useState(!1),[l,c]=j.useState(null),[d,u]=j.useState(""),[h,f]=j.useState("search"),[m,y]=j.useState(""),x=Dr({resolver:Qr(_5e),defaultValues:{relationship:"parent",canMakePayments:!0,canViewReports:!0,emergencyContact:!1}}),b=Dr({resolver:Qr(B5e),defaultValues:{playerId:"",contact:"",code:""}}),{data:g=[],isLoading:v}=Ge({queryKey:["/api/parent/players"]}),{data:_=[],isLoading:B}=Ge({queryKey:["/api/search/notion-players",d],enabled:d.length>=2}),I=ot({mutationFn:async U=>bt("POST","/api/family-members",U),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),i(!1),x.reset(),e({title:"Family Member Added",description:"The player has been successfully added to your family."})},onError:U=>{e({title:"Failed to Add Member",description:"Could not add family member. Please check the email and try again.",variant:"destructive"})}}),Q=ot({mutationFn:async({playerId:U,contact:Z})=>bt("POST","/api/players/claim/request",{playerId:U,contact:Z}),onSuccess:()=>{f("verify"),e({title:"Verification Code Sent",description:`A verification code has been sent to ${m}.`})},onError:U=>{e({title:"Failed to Send Code",description:"Could not send verification code. Please try again.",variant:"destructive"})}}),F=ot({mutationFn:async U=>bt("POST","/api/players/claim/verify",U),onSuccess:U=>{var Z;t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),o(!1),f("search"),c(null),b.reset(),e({title:"Player Claimed Successfully",description:`${(Z=U.player)==null?void 0:Z.fullName} has been added to your family.`})},onError:U=>{e({title:"Verification Failed",description:"Invalid verification code. Please check and try again.",variant:"destructive"})}}),P=ot({mutationFn:async U=>bt("DELETE",`/api/parent/players/${U}`),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),e({title:"Player Removed",description:"The player has been removed from your family successfully."})},onError:U=>{e({title:"Removal Failed",description:"Failed to remove player from family. Please try again.",variant:"destructive"})}}),T=ot({mutationFn:async({memberId:U,permissions:Z})=>bt("PUT",`/api/family-members/${U}`,Z),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),e({title:"Permissions Updated",description:"Family member permissions have been updated."})},onError:U=>{e({title:"Update Failed",description:"Failed to update permissions. Please try again.",variant:"destructive"})}}),$=U=>{I.mutate(U)},D=(U,Z)=>{confirm(`Are you sure you want to remove ${Z} from your family? This action cannot be undone.`)&&P.mutate(U)},O=U=>{c(U),b.setValue("playerId",U.id),f("request")},V=()=>{l&&m&&(Q.mutate({playerId:l.id,contact:m}),b.setValue("contact",m))},K=U=>{F.mutate(U)},oe=()=>{o(!1),f("search"),c(null),y(""),b.reset(),u("")},ae=(U,Z,pe)=>{T.mutate({memberId:U,permissions:{[Z]:!pe}})},ie=U=>{switch(U){case"parent":return s.jsx(et,{variant:"default",children:"Parent"});case"guardian":return s.jsx(et,{variant:"secondary",children:"Guardian"});case"sibling":return s.jsx(et,{variant:"outline",children:"Sibling"});case"grandparent":return s.jsx(et,{variant:"outline",children:"Grandparent"});default:return s.jsx(et,{variant:"outline",children:U})}};return v?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading family members..."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Family Management"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage linked player profiles and permissions"})]})]})}),s.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex gap-3 flex-wrap",children:[s.jsxs($n,{open:a,onOpenChange:U=>U?o(!0):oe(),children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{"data-testid":"button-claim-player",children:[s.jsx(Wu,{className:"w-4 h-4 mr-2"}),"Find & Claim Player"]})}),s.jsxs(Qn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Claim Player Profile"}),s.jsxs(ch,{children:[h==="search"&&"Search for your child's player profile in our system",h==="request"&&"Request verification to claim this player",h==="verify"&&"Enter the verification code sent to you"]})]}),h==="search"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(qe,{"data-testid":"input-search-player",placeholder:"Search by player name...",value:d,onChange:U=>u(U.target.value),className:"flex-1"}),s.jsx(te,{variant:"outline",disabled:B,children:s.jsx(Wu,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:B?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Searching..."}):_.length>0?_.map(U=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium","data-testid":`text-player-name-${U.id}`,children:U.fullName}),s.jsxs("div",{className:"text-sm text-gray-500",children:[U.teamName&&s.jsxs("span",{className:"inline-flex items-center gap-1 mr-3",children:[s.jsx(Xp,{className:"w-3 h-3"}),U.teamName]}),U.jerseyNumber&&s.jsxs("span",{className:"inline-flex items-center gap-1 mr-3",children:[s.jsx(KE,{className:"w-3 h-3"}),"#",U.jerseyNumber]}),U.position&&s.jsx("span",{children:U.position})]})]})]}),s.jsx(te,{size:"sm",onClick:()=>O(U),"data-testid":`button-select-player-${U.id}`,children:"Select"})]},U.id)):d.length>=2?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No players found"}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:"Type to search for players"})})]}),h==="request"&&l&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 border rounded-lg bg-blue-50",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:l.fullName}),s.jsxs("div",{className:"text-sm text-gray-600",children:[l.teamName," â€¢ #",l.jerseyNumber]})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Information"}),s.jsx(qe,{"data-testid":"input-claim-contact",placeholder:"Email or phone number for verification",value:m,onChange:U=>y(U.target.value)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"We'll send a verification code to confirm you're authorized to claim this player"})]})]}),h==="verify"&&l&&s.jsx(Mr,{...b,children:s.jsxs("form",{onSubmit:b.handleSubmit(K),className:"space-y-4",children:[s.jsx("div",{className:"p-4 border rounded-lg bg-green-50",children:s.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[s.jsx(N8,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-medium",children:["Verification code sent to ",m]})]})}),s.jsx(it,{control:b.control,name:"code",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Verification Code"}),s.jsx(ut,{children:s.jsx(qe,{"data-testid":"input-verification-code",placeholder:"Enter 6-digit code",maxLength:6,...U})}),s.jsx(ft,{})]})})]})}),s.jsxs(IA,{children:[h==="search"&&s.jsx(te,{variant:"outline",onClick:oe,children:"Cancel"}),h==="request"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{variant:"outline",onClick:()=>f("search"),children:"Back"}),s.jsx(te,{onClick:V,disabled:!m||Q.isPending,"data-testid":"button-send-verification",children:Q.isPending?"Sending...":"Send Verification Code"})]}),h==="verify"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{variant:"outline",onClick:()=>f("request"),children:"Back"}),s.jsx(te,{onClick:b.handleSubmit(K),disabled:!b.watch("code")||F.isPending,"data-testid":"button-claim-player-verify",children:F.isPending?"Verifying...":"Claim Player"})]})]})]})]}),s.jsxs($n,{open:r,onOpenChange:i,children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{variant:"outline","data-testid":"button-add-member-email",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add by Email"]})}),s.jsxs(Qn,{children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Add Family Member"}),s.jsx(ch,{children:"Add a player to your family account to manage their payments and information."})]}),s.jsx(Mr,{...x,children:s.jsxs("form",{onSubmit:x.handleSubmit($),className:"space-y-4",children:[s.jsx(it,{control:x.control,name:"playerEmail",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Player Email Address"}),s.jsx(ut,{children:s.jsx(qe,{type:"email",placeholder:"player@example.com","data-testid":"input-player-email",...U})}),s.jsx(ft,{})]})}),s.jsx(it,{control:x.control,name:"relationship",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Relationship"}),s.jsxs(Qt,{onValueChange:U.onChange,defaultValue:U.value,children:[s.jsx(ut,{children:s.jsx(Ut,{"data-testid":"select-relationship",children:s.jsx(Mt,{placeholder:"Select relationship"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"parent",children:"Parent"}),s.jsx(xe,{value:"guardian",children:"Guardian"}),s.jsx(xe,{value:"sibling",children:"Sibling"}),s.jsx(xe,{value:"grandparent",children:"Grandparent"})]})]}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(it,{control:x.control,name:"canMakePayments",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-can-make-payments"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Can Make Payments"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow this family member to make payments for the player"})]})]})}),s.jsx(it,{control:x.control,name:"canViewReports",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-can-view-reports"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Can View Reports"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow viewing of performance reports and statistics"})]})]})}),s.jsx(it,{control:x.control,name:"emergencyContact",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-emergency-contact"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Emergency Contact"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Mark as an emergency contact for the player"})]})]})})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(te,{type:"submit",disabled:I.isPending,className:"flex-1","data-testid":"button-add-member-submit",children:I.isPending?"Adding...":"Add Member"}),s.jsx(te,{type:"button",variant:"outline",onClick:()=>i(!1),className:"flex-1",children:"Cancel"})]})]})})]})]})]}),s.jsx("div",{className:"grid gap-4",children:g.length===0?s.jsx(ye,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:s.jsxs(we,{className:"text-center py-12",children:[s.jsx(vs,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Family Members"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Add players to your family account to manage their basketball experience."}),s.jsxs(te,{onClick:()=>o(!0),"data-testid":"button-add-first-member",children:[s.jsx(Wu,{className:"h-4 w-4 mr-2"}),"Find Your First Player"]})]})}):g.map(U=>s.jsxs(ye,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:U.player.profileImageUrl?s.jsx("img",{src:U.player.profileImageUrl,alt:`${U.player.firstName} ${U.player.lastName}`,className:"w-12 h-12 rounded-full object-cover"}):s.jsx(Us,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs(Ke,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[s.jsxs("span",{"data-testid":`text-member-name-${U.id}`,children:[U.player.firstName," ",U.player.lastName]}),ie(U.relationship)]}),s.jsxs(zn,{className:"flex items-center gap-4 text-gray-600 dark:text-gray-400",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx($i,{className:"w-4 h-4"}),U.player.email]}),U.player.phoneNumber&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(bg,{className:"w-4 h-4"}),U.player.phoneNumber]}),U.player.teamId&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Xp,{className:"w-4 h-4"}),"Team Member"]}),U.player.jerseyNumber&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(KE,{className:"w-4 h-4"}),"#",U.player.jerseyNumber]}),U.player.position&&s.jsx("span",{children:U.player.position})]})]})]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>D(U.player.id,`${U.player.firstName} ${U.player.lastName}`),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","data-testid":`button-remove-member-${U.id}`,children:s.jsx(Va,{className:"w-4 h-4"})})]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3 text-gray-900 dark:text-gray-100",children:"Permissions"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Payments"})]}),s.jsx(js,{checked:U.canMakePayments,onCheckedChange:()=>ae(U.id,"canMakePayments",U.canMakePayments),disabled:T.isPending,"data-testid":`checkbox-payments-${U.id}`})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yp,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Reports"})]}),s.jsx(js,{checked:U.canViewReports,onCheckedChange:()=>ae(U.id,"canViewReports",U.canViewReports),disabled:T.isPending,"data-testid":`checkbox-reports-${U.id}`})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Emergency"})]}),s.jsx(js,{checked:U.emergencyContact,onCheckedChange:()=>ae(U.id,"emergencyContact",U.emergencyContact),disabled:T.isPending,"data-testid":`checkbox-emergency-${U.id}`})]})]})]})})})]},U.id))}),s.jsx(ye,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:s.jsxs(we,{className:"p-6",children:[s.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"How Family Management Works"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Claiming Players"}),s.jsxs("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:[s.jsx("li",{children:"â€¢ Search our player database for your child"}),s.jsx("li",{children:"â€¢ Request verification via email or phone"}),s.jsx("li",{children:"â€¢ Enter the code to claim the profile"}),s.jsx("li",{children:"â€¢ All past achievements and data transfer over"})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Family Permissions"}),s.jsxs("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:[s.jsx("li",{children:"â€¢ Payment permissions for fees and uniforms"}),s.jsx("li",{children:"â€¢ Report access for performance tracking"}),s.jsx("li",{children:"â€¢ Emergency contact notifications"}),s.jsx("li",{children:"â€¢ Multiple families supported (divorced parents)"})]})]})]})]})})]})]})}const S5e=["ðŸ‘","â¤ï¸","ðŸ˜„","ðŸŽ‰","ðŸ‘","ðŸ”¥","âš¡","ðŸ’ª"];function k5e({messageId:e,onClose:t,position:n}){const{toast:r}=Tt(),i=os(),a=ot({mutationFn:async l=>bt(`/api/messages/${e}/reactions`,{method:"POST",body:{emoji:l}}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/announcements/team"]}),t()},onError:l=>{r({title:"Failed to add reaction",description:"Please try again.",variant:"destructive"})}}),o=l=>{a.mutate(l)};return s.jsx("div",{className:"fixed z-50 bg-white border rounded-lg shadow-lg p-2 flex gap-1",style:{left:Math.min(n.x,window.innerWidth-250),top:Math.max(n.y-60,10)},children:S5e.map(l=>s.jsx(te,{variant:"ghost",size:"sm",className:"text-lg p-2 h-10 w-10 hover:bg-gray-100",onClick:()=>o(l),disabled:a.isPending,children:l},l))})}function eY({reactions:e,messageId:t,currentUserId:n}){const r=os(),{toast:i}=Tt(),a=ot({mutationFn:async c=>bt(`/api/messages/${t}/reactions`,{method:"DELETE",body:{emoji:c}}),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/announcements/team"]})},onError:c=>{i({title:"Failed to remove reaction",description:"Please try again.",variant:"destructive"})}}),o=e.reduce((c,d)=>(c[d.emoji]||(c[d.emoji]=[]),c[d.emoji].push(d),c),{}),l=c=>{var u;((u=o[c])==null?void 0:u.some(h=>h.userId===n))&&a.mutate(c)};return Object.keys(o).length===0?null:s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(o).map(([c,d])=>{const u=d.some(h=>h.userId===n);return s.jsxs(te,{variant:"outline",size:"sm",className:`text-xs h-6 px-2 ${u?"bg-blue-100 border-blue-300":"hover:bg-gray-100"}`,onClick:()=>l(c),disabled:a.isPending,children:[c," ",d.length]},c)})})}function tY({children:e,messageId:t,className:n=""}){const[r,i]=j.useState(!1),[a,o]=j.useState({x:0,y:0}),l=j.useRef(),c=j.useRef(0),d=m=>{c.current=Date.now(),m.currentTarget.getBoundingClientRect(),l.current=setTimeout(()=>{o({x:m.clientX,y:m.clientY}),i(!0),"vibrate"in navigator&&navigator.vibrate(50)},500)},u=()=>{l.current&&clearTimeout(l.current),Date.now()-c.current<500&&i(!1)},h=()=>{l.current&&clearTimeout(l.current)},f=()=>{i(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`select-none ${n}`,onPointerDown:d,onPointerUp:u,onPointerLeave:h,style:{touchAction:"manipulation"},children:e}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40",onClick:f}),s.jsx(k5e,{messageId:t,onClose:f,position:a})]})]})}function P5e(){const{teamId:e}=wy(),[,t]=Wt(),{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState("message"),[l,c]=j.useState(""),[d,u]=j.useState(""),{data:h}=Ge({queryKey:["/api/teams",e],enabled:!!e}),{data:f=[]}=Ge({queryKey:["/api/team-players",e],enabled:!!e}),{data:m=[]}=Ge({queryKey:["/api/announcements","team",e],enabled:!!e}),y=ot({mutationFn:async v=>(await bt("POST","/api/announcements",v)).json(),onSuccess:()=>{r({title:"Message sent!",description:`Your ${a} has been sent to the team.`}),c(""),u(""),o("message"),i.invalidateQueries({queryKey:["/api/announcements","team",e]}),i.refetchQueries({queryKey:["/api/announcements","team",e]})},onError:v=>{r({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),x=()=>{const v=a!=="message";if(v&&!l.trim()||!d.trim()){r({title:"Missing information",description:v?"Please enter both a title and content.":"Please enter a message.",variant:"destructive"});return}y.mutate({title:a==="message"?d.slice(0,50)+"...":l,content:d,priority:a==="task"?"high":"medium",teamId:parseInt(e)})},b=v=>{switch(v){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},g=v=>{switch(v){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return!n||n.userType!=="admin"?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/admin-dashboard"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Team Messages"}),s.jsx("p",{className:"text-sm text-gray-600",children:(h==null?void 0:h.name)||"Loading..."})]})]}),s.jsxs(et,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[s.jsx(vs,{className:"w-3 h-3 mr-1"}),f.length," Players"]})]})})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-5 h-5 text-blue-500"}),"Send Message to Team"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Message Type:"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(te,{variant:a==="message"?"default":"outline",size:"sm",onClick:()=>o("message"),className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-4 h-4"}),"Message"]}),s.jsxs(te,{variant:a==="task"?"default":"outline",size:"sm",onClick:()=>o("task"),className:"flex items-center gap-2",children:[s.jsx(Nf,{className:"w-4 h-4"}),"Task"]}),s.jsxs(te,{variant:a==="announcement"?"default":"outline",size:"sm",onClick:()=>o("announcement"),className:"flex items-center gap-2",children:[s.jsx(qu,{className:"w-4 h-4"}),"Announcement"]})]})]}),s.jsxs("div",{className:"space-y-4",children:[a!=="message"&&s.jsxs("div",{children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:[a==="task"?"Task":"Announcement"," Title"]}),s.jsx(qe,{placeholder:`Enter ${a} title...`,value:l,onChange:v=>c(v.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:a==="task"?"Task Description":a==="announcement"?"Announcement":"Message"}),s.jsx(Vs,{placeholder:"What would you like to tell the team?",value:d,onChange:v=>u(v.target.value),rows:4,className:"resize-none"})]}),s.jsxs(te,{onClick:x,disabled:y.isPending,className:"w-full",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send ",a==="task"?"Task":a==="announcement"?"Announcement":"Message"]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center justify-between",children:["Recent Team Messages",s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(et,{variant:"outline",className:"text-xs bg-blue-50",children:[s.jsx(xa,{className:"w-3 h-3 mr-1"}),"Messages"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-orange-50",children:[s.jsx(Nf,{className:"w-3 h-3 mr-1"}),"Tasks"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-green-50",children:[s.jsx(qu,{className:"w-3 h-3 mr-1"}),"Announcements"]})]})]})}),s.jsx(we,{children:m&&m.length>0?s.jsx("div",{className:"space-y-4",children:m.slice(0,10).map(v=>{const _=v.priority==="high"?"task":v.title&&v.title!==`${v.content.slice(0,50)}...`?"announcement":"message";return s.jsx(tY,{messageId:v.id,children:s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${b(_)}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[_!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[g(_),s.jsx("span",{className:"ml-1 capitalize",children:_})]}),s.jsx(et,{variant:"outline",className:"bg-blue-100 text-blue-800 text-xs",children:"Team"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:v.content}),_==="task"&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Task Completion:"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map(B=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-300 flex items-center justify-center",children:Math.random()>.5?"âœ“":""}),s.jsxs("span",{className:"text-gray-600",children:[B.firstName," ",B.lastName]})]},B.id))})]}),_==="announcement"&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Seen by:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(B=>s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${Math.random()>.5?"bg-green-500":"bg-gray-300"}`}),s.jsx("span",{className:"text-gray-600",children:B.firstName})]},B.id))})]}),s.jsx(eY,{reactions:v.reactions||[],messageId:v.id,currentUserId:"test-admin-001"}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:new Date(v.createdAt).toLocaleString()})]})},v.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No messages sent yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Your team messages will appear here"})]})})]})]})]})}function E5e(){const{teamId:e}=wy(),[,t]=Wt(),{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState("message"),[l,c]=j.useState("all"),[d,u]=j.useState(""),[h,f]=j.useState(""),[m,y]=j.useState(""),{data:x}=Ge({queryKey:["/api/teams",e],enabled:!!e}),{data:b=[]}=Ge({queryKey:["/api/team-players",e],enabled:!!e}),g=b.map(F=>({id:`parent-${F.id}`,name:`${F.firstName}'s Parent`,email:`parent.${F.firstName.toLowerCase()}@example.com`,playerName:`${F.firstName} ${F.lastName}`,playerId:F.id})),{data:v=[]}=Ge({queryKey:["/api/announcements","parents",e],enabled:!!e}),_=ot({mutationFn:async F=>(await bt("POST","/api/announcements",F)).json(),onSuccess:()=>{r({title:"Message sent!",description:`Your ${a} has been sent to ${l==="all"?"all parents":"the selected parent"}.`}),f(""),y(""),u(""),o("message"),c("all"),i.invalidateQueries({queryKey:["/api/announcements","parents",e]}),i.refetchQueries({queryKey:["/api/announcements","parents",e]})},onError:F=>{r({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),B=()=>{const F=a!=="message";if(F&&!h.trim()||!m.trim()){r({title:"Missing information",description:F?"Please enter both a title and content.":"Please enter a message.",variant:"destructive"});return}if(l==="individual"&&!d){r({title:"Select recipient",description:"Please select a parent to send the message to.",variant:"destructive"});return}_.mutate({title:a==="message"?m.slice(0,50)+"...":h,content:m,recipientId:l==="individual"?d:null,priority:a==="task"?"high":"medium",teamId:parseInt(e)})},I=F=>{switch(F){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},Q=F=>{switch(F){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return!n||n.userType!=="admin"?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/admin-dashboard"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Parent Messages"}),s.jsx("p",{className:"text-sm text-gray-600",children:(x==null?void 0:x.name)||"Loading..."})]})]}),s.jsxs(et,{variant:"outline",className:"bg-green-50 text-green-700",children:[s.jsx(vs,{className:"w-3 h-3 mr-1"}),g.length," Parents"]})]})})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($i,{className:"w-5 h-5 text-green-500"}),"Send Message to Parents"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Message Type:"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(te,{variant:a==="message"?"default":"outline",size:"sm",onClick:()=>o("message"),className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-4 h-4"}),"Message"]}),s.jsxs(te,{variant:a==="task"?"default":"outline",size:"sm",onClick:()=>o("task"),className:"flex items-center gap-2",children:[s.jsx(Nf,{className:"w-4 h-4"}),"Task"]}),s.jsxs(te,{variant:a==="announcement"?"default":"outline",size:"sm",onClick:()=>o("announcement"),className:"flex items-center gap-2",children:[s.jsx(qu,{className:"w-4 h-4"}),"Announcement"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Send To:"}),s.jsxs("div",{className:"flex gap-3 mb-3",children:[s.jsxs(te,{variant:l==="all"?"default":"outline",size:"sm",onClick:()=>{c("all"),u("")},className:"flex items-center gap-2",children:[s.jsx(vs,{className:"w-4 h-4"}),"All Parents"]}),s.jsxs(te,{variant:l==="individual"?"default":"outline",size:"sm",onClick:()=>c("individual"),className:"flex items-center gap-2",children:[s.jsx($i,{className:"w-4 h-4"}),"Individual Parent"]})]}),l==="individual"&&s.jsxs(Qt,{value:d,onValueChange:u,children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select a parent..."})}),s.jsx(Dt,{children:g.map(F=>s.jsxs(xe,{value:F.id,children:[F.name," (",F.playerName,")"]},F.id))})]})]}),s.jsxs("div",{className:"space-y-4",children:[a!=="message"&&s.jsxs("div",{children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:[a==="task"?"Task":"Announcement"," Title"]}),s.jsx(qe,{placeholder:`Enter ${a} title...`,value:h,onChange:F=>f(F.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:a==="task"?"Task Description":a==="announcement"?"Announcement":"Message"}),s.jsx(Vs,{placeholder:`What would you like to tell the ${l==="all"?"parents":"parent"}?`,value:m,onChange:F=>y(F.target.value),rows:4,className:"resize-none"})]}),s.jsxs(te,{onClick:B,disabled:_.isPending,className:"w-full",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send ",a==="task"?"Task":a==="announcement"?"Announcement":"Message"," to ",l==="all"?"All Parents":"Selected Parent"]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Team Parents"})}),s.jsx(we,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(F=>s.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:F.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Parent of ",F.playerName]}),s.jsx("p",{className:"text-xs text-gray-500",children:F.email})]}),s.jsxs(te,{variant:"outline",size:"sm",onClick:()=>{c("individual"),u(F.id)},children:[s.jsx($i,{className:"w-3 h-3 mr-1"}),"Message"]})]})},F.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Parent Messages"})}),s.jsx(we,{children:v.length>0?s.jsx("div",{className:"space-y-4",children:v.slice(0,10).map(F=>s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${I(F.messageType||"message")}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[F.messageType!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:F.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[Q(F.messageType||"message"),s.jsx("span",{className:"ml-1 capitalize",children:F.messageType||"message"})]}),s.jsx(et,{variant:"outline",className:"bg-green-100 text-green-800 text-xs",children:"Parents"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:F.content}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(F.createdAt).toLocaleString()})]},F.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx($i,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No parent messages sent yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Your parent messages will appear here"})]})})]})]})]})}function F5e(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[r,i]=j.useState(""),{data:a}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"team"],enabled:!!(e!=null&&e.id)}),{data:o=[]}=Ge({queryKey:["/api/team-players",a==null?void 0:a.id],enabled:!!(a!=null&&a.id)}),{data:l=[]}=Ge({queryKey:["/api/announcements","team",a==null?void 0:a.id],enabled:!!(a!=null&&a.id)}),c=ot({mutationFn:async x=>(await bt("POST","/api/announcements",x)).json(),onSuccess:()=>{t({title:"Message sent!",description:"Your message has been sent to the team."}),i(""),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]}),n.refetchQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:x=>{t({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),d=ot({mutationFn:async({announcementId:x,notes:b=""})=>await bt("POST",`/api/tasks/${x}/complete`,{notes:b}),onSuccess:()=>{t({title:"Task completed!",description:"You've marked this task as complete."}),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to complete task. Please try again.",variant:"destructive"})}}),u=ot({mutationFn:async x=>await bt("POST",`/api/announcements/${x}/acknowledge`,{}),onSuccess:()=>{t({title:"Acknowledged!",description:"You've acknowledged this announcement."}),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to acknowledge. Please try again.",variant:"destructive"})}}),h=ot({mutationFn:async({messageId:x,emoji:b})=>await bt("POST",`/api/messages/${x}/reactions`,{emoji:b}),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to add reaction.",variant:"destructive"})}}),f=()=>{if(!r.trim()){t({title:"Missing information",description:"Please enter a message.",variant:"destructive"});return}c.mutate({title:r.slice(0,50)+"...",content:r,priority:"medium",teamId:a==null?void 0:a.id})},m=x=>{switch(x){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},y=x=>{switch(x){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return a?s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-br from-green-500 to-blue-600 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ga,{href:"/player-dashboard",children:s.jsx(te,{variant:"ghost",size:"icon",className:"mr-2",children:s.jsx(vn,{className:"h-5 w-5"})})}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 bg-blue-500",children:s.jsx(xa,{className:"h-5 w-5 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-lg font-bold text-gray-900",children:[a.name," Team Chat"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[o==null?void 0:o.length," team members"]})]})]})]}),s.jsxs(et,{variant:"outline",className:"flex items-center bg-blue-50",children:[s.jsx(vs,{className:"h-3 w-3 mr-1"}),o==null?void 0:o.length]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(ye,{className:"h-fit",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-sm flex items-center",children:[s.jsx(vs,{className:"h-4 w-4 mr-2"}),"Team Members"]})}),s.jsx(we,{className:"space-y-3",children:o.map(x=>{var b,g;return s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(wr,{className:"h-6 w-6",children:[s.jsx(Ur,{src:x.profileImageUrl}),s.jsxs(br,{className:"text-xs",children:[(b=x.firstName)==null?void 0:b[0],(g=x.lastName)==null?void 0:g[0]]})]}),s.jsxs("span",{className:"text-sm text-gray-700",children:[x.firstName," ",x.lastName,x.id===(e==null?void 0:e.id)&&s.jsx("span",{className:"text-blue-500",children:" (You)"})]})]},x.id)})})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsxs(ye,{className:"h-[600px] flex flex-col",children:[s.jsx(Ve,{className:"flex-shrink-0",children:s.jsxs(Ke,{className:"flex items-center justify-between",children:["Team Messages",s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(et,{variant:"outline",className:"text-xs bg-blue-50",children:[s.jsx(xa,{className:"w-3 h-3 mr-1"}),"Messages"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-orange-50",children:[s.jsx(Nf,{className:"w-3 h-3 mr-1"}),"Tasks"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-green-50",children:[s.jsx(qu,{className:"w-3 h-3 mr-1"}),"Announcements"]})]})]})}),s.jsxs(we,{className:"flex-1 flex flex-col p-0",children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l&&l.length>0?l.map(x=>{const b=x.priority==="high"?"task":x.title&&x.title!==`${x.content.slice(0,50)}...`?"announcement":"message";return s.jsx(tY,{messageId:x.id,children:s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${m(b)}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[b!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:x.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[y(b),s.jsx("span",{className:"ml-1 capitalize",children:b})]}),s.jsx(et,{variant:"outline",className:"bg-blue-100 text-blue-800 text-xs",children:"Team"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:x.content}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[b==="task"&&s.jsxs(te,{size:"sm",className:"bg-green-500 hover:bg-green-600 text-white",onClick:()=>d.mutate({announcementId:x.id}),disabled:d.isPending,children:[s.jsx(vc,{className:"w-4 h-4 mr-2"}),d.isPending?"Completing...":"Mark Complete"]}),b==="announcement"&&s.jsxs(te,{size:"sm",variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>u.mutate(x.id),disabled:u.isPending,children:[s.jsx(vc,{className:"w-4 h-4 mr-2"}),u.isPending?"Acknowledging...":"Acknowledge"]}),s.jsx("div",{className:"flex gap-1",children:["ðŸ‘","â¤ï¸","ðŸ˜Š","ðŸ”¥"].map(g=>s.jsx(te,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:()=>h.mutate({messageId:x.id,emoji:g}),disabled:h.isPending,children:g},g))})]}),b==="announcement"&&s.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Acknowledgment:"}),s.jsx(et,{variant:Math.random()>.5?"default":"outline",className:"text-xs",children:Math.random()>.5?s.jsxs(s.Fragment,{children:[s.jsx(vc,{className:"w-3 h-3 mr-1"}),"Seen"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Not Seen"]})})]})}),s.jsx(eY,{reactions:x.reactions||[],messageId:x.id,currentUserId:e==null?void 0:e.id}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:Yn(new Date(x.createdAt),"MMM d, h:mm a")})]})},x.id)}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No messages yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Team messages will appear here"})]})}),s.jsx("div",{className:"border-t p-4 flex-shrink-0",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Vs,{placeholder:"Type your message to the team...",value:r,onChange:x=>i(x.target.value),rows:3,className:"resize-none"}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Share updates with your team"}),s.jsxs(te,{onClick:f,disabled:!r.trim()||c.isPending,className:"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})})]})]})})]})})]}):s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-green-500 to-blue-600 safe-bottom flex items-center justify-center",children:s.jsx(ye,{className:"p-8 text-center",children:s.jsxs(we,{children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"No Team Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You need to be assigned to a team to access team chat."}),s.jsx(ga,{href:"/player-dashboard",children:s.jsx(te,{children:"Back to Dashboard"})})]})})})}const T5e=Pc.isNativePlatform()?"https://boxstat.replit.app":"";function nY(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${T5e}${e}`}const I5e="BAlEnlAUbQITSjTIQoxGppFw8lDmp6qKlvlySV264DR0ddNHKiCYbqsL171T8IctkpZczKOVG3Voms8CFL2PsD0";function L5e(e){const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let a=0;a<r.length;++a)i[a]=r.charCodeAt(a);return i}const Xy=()=>Pc.isNativePlatform()?!1:"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,U5e=async()=>{if(!Xy())throw new Error("Web push notifications are not supported in this browser");const e=await Notification.requestPermission();return console.log("ðŸ”” Notification permission:",e),e},D5e=async()=>{if(!Xy())throw new Error("Web push notifications are not supported in this browser");if(await U5e()!=="granted")throw new Error("Notification permission denied");let t=await navigator.serviceWorker.getRegistration();t||(console.log("ðŸ“ Registering service worker..."),t=await navigator.serviceWorker.register("/sw.js"),console.log("âœ… Service worker registered")),await navigator.serviceWorker.ready;let n=await t.pushManager.getSubscription();return n?console.log("âœ… Already subscribed to push notifications"):(console.log("ðŸ“± Subscribing to push notifications..."),n=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:L5e(I5e)}),console.log("âœ… Subscribed to push notifications")),await R5e(n),n},Q5e=async()=>{if(!Xy())return;const e=await navigator.serviceWorker.getRegistration();if(!e)return;const t=await e.pushManager.getSubscription();t&&(await t.unsubscribe(),console.log("ðŸ”• Unsubscribed from push notifications"),await O5e(t))},M5e=async()=>{if(!Xy())return null;const e=await navigator.serviceWorker.getRegistration();return e?await e.pushManager.getSubscription():null};async function R5e(e){var r,i;const t=e.toJSON(),n=await fetch(nY("/api/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({endpoint:t.endpoint,keys:{p256dh:(r=t.keys)==null?void 0:r.p256dh,auth:(i=t.keys)==null?void 0:i.auth},userAgent:navigator.userAgent,deviceType:"desktop"})});if(!n.ok){const a=await n.text();throw console.error("âŒ Failed to send subscription to backend:",n.status,a),new Error("Failed to register push subscription with server")}console.log("âœ… Push subscription registered with backend")}async function O5e(e){const t=e.toJSON();(await fetch(nY("/api/notifications/unsubscribe"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({endpoint:t.endpoint})})).ok?console.log("âœ… Push subscription removed from backend"):console.error("âŒ Failed to remove subscription from backend")}function H5e(){const[e,t]=j.useState(!1),[n,r]=j.useState(!1),[i,a]=j.useState(!1),{toast:o}=Tt();j.useEffect(()=>{(async()=>{const d=Xy();if(a(d),d){const u=await M5e();t(!!u)}})()},[]);const l=async()=>{if(!i){o({variant:"destructive",title:"Not Supported",description:"Push notifications are not supported in this browser"});return}r(!0);try{e?(await Q5e(),t(!1),o({title:"Unsubscribed",description:"You will no longer receive browser push notifications"})):(await D5e(),t(!0),o({title:"Subscribed!",description:"You will now receive push notifications in your browser"}))}catch(c){console.error("Push notification error:",c),o({variant:"destructive",title:"Error",description:c instanceof Error?c.message:"Failed to toggle push notifications"})}finally{r(!1)}};return i?s.jsx(te,{variant:e?"outline":"default",size:"sm",onClick:l,disabled:n,"data-testid":e?"button-unsubscribe-push":"button-subscribe-push",children:n?s.jsx(Nc,{className:"h-4 w-4 animate-spin"}):e?s.jsxs(s.Fragment,{children:[s.jsx(Ane,{className:"h-4 w-4 mr-2"}),"Disable Browser Notifications"]}):s.jsxs(s.Fragment,{children:[s.jsx(Pi,{className:"h-4 w-4 mr-2"}),"Enable Browser Notifications"]})}):null}const bB="#d82428",V5e=["High School Elite","High School Red","High School Black","Youth Girls","14U Black","14U Red","14U White","12U Black","12U Red","12U White","10U Black","10U Red"],K5e=["9","10","11","12","13","14","15","16","17","18"],z5e=[`4'4"`,`4'5"`,`4'6"`,`4'7"`,`4'8"`,`4'9"`,`4'10"`,`4'11"`,`5'0"`,`5'1"`,`5'2"`,`5'3"`,`5'4"`,`5'5"`,`5'6"`,`5'7"`,`5'8"`,`5'9"`,`5'10"`,`5'11"`,`6'0"`,`6'1"`,`6'2"`,`6'3"`,`6'4"`,`6'5"`,`6'6"`,`6'7"`,`6'8"`,`6'9"`,`6'10"`],$5e=["Point Guard","Shooting Guard","Small Forward","Power Forward","Center"],q5e=Array.from({length:99},(e,t)=>(t+1).toString());function W5e(){const[e,t]=Wt(),[n,r]=j.useState("profile");return j.useEffect(()=>{try{if(typeof window>"u")return;const o=new URL(window.location.href).searchParams.get("tab");o&&["profile","privacy","notifications","security","connections","billing","devices","legal","danger"].includes(o)?r(o):r("profile")}catch{r("profile")}},[e]),[n,a=>{r(a),t(`/settings?tab=${a}`)}]}function DA({icon:e,title:t,subtitle:n}){return s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center",style:{background:"#fee2e2"},children:s.jsx(e,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t}),n&&s.jsx("p",{className:"text-sm text-gray-500",children:n})]})]})}function G5e({value:e,onChange:t}){const[n,r]=j.useState(e||"");return s.jsx("div",{className:"relative",children:s.jsx(qe,{placeholder:"City",value:n,onChange:i=>{r(i.target.value),t(i.target.value)}})})}function Z5e({open:e,onOpenChange:t}){const{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState((n==null?void 0:n.email)||""),l=ot({mutationFn:async()=>{const c=await fetch("/api/account/change-email",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:a})});if(!c.ok)throw new Error("Failed to change email");return c.json()},onSuccess:()=>{r({title:"Email updated",description:"Please verify your new email."}),i.invalidateQueries({queryKey:["/api/users",n==null?void 0:n.id]}),t(!1)},onError:c=>r({title:"Could not update email",description:String(c),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Change Email"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(qe,{value:a,onChange:c=>o(c.target.value),placeholder:"you@example.com"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Weâ€™ll send a verification link to your new address."})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),s.jsx(te,{onClick:()=>l.mutate(),disabled:l.isPending,children:l.isPending?"Saving...":"Save"})]})]})})}function Y5e({open:e,onOpenChange:t}){const{toast:n}=Tt(),[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(""),d=ot({mutationFn:async()=>{if(a!==l)throw new Error("Passwords do not match");const u=await fetch("/api/account/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({current:r,next:a})});if(!u.ok)throw new Error("Failed to change password");return u.json()},onSuccess:()=>{n({title:"Password updated",description:"Your password has been changed."}),t(!1),i(""),o(""),c("")},onError:u=>n({title:"Could not change password",description:String(u),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Change Password"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(qe,{type:"password",placeholder:"Current password",value:r,onChange:u=>i(u.target.value)}),s.jsx(qe,{type:"password",placeholder:"New password",value:a,onChange:u=>o(u.target.value)}),s.jsx(qe,{type:"password",placeholder:"Confirm new password",value:l,onChange:u=>c(u.target.value)})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),s.jsx(te,{onClick:()=>d.mutate(),disabled:d.isPending,children:d.isPending?"Saving...":"Save"})]})]})})}function X5e({open:e,onOpenChange:t}){const{toast:n}=Tt(),[r,i]=j.useState(!1),a=ot({mutationFn:async o=>{const l=await fetch("/api/account/2fa",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({enable:o})});if(!l.ok)throw new Error("Failed to update 2FA");return l.json()},onSuccess:()=>{n({title:"Two-factor updated"}),t(!1)},onError:o=>n({title:"Could not update 2FA",description:String(o),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Two-Factor Authentication"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Add an extra layer of security to your account. Use an authenticator app to generate one-time codes."}),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"Enable 2FA"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Use an authenticator app (TOTP)"})]}),s.jsx(cn,{checked:r,onCheckedChange:i})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Close"}),s.jsx(te,{onClick:()=>a.mutate(r),children:r?"Enable":"Disable"})]})]})})}function J5e({open:e,onOpenChange:t}){const{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState(""),[l,c]=j.useState(""),[d,u]=j.useState(!1);j.useEffect(()=>{n&&(n!=null&&n.passcode)&&u(!0)},[n]);const h=(y,x)=>{const b=y.replace(/\D/g,"").slice(0,4);x(b)},f=ot({mutationFn:async()=>{if(a.length!==4)throw new Error("Passcode must be 4 digits");if(a!==l)throw new Error("Passcodes do not match");const y=await fetch(`/api/users/${n==null?void 0:n.id}/passcode`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({passcode:a})});if(!y.ok)throw new Error("Failed to set passcode");return y.json()},onSuccess:()=>{r({title:"Passcode set",description:"Your 4-digit passcode has been saved."}),i.invalidateQueries({queryKey:["/api/auth/user"]}),o(""),c(""),u(!0),t(!1)},onError:y=>r({title:"Could not set passcode",description:String(y),variant:"destructive"})}),m=ot({mutationFn:async()=>{const y=await fetch(`/api/users/${n==null?void 0:n.id}/passcode`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(!y.ok)throw new Error("Failed to remove passcode");return y.json()},onSuccess:()=>{r({title:"Passcode removed",description:"Your passcode has been removed."}),i.invalidateQueries({queryKey:["/api/auth/user"]}),u(!1),t(!1)},onError:y=>r({title:"Could not remove passcode",description:String(y),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Profile Passcode"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:d?"You have a passcode set for profile switching. You can update it or remove it.":"Set a 4-digit passcode to secure profile switching. You'll need to enter this code when switching between profiles."}),!d&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"New Passcode"}),s.jsx(qe,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter 4 digits",value:a,onChange:y=>h(y.target.value,o),maxLength:4,"data-testid":"input-passcode"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Confirm Passcode"}),s.jsx(qe,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter 4 digits again",value:l,onChange:y=>h(y.target.value,c),maxLength:4,"data-testid":"input-confirm-passcode"})]})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),d?s.jsx(te,{variant:"destructive",onClick:()=>m.mutate(),disabled:m.isPending,"data-testid":"button-remove-passcode",children:m.isPending?"Removing...":"Remove Passcode"}):s.jsx(te,{onClick:()=>f.mutate(),disabled:f.isPending||a.length!==4||l.length!==4,"data-testid":"button-set-passcode",children:f.isPending?"Setting...":"Set Passcode"})]})]})})}function XL(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),{data:r}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[i,a]=j.useState({firstName:"",lastName:"",teamName:"",age:"",height:"",location:"",position:"",jerseyNumber:""});j.useEffect(()=>{var l;r&&a({firstName:r.firstName||"",lastName:r.lastName||"",teamName:r.teamId||"",age:(e==null?void 0:e.age)||"",height:(e==null?void 0:e.height)||"",location:r.address||"",position:r.position||"",jerseyNumber:((l=r.jerseyNumber)==null?void 0:l.toString())||""})},[r,e]);const o=ot({mutationFn:async l=>{const c={firstName:l.firstName,lastName:l.lastName,address:l.location,teamName:l.teamName,age:l.age,height:l.height,position:l.position,jerseyNumber:l.jerseyNumber?parseInt(l.jerseyNumber):null},d=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!d.ok)throw new Error("Failed to save profile");return d.json()},onSuccess:l=>{var c;t({title:"Profile updated",description:"Changes saved successfully."}),l&&a({firstName:l.firstName||"",lastName:l.lastName||"",teamName:l.teamId||"",age:(e==null?void 0:e.age)||"",height:(e==null?void 0:e.height)||"",location:l.address||"",position:l.position||"",jerseyNumber:((c=l.jerseyNumber)==null?void 0:c.toString())||""}),n.invalidateQueries({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]})},onError:l=>t({title:"Save failed",description:String(l),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Us,title:"Profile Information",subtitle:"Update your basic details and team info."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"space-y-5 p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Name"}),s.jsx(qe,{value:i.firstName,onChange:l=>a(c=>({...c,firstName:l.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx(qe,{value:i.lastName,onChange:l=>a(c=>({...c,lastName:l.target.value}))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Team"}),s.jsxs(Qt,{value:i.teamName,onValueChange:l=>a(c=>({...c,teamName:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select team"})}),s.jsx(Dt,{children:V5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Age"}),s.jsxs(Qt,{value:i.age,onValueChange:l=>a(c=>({...c,age:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select age"})}),s.jsx(Dt,{children:K5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Height"}),s.jsxs(Qt,{value:i.height,onValueChange:l=>a(c=>({...c,height:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select height"})}),s.jsx(Dt,{children:z5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Position"}),s.jsxs(Qt,{value:i.position,onValueChange:l=>a(c=>({...c,position:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select position"})}),s.jsx(Dt,{children:$5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jersey Number"}),s.jsxs(Qt,{value:i.jerseyNumber,onValueChange:l=>a(c=>({...c,jerseyNumber:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select number"})}),s.jsx(Dt,{children:q5e.map(l=>s.jsxs(xe,{value:l,children:["#",l]},l))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),s.jsx(G5e,{value:i.location,onChange:l=>a(c=>({...c,location:l}))})]}),s.jsx("div",{className:"pt-2",children:s.jsx(te,{className:"w-full sm:w-auto",onClick:()=>o.mutate(i),disabled:o.isPending,children:o.isPending?"Saving...":"Save Changes"})})]})})]})}function eBe(){const{user:e}=dn(),{toast:t}=Tt(),[n,r]=j.useState({makeProfilePublic:!0,showProfileToTeamOnly:!1,allowGpsCheckin:!0,allowCameraMic:!0,shareAnalytics:!0}),i=ot({mutationFn:async()=>{const a=await fetch(`/api/privacy/${e==null?void 0:e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update privacy");return a.json()},onSuccess:()=>t({title:"Privacy updated"}),onError:a=>t({title:"Could not update",description:String(a),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Fi,title:"Privacy & Permissions",subtitle:"Control visibility and device permissions."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[[{k:"makeProfilePublic",label:"Make profile public",icon:_y},{k:"showProfileToTeamOnly",label:"Show profile to team only",icon:$w},{k:"allowGpsCheckin",label:"Allow GPS-based on-site check-in",icon:Yi},{k:"allowCameraMic",label:"Allow camera & microphone for uploads",icon:$w},{k:"shareAnalytics",label:"Share anonymized usage analytics",icon:$w}].map(a=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(a.icon,{className:"h-5 w-5 text-gray-600"}),s.jsx("div",{className:"text-sm",children:a.label})]}),s.jsx(cn,{checked:n[a.k],onCheckedChange:o=>r(l=>({...l,[a.k]:o}))})]},a.k)),s.jsx("div",{className:"pt-2",children:s.jsx(te,{onClick:()=>i.mutate(),disabled:i.isPending,children:i.isPending?"Saving...":"Save Preferences"})})]})}),s.jsxs(ye,{className:"bg-transparent border-0 shadow-none",children:[s.jsx(Ve,{className:"px-6",children:s.jsx(Ke,{className:"text-base",children:"Blocked Users"})}),s.jsx(we,{className:"p-6",children:s.jsx("div",{className:"text-sm text-gray-500",children:"No blocked users."})})]})]})}function tBe(){const{toast:e}=Tt(),[t,n]=j.useState({pushTeamMessages:!0,pushEventReminders:!0,pushCheckinWindows:!0,pushProgramUpdates:!1,quietHours:!1}),r=ot({mutationFn:async()=>{const i=await fetch("/api/notifications/prefs",{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to update notifications");return i.json()},onSuccess:()=>e({title:"Notification settings saved"}),onError:i=>e({title:"Could not save",description:String(i),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Pi,title:"Notifications",subtitle:"Choose how you want to be notified."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(PC,{title:"Browser Push Notifications",children:s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable push notifications in your browser to receive real-time updates"}),s.jsx(H5e,{})]})}),s.jsx(Fl,{}),s.jsxs(PC,{title:"Push Notifications",children:[s.jsx(wu,{label:"Team messages",checked:t.pushTeamMessages,onChange:i=>n(a=>({...a,pushTeamMessages:i}))}),s.jsx(wu,{label:"Event reminders",checked:t.pushEventReminders,onChange:i=>n(a=>({...a,pushEventReminders:i}))}),s.jsx(wu,{label:"Check-in/RSVP windows",checked:t.pushCheckinWindows,onChange:i=>n(a=>({...a,pushCheckinWindows:i}))}),s.jsx(wu,{label:"Program updates",checked:t.pushProgramUpdates,onChange:i=>n(a=>({...a,pushProgramUpdates:i}))})]}),s.jsx(Fl,{}),s.jsx(PC,{title:"Preferences",children:s.jsx(wu,{label:"Quiet hours (10pmâ€“7am)",checked:t.quietHours,onChange:i=>n(a=>({...a,quietHours:i}))})}),s.jsx("div",{className:"pt-2",children:s.jsx(te,{onClick:()=>r.mutate(),disabled:r.isPending,children:r.isPending?"Saving...":"Save Notification Settings"})})]})})]})}function nBe(){const[e,t]=j.useState(!1),[n,r]=j.useState(!1),[i,a]=j.useState(!1),[o,l]=j.useState(!1);Wt();const c=async()=>{try{await fetch("/api/logout",{method:"GET",credentials:"include"}),window.location.href="/"}catch(d){console.error("Logout error:",d),window.location.href="/"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Fi,title:"Account & Security",subtitle:"Manage login and security."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(uA,{icon:jh,title:"Profile Passcode",action:s.jsx(te,{variant:"outline",onClick:()=>l(!0),children:"Set"})}),s.jsx(uA,{icon:$i,title:"Change email",action:s.jsx(te,{variant:"outline",onClick:()=>t(!0),children:"Update"})}),s.jsx(uA,{icon:b8,title:"Change password",action:s.jsx(te,{variant:"outline",onClick:()=>r(!0),children:"Update"})}),s.jsx(uA,{icon:wne,title:"Two-factor authentication (2FA)",action:s.jsx(te,{variant:"outline",onClick:()=>a(!0),children:"Manage"})}),s.jsx(uA,{icon:Hb,title:"Log Out",action:s.jsx(te,{variant:"destructive",onClick:c,children:"Log Out"})}),s.jsx(uA,{icon:Hb,title:"Sign out of all devices",action:s.jsx(te,{variant:"destructive",children:"Sign out all"})})]})}),s.jsx(Z5e,{open:e,onOpenChange:t}),s.jsx(Y5e,{open:n,onOpenChange:r}),s.jsx(X5e,{open:i,onOpenChange:a}),s.jsx(J5e,{open:o,onOpenChange:l})]})}function sBe(){const{toast:e}=Tt(),{user:t}=dn(),n=os(),[r,i]=j.useState(!0),[a,o]=j.useState((t==null?void 0:t.email)||""),[l,c]=j.useState(!1),{data:d}=Ge({queryKey:["/api/auth/user"],queryFn:async()=>{const b=await fetch("/api/auth/user",{credentials:"include"});if(!b.ok)throw new Error("Failed to fetch user");return b.json()}}),u=!!(d!=null&&d.linkedAccountId),h=ot({mutationFn:async b=>{const g=await fetch("/api/settings/link-account",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:b})});if(!g.ok){const v=await g.json();throw new Error(v.message||"Failed to link account")}return g.json()},onSuccess:b=>{e({title:"Account Linked!",description:`Successfully linked to ${b.account.email}. ${b.profiles.length} profile(s) loaded.`}),c(!1),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/profiles/me"]})},onError:b=>{e({title:"Link Failed",description:b.message,variant:"destructive"})}}),f=ot({mutationFn:async()=>{const b=await fetch("/api/settings/unlink-account",{method:"POST",credentials:"include"});if(!b.ok){const g=await b.json();throw new Error(g.message||"Failed to unlink account")}return b.json()},onSuccess:()=>{e({title:"Account Unlinked",description:"Your account has been unlinked successfully."}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/profiles/me"]})},onError:b=>{e({title:"Unlink Failed",description:b.message,variant:"destructive"})}}),m=()=>{if(!a||!a.trim()){e({title:"Email Required",description:"Please enter your email address",variant:"destructive"});return}h.mutate(a)},y=async()=>{try{window.location.href="/api/connections/google/start"}catch(b){e({title:"Connection failed",description:String(b),variant:"destructive"})}},x=async()=>{try{if(!(await fetch("/api/connections/google/disconnect",{method:"POST",credentials:"include"})).ok)throw new Error("Disconnect failed");i(!1),e({title:"Disconnected Google Calendar"})}catch(b){e({title:"Could not disconnect",description:String(b),variant:"destructive"})}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:cj,title:"Connections",subtitle:"Link your program account and connect calendars."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-lg bg-red-50 flex items-center justify-center",children:s.jsx(vs,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"BoxStat Account"}),s.jsx("div",{className:"text-xs text-gray-500",children:u?"Linked - Profile data synced":"Not linked - Link to access your program data"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:u?s.jsx(te,{variant:"ghost",onClick:()=>f.mutate(),disabled:f.isPending,"data-testid":"button-unlink-account",children:f.isPending?"Unlinking...":"Unlink"}):s.jsx(te,{onClick:()=>c(!0),"data-testid":"button-link-account",children:"Link Account"})})]}),s.jsx(Fl,{}),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-lg bg-red-50 flex items-center justify-center",children:s.jsx(dr,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"Google Calendar"}),s.jsx("div",{className:"text-xs text-gray-500",children:r?"Connected":"Not connected"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:r?s.jsxs(s.Fragment,{children:[s.jsxs(te,{variant:"outline",onClick:()=>window.location.href="/api/connections/google/manage",children:["Manage ",s.jsx(xA,{className:"h-4 w-4 ml-1"})]}),s.jsx(te,{variant:"ghost",onClick:x,children:"Disconnect"})]}):s.jsx(te,{onClick:y,children:"Connect"})})]}),s.jsxs("div",{className:"rounded-lg p-3 hover:bg-gray-50",children:[s.jsx("div",{className:"text-sm font-medium mb-1",children:"Sync options"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[s.jsx(wu,{label:"Team events",defaultChecked:!0}),s.jsx(wu,{label:"Games",defaultChecked:!0}),s.jsx(wu,{label:"Practices",defaultChecked:!0})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Your team tags determine which events appear in your in-app calendar."})]})]})}),s.jsx($n,{open:l,onOpenChange:c,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Link Your Program Account"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Enter your email to link your account and automatically load your profile information from the program database."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Email Address"}),s.jsx(qe,{type:"email",placeholder:"your@email.com",value:a,onChange:b=>o(b.target.value),disabled:h.isPending,"data-testid":"input-link-email"}),s.jsx("p",{className:"text-xs text-gray-500",children:"This must be the email you used when registering for the program."})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>c(!1),disabled:h.isPending,children:"Cancel"}),s.jsx(te,{onClick:m,disabled:h.isPending,"data-testid":"button-confirm-link",children:h.isPending?"Linking...":"Link Account"})]})]})})]})}function rBe(){return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:ba,title:"Subscription & Billing",subtitle:"Manage your plan and payment methods."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Current plan"}),s.jsx("div",{className:"text-base font-semibold",children:"Foundation Program â€” Monthly"})]}),s.jsx(et,{className:"bg-emerald-100 text-emerald-700",children:"Active"})]}),s.jsx(Fl,{}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Next charge: ",s.jsx("span",{className:"font-medium",children:"$29 on the 15th"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{variant:"outline",onClick:()=>window.location.href="/billing",children:"Manage"}),s.jsx(te,{className:"bg-gray-900 text-white hover:bg-black",children:"Update card"})]})]})]})})]})}function iBe(){const{data:e=[]}=Ge({queryKey:["/api/sessions"],queryFn:async()=>{const t=await fetch("/api/sessions",{credentials:"include"});return t.ok?t.json():[]}});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:BA,title:"Devices & Sessions",subtitle:"Manage where you're signed in."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-3",children:[e.length===0&&s.jsx("div",{className:"text-sm text-gray-500",children:"No active sessions."}),e.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"font-medium",children:t.device||"Unknown device"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[t.location||"â€”"," â€¢ ",t.lastActive?new Date(t.lastActive).toLocaleString():"Now"]})]}),s.jsx(te,{variant:"outline",size:"sm",children:"Sign out"})]},t.id))]})})]})}function aBe(){return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:wo,title:"Legal & Data",subtitle:"Export your data or review policies."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(uA,{icon:wo,title:"Export my data",action:s.jsx(te,{variant:"outline",children:"Export"})}),s.jsx(uA,{icon:xA,title:"Privacy Policy",action:s.jsx(te,{variant:"ghost",children:"Open"})}),s.jsx(uA,{icon:xA,title:"Terms of Service",action:s.jsx(te,{variant:"ghost",children:"Open"})})]})})]})}function oBe(){const{user:e,logout:t}=dn(),{toast:n}=Tt(),[r,i]=j.useState(!1),[a,o]=j.useState(""),[l,c]=j.useState(!1),d=(e==null?void 0:e.email)||"",u=(e==null?void 0:e.role)||"",h=async()=>{if(a!==d){n({title:"Email doesn't match",description:"Please enter your email exactly as shown.",variant:"destructive"});return}c(!0);try{const f=await fetch("/api/account/delete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmEmail:a})});if(f.ok)n({title:"Account deleted",description:"Your account has been deactivated successfully."}),t(),window.location.href="/";else{const m=await f.json();n({title:"Delete failed",description:m.message||"Could not delete account.",variant:"destructive"})}}catch{n({title:"Delete failed",description:"An error occurred. Please try again.",variant:"destructive"})}finally{c(!1)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:qi,title:"Danger Zone",subtitle:"Irreversible actions."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-red-700",children:"Delete account"}),s.jsxs("div",{className:"text-xs text-red-600",children:["Your account will be deactivated and data removed.",(u==="parent"||u==="admin")&&" This includes all linked player profiles."]})]}),s.jsx(te,{variant:"destructive",onClick:()=>i(!0),"data-testid":"button-delete-account",children:"Delete"})]})})}),s.jsx($n,{open:r,onOpenChange:i,children:s.jsxs(Qn,{className:"max-w-md",children:[s.jsx(es,{children:s.jsxs(qn,{className:"text-red-600 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Delete Your Account"]})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-red-800 font-medium mb-2",children:"This action cannot be undone!"}),s.jsxs("ul",{className:"text-xs text-red-700 list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Your account will be deactivated"}),s.jsx("li",{children:"Your login credentials will be removed"}),(u==="parent"||u==="admin")&&s.jsx("li",{children:"All linked player profiles will also be deactivated"}),s.jsx("li",{children:"Any active subscriptions will be cancelled"}),s.jsx("li",{children:"You will lose access to all features and history"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"To confirm, please type your email address:"}),s.jsx("p",{className:"text-sm font-mono bg-gray-100 p-2 rounded",children:d}),s.jsx(qe,{type:"email",placeholder:"Enter your email to confirm",value:a,onChange:f=>o(f.target.value),className:"border-red-200 focus:border-red-500","data-testid":"input-confirm-email"})]})]}),s.jsxs(IA,{className:"gap-2",children:[s.jsx(te,{variant:"outline",onClick:()=>{i(!1),o("")},disabled:l,"data-testid":"button-cancel-delete",children:"Cancel"}),s.jsx(te,{variant:"destructive",onClick:h,disabled:l||a!==d,"data-testid":"button-confirm-delete",children:l?"Deleting...":"Permanently Delete Account"})]})]})})]})}function PC({title:e,children:t}){return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-800",children:e}),s.jsx("div",{className:"space-y-2",children:t})]})}function wu({label:e,checked:t,onChange:n,defaultChecked:r}){const[i,a]=j.useState(t??!!r);return j.useEffect(()=>{t!==void 0&&a(t)},[t]),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsx("div",{className:"text-sm",children:e}),s.jsx(cn,{checked:i,onCheckedChange:o=>{a(o),n==null||n(o)}})]})}function uA({icon:e,title:t,action:n}){return s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(e,{className:"h-5 w-5 text-gray-600"}),s.jsx("div",{className:"text-sm",children:t})]}),n]})}function lBe(e){switch(e){case"profile":return s.jsx(XL,{});case"privacy":return s.jsx(eBe,{});case"notifications":return s.jsx(tBe,{});case"security":return s.jsx(nBe,{});case"connections":return s.jsx(sBe,{});case"billing":return s.jsx(rBe,{});case"devices":return s.jsx(iBe,{});case"legal":return s.jsx(aBe,{});case"danger":return s.jsx(oBe,{});default:return s.jsx(XL,{})}}function cBe(){const{user:e}=dn(),[,t]=Wt(),[n,r]=W5e(),i=[{key:"profile",label:"Profile",icon:Us},{key:"privacy",label:"Privacy & Permissions",icon:Fi},{key:"notifications",label:"Notifications",icon:Pi},{key:"security",label:"Account & Security",icon:$w},{key:"connections",label:"Connections",icon:cj},{key:"billing",label:"Billing",icon:ba},{key:"devices",label:"Devices",icon:BA},{key:"legal",label:"Legal & Data",icon:wo},{key:"danger",label:"Danger Zone",icon:qi}];return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white/70 backdrop-blur border-b border-gray-200 px-4 py-4 sticky top-0 z-10 safe-top",children:s.jsx("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>t("/player-dashboard"),className:"h-8 w-8",children:s.jsx(vn,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Settings"}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Signed in as ",e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]})]})]})})}),s.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-6 p-4",children:[s.jsx("aside",{className:"md:col-span-1",children:s.jsx("nav",{className:"rounded-xl p-2",children:i.map(a=>{const o=n===a.key;return s.jsxs("button",{onClick:()=>r(a.key),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${o?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100"}`,"aria-current":o?"page":void 0,children:[s.jsx(a.icon,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:a.label})]},a.key)})})}),s.jsx("main",{className:"md:col-span-3",children:s.jsx("div",{className:"rounded-xl",children:lBe(n)})})]})]})}function dBe(){const[,e]=Wt(),[t,n]=Ft.useState(!1);Ft.useEffect(()=>{const i=()=>{const a=localStorage.getItem("deviceLockedToPlayer"),o=localStorage.getItem("selectedPlayerId");n(a===o&&a!==null)};return i(),window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)},[]);const r=[{key:"profile",icon:Us,label:"Player Profile",description:"Basketball info and personal details",path:"/player-settings/profile"},{key:"privacy",icon:_y,label:"Privacy",description:"Control your visibility and data sharing",path:"/player-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/player-settings/notifications"},{key:"security",icon:Fi,label:"Account & Security",description:"Password and device management",path:"/player-settings/security"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/player-settings/legal"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Player Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:r.map(i=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(i.path),"data-testid":`settings-item-${i.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(i.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:i.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},i.key))})]})})}function ABe(){const[,e]=Wt(),t=[{key:"profile",icon:Us,label:"Profile",description:"Personal information and contact details",path:"/coach-settings/profile"},{key:"privacy",icon:Fi,label:"Privacy",description:"Control your visibility and data sharing",path:"/coach-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/coach-settings/notifications"},{key:"security",icon:b8,label:"Security",description:"Password and account management",path:"/coach-settings/security"},{key:"connections",icon:cj,label:"Connections",description:"External apps and integrations",path:"/coach-settings/connections"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/coach-settings/legal"},{key:"danger",icon:qi,label:"Account Actions",description:"Delete account and danger zone",path:"/coach-settings/danger"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/coach-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Coach Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:t.map(n=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(n.path),"data-testid":`settings-item-${n.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(n.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:n.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},n.key))})]})})}function uBe(){const[,e]=Wt(),t=[{key:"profile",icon:Us,label:"Profile",description:"Personal information and preferences",path:"/parent-settings/profile"},{key:"privacy",icon:_y,label:"Privacy",description:"Control your visibility and data sharing",path:"/parent-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/parent-settings/notifications"},{key:"security",icon:Fi,label:"Account & Security",description:"Password, 2FA, and device management",path:"/parent-settings/security"},{key:"connections",icon:cj,label:"Connections",description:"Connected apps and services",path:"/parent-settings/connections"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/parent-settings/legal"},{key:"danger",icon:qi,label:"Danger Zone",description:"Account deletion and irreversible actions",path:"/parent-settings/danger"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/parent-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Parent Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:t.map(n=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(n.path),"data-testid":`settings-item-${n.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(n.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:n.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},n.key))})]})})}function Um({className:e,...t}){return s.jsx("div",{className:_t("animate-pulse rounded-md bg-muted",e),...t})}const JL={Prospect:"bg-gray-500",Starter:"bg-green-500",AllStar:"bg-blue-500",Superstar:"bg-purple-500",HallOfFame:"bg-yellow-500"},hBe={Prospect:"text-gray-600 dark:text-gray-400",Starter:"text-green-600 dark:text-green-400",AllStar:"text-blue-600 dark:text-blue-400",Superstar:"text-purple-600 dark:text-purple-400",HallOfFame:"text-yellow-600 dark:text-yellow-400"},fBe={Prospect:"border-gray-500",Starter:"border-green-500",AllStar:"border-blue-500",Superstar:"border-purple-500",HallOfFame:"border-yellow-500"};function mBe(){const{user:e}=dn(),{currentChildProfile:t}=LS(),[,n]=Wt(),[r,i]=j.useState("all"),[a,o]=j.useState("all"),[l,c]=j.useState("newest"),d=typeof window<"u"?localStorage.getItem("selectedPlayerId"):null,u=(e==null?void 0:e.activeProfileId)||d,h=u||(t==null?void 0:t.id)||(e==null?void 0:e.id),{data:f,isLoading:m}=Ge({queryKey:["/api/award-definitions"],enabled:!!e}),{data:y,isLoading:x}=Ge({queryKey:["/api/user-awards",h],queryFn:async()=>{const P=u?`/api/user-awards?userId=${u}`:"/api/user-awards",T=await fetch(P,{credentials:"include"});if(!T.ok)throw new Error("Failed to fetch user awards");return T.json()},enabled:!!e&&!!h}),b=j.useMemo(()=>!f||!y?[]:y.filter(P=>P.visible).map(P=>{const T=f.find($=>$.id===P.awardId);return T?{...T,earnedDate:P.awardedAt,awardedBy:P.awardedBy||void 0,year:P.year||void 0,notes:P.notes||void 0}:null}).filter(P=>P!==null),[f,y]),g=j.useMemo(()=>{if(!f)return[];const P=new Set(b.map(T=>T.id));return f.filter(T=>T.active&&!P.has(T.id))},[f,b]),v=j.useMemo(()=>{let P=b;return r!=="all"&&(P=P.filter(T=>T.tier===r)),a!=="all"&&(P=P.filter(T=>T.prestige===a)),P.sort((T,$)=>{if(l==="newest")return new Date($.earnedDate).getTime()-new Date(T.earnedDate).getTime();if(l==="oldest")return new Date(T.earnedDate).getTime()-new Date($.earnedDate).getTime();{const D=["HallOfFame","Superstar","AllStar","Starter","Prospect"];return D.indexOf(T.prestige)-D.indexOf($.prestige)}})},[b,r,a,l]),_=j.useMemo(()=>{let P=g;return r!=="all"&&(P=P.filter(T=>T.tier===r)),a!=="all"&&(P=P.filter(T=>T.prestige===a)),P.sort((T,$)=>{const D=["HallOfFame","Superstar","AllStar","Starter","Prospect"];return D.indexOf(T.prestige)-D.indexOf($.prestige)})},[g,r,a]),B=j.useMemo(()=>{const P=b.filter($=>$.tier==="Trophy"),T=b.filter($=>$.tier==="Badge");return{total:b.length,trophies:P.length,badges:T.length}},[b]),I=m||x,Q=()=>{n("/player-dashboard")},F=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-b from-red-950 via-gray-900 to-black text-white safe-bottom",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:Q,className:"p-2 hover:bg-white/10 rounded-lg transition-colors","data-testid":"button-back",children:s.jsx(vn,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-page-title",children:"My Trophies & Badges"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1","data-testid":"text-page-subtitle",children:"Track your achievements and earn rewards for your dedication"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-total",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Total Awards"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.total})]}),s.jsx($u,{className:"h-8 w-8 text-yellow-500"})]})})}),s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-trophies",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Trophies"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.trophies})]}),s.jsx(Ai,{className:"h-8 w-8 text-orange-500"})]})})}),s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-badges",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Badges"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.badges})]}),s.jsx($u,{className:"h-8 w-8 text-blue-500"})]})})})]}),s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(vne,{className:"h-4 w-4"}),s.jsx("span",{className:"font-semibold",children:"Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Type"}),s.jsxs(Qt,{value:r,onValueChange:P=>i(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-tier",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"all",children:"All Types"}),s.jsx(xe,{value:"Trophy",children:"Trophies Only"}),s.jsx(xe,{value:"Badge",children:"Badges Only"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Prestige Level"}),s.jsxs(Qt,{value:a,onValueChange:P=>o(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-prestige",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"all",children:"All Levels"}),s.jsx(xe,{value:"HallOfFame",children:"Hall of Fame"}),s.jsx(xe,{value:"Superstar",children:"Superstar"}),s.jsx(xe,{value:"AllStar",children:"All-Star"}),s.jsx(xe,{value:"Starter",children:"Starter"}),s.jsx(xe,{value:"Prospect",children:"Prospect"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Sort By"}),s.jsxs(Qt,{value:l,onValueChange:P=>c(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-sort",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"newest",children:"Newest First"}),s.jsx(xe,{value:"oldest",children:"Oldest First"}),s.jsx(xe,{value:"prestige",children:"Prestige (High to Low)"})]})]})]})]})]})}),s.jsxs(My,{defaultValue:"earned",className:"w-full",children:[s.jsxs(Fg,{className:"grid w-full grid-cols-2 bg-white/10","data-testid":"tabs-awards",children:[s.jsxs(Wr,{value:"earned","data-testid":"tab-earned",children:["Earned (",v.length,")"]}),s.jsxs(Wr,{value:"available","data-testid":"tab-available",children:["Available (",_.length,")"]})]}),s.jsx(Gr,{value:"earned",className:"mt-6",children:I?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((P,T)=>s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsx(Um,{className:"h-32 w-full mb-4 bg-white/10"}),s.jsx(Um,{className:"h-4 w-3/4 mb-2 bg-white/10"}),s.jsx(Um,{className:"h-3 w-full bg-white/10"})]})},T))}):v.length===0?s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-12 pb-12 text-center",children:[s.jsx(Ai,{className:"h-16 w-16 mx-auto mb-4 text-gray-500"}),s.jsx("h3",{className:"text-xl font-semibold mb-2","data-testid":"text-empty-state",children:"No Awards Yet"}),s.jsx("p",{className:"text-gray-400","data-testid":"text-empty-message",children:"Start attending practices and games to earn your first trophy!"})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:v.map(P=>s.jsxs(ye,{className:`bg-white/5 border-2 ${fBe[P.prestige]} hover:scale-105 transition-transform duration-200`,"data-testid":`card-award-${P.id}`,children:[s.jsxs(Ve,{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx(et,{className:JL[P.prestige],"data-testid":`badge-prestige-${P.id}`,children:P.prestige}),s.jsx(et,{variant:"outline",className:"border-white/20","data-testid":`badge-tier-${P.id}`,children:P.tier})]}),s.jsx("div",{className:"aspect-square bg-white/10 rounded-lg flex items-center justify-center mb-4 overflow-hidden",children:P.imageUrl?s.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-contain","data-testid":`img-award-${P.id}`}):s.jsx(Ai,{className:`h-20 w-20 ${hBe[P.prestige]}`})}),s.jsx(Ke,{className:"text-lg leading-tight","data-testid":`text-award-name-${P.id}`,children:P.name}),P.description&&s.jsx(zn,{className:"text-gray-400 text-sm mt-2","data-testid":`text-award-description-${P.id}`,children:P.description})]}),s.jsxs(we,{children:[s.jsxs("p",{className:"text-xs text-gray-400","data-testid":`text-earned-date-${P.id}`,children:["Earned: ",F(P.earnedDate)]}),P.year&&s.jsxs("p",{className:"text-xs text-gray-400","data-testid":`text-award-year-${P.id}`,children:["Year: ",P.year]})]})]},P.id))})}),s.jsx(Gr,{value:"available",className:"mt-6",children:I?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((P,T)=>s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsx(Um,{className:"h-32 w-full mb-4 bg-white/10"}),s.jsx(Um,{className:"h-4 w-3/4 mb-2 bg-white/10"}),s.jsx(Um,{className:"h-3 w-full bg-white/10"})]})},T))}):_.length===0?s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-12 pb-12 text-center",children:[s.jsx($u,{className:"h-16 w-16 mx-auto mb-4 text-gray-500"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"All Awards Earned!"}),s.jsx("p",{className:"text-gray-400",children:"Congratulations! You've earned all available awards."})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:_.map(P=>s.jsxs(ye,{className:"bg-white/5 border-white/10 opacity-60 hover:opacity-80 transition-opacity duration-200","data-testid":`card-available-award-${P.id}`,children:[s.jsxs(Ve,{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx(et,{className:`${JL[P.prestige]} opacity-50`,"data-testid":`badge-prestige-available-${P.id}`,children:P.prestige}),s.jsx(et,{variant:"outline",className:"border-white/20","data-testid":`badge-tier-available-${P.id}`,children:P.tier})]}),s.jsx("div",{className:"aspect-square bg-white/10 rounded-lg flex items-center justify-center mb-4 overflow-hidden grayscale",children:P.imageUrl?s.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-contain","data-testid":`img-available-award-${P.id}`}):s.jsx(Ai,{className:"h-20 w-20 text-gray-500"})}),s.jsx(Ke,{className:"text-lg leading-tight text-gray-400","data-testid":`text-available-award-name-${P.id}`,children:P.name}),P.description&&s.jsx(zn,{className:"text-gray-500 text-sm mt-2","data-testid":`text-available-award-description-${P.id}`,children:P.description})]}),s.jsx(we,{children:s.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ”’ Not yet earned"})})]},P.id))})})]})]})})}const jB=[{name:"SHOOTING",skills:["LAYUP","2PT RANGE","3PT RANGE"],averageScore:72},{name:"DRIBBLING",skills:["LEFT","RIGHT","CONTROL","SPEED"],averageScore:85},{name:"PASSING",skills:["BOUNCE","CHEST","OVERHEAD","CATCHING"],averageScore:68},{name:"DEFENSE",skills:["TALKING","STANCE","CLOSEOUT"],averageScore:74},{name:"REBOUNDING",skills:["BOX OUT","BALL PROTECTION","ANTICIPATION"],averageScore:78},{name:"ATHLETIC ABILITY",skills:["STAMINA","QUICKNESS","COORDINATION"],averageScore:82},{name:"COACHABILITY",skills:["ATTITUDE","FOCUS","WORK ETHIC","ACCEPTS CRITICISM"],averageScore:88}],pBe=(e,t)=>{var r;const n=((r=jB.find(i=>i.name===e))==null?void 0:r.averageScore)||75;return Math.min(100,Math.max(0,n+Math.floor(Math.random()*20-10)))};function gBe(){const[,e]=Wt(),[t,n]=j.useState(null);return s.jsxs("div",{className:"min-h-screen-safe bg-background safe-bottom",children:[s.jsx("div",{className:"bg-card border-b sticky top-0 z-40",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-dashboard"),"data-testid":"button-back",children:s.jsx(vn,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(uj,{className:"w-5 h-5 text-red-600"}),s.jsx("h1",{className:"text-xl font-semibold",children:"Skills Assessment"})]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:t?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>n(null),children:s.jsx(vn,{className:"w-4 h-4"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t})]}),(()=>{const r=jB.find(i=>i.name===t);return r?s.jsxs("div",{className:"space-y-4",children:[s.jsx(ye,{children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-red-600 mb-2",children:[r.averageScore,"%"]}),s.jsxs("div",{className:"text-gray-600",children:["Overall ",r.name.toLowerCase()," score"]}),s.jsx(xd,{value:r.averageScore,className:"mt-4 h-4"})]})})}),r.skills.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Individual Skills"}),r.skills.map(i=>{const a=pBe(r.name);return s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"font-medium text-gray-700",children:i}),s.jsxs("span",{className:"text-red-600 font-semibold",children:[a,"%"]})]}),s.jsx(xd,{value:a,className:"h-2"})]})},i)})]}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Coach Notes"}),s.jsx("p",{className:"text-gray-600 text-sm",children:r.averageScore>=80?`Excellent work on ${r.name.toLowerCase()}! Keep practicing to maintain this high level.`:`Good progress on ${r.name.toLowerCase()}. Focus on the specific skills below to improve your overall score.`})]})})]}):null})()]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Skills Progress"}),s.jsx("p",{className:"text-gray-600",children:"Track your development across all basketball fundamentals"})]}),jB.map(r=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-shadow",children:s.jsxs(we,{className:"p-4",onClick:()=>n(r.name),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:r.name}),s.jsxs("span",{className:"text-red-600 font-bold text-lg",children:[r.averageScore,"%"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(xd,{value:r.averageScore,className:"h-3"}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsxs("span",{children:[r.skills.length," skills assessed"]}),s.jsx("span",{children:r.averageScore>=90?"Excellent":r.averageScore>=80?"Very Good":r.averageScore>=70?"Good":r.averageScore>=60?"Developing":"Needs Work"})]})]})]})},r.name))]})})]})}function xBe(){return s.jsxs("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom p-8",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Test Route Works!"}),s.jsx("p",{children:"If you can see this, routing is working correctly."})]})}function yBe(){return s.jsx("div",{className:"min-h-screen-safe w-full flex items-center justify-center bg-gray-50 safe-bottom",children:s.jsx(ye,{className:"w-full max-w-md mx-4",children:s.jsxs(we,{className:"pt-6",children:[s.jsxs("div",{className:"flex mb-4 gap-2",children:[s.jsx(jd,{className:"h-8 w-8 text-red-500"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),s.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const vBe="#d82428",wBe=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required"),phoneNumber:q.string().optional(),dateOfBirth:q.string().min(1,"Date of birth is required"),jerseyNumber:q.string().min(1,"Jersey number is required"),height:q.string().min(1,"Height is required"),city:q.string().min(1,"City is required"),position:q.string().min(1,"Position is required")});function bBe(){const{user:e}=dn(),[,t]=Wt();Pee();const n=os(),{toast:r}=Tt();j.useState(!1),j.useState((e==null?void 0:e.email)||""),j.useState(null);const[i,a]=j.useState(!1),o=Dr({resolver:Qr(wBe),defaultValues:{firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phoneNumber:"",dateOfBirth:"",jerseyNumber:"",height:"",city:"",position:""}}),l=ot({mutationFn:async d=>{const u=d.jerseyNumber&&d.jerseyNumber.trim()!==""?parseInt(d.jerseyNumber,10):void 0;if(d.dateOfBirth){const m=new Date(d.dateOfBirth),y=new Date;let x=y.getFullYear()-m.getFullYear();const b=y.getMonth()-m.getMonth();(b<0||b===0&&y.getDate()<m.getDate())&&x--,x.toString()}const h=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({organizationId:(e==null?void 0:e.organizationId)||"default-org",email:(e==null?void 0:e.email)||"",role:"player",firstName:d.firstName,lastName:d.lastName,phoneNumber:d.phoneNumber,dateOfBirth:d.dateOfBirth,jerseyNumber:u,position:d.position,program:void 0,isActive:!0,verified:i})});if(!h.ok){const m=await h.json();throw new Error(m.message||"Failed to create profile")}return await h.json()},onSuccess:d=>{n.invalidateQueries({queryKey:["/api/users"]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),r({title:"Profile Created!",description:"Your profile has been successfully created."}),d.role==="player"?t("/player-dashboard"):d.role==="coach"?t("/coach-dashboard"):d.role==="admin"?t("/admin"):t("/player-dashboard")},onError:d=>{r({title:"Error",description:d.message||"Failed to create profile",variant:"destructive"})}}),c=d=>{l.mutate(d)};return s.jsx("div",{className:"min-h-screen-safe text-white safe-bottom p-4",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(216,36,40,0.15), transparent 60%), #000"},children:s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>t("/select-profile-type"),className:"p-2 rounded-md border border-white/15 hover:bg-white/5 transition","data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Create Player Profile"}),s.jsx("p",{className:"text-sm text-white/70",children:"Complete your profile information"})]})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-white",children:"Profile Information"})}),s.jsx(we,{children:s.jsx(Mr,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(c),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"firstName",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"First Name"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter first name",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-first-name"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"lastName",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Last Name"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter last name",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-last-name"})}),s.jsx(ft,{})]})})]}),s.jsx(it,{control:o.control,name:"phoneNumber",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Phone Number (Optional)"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter phone number",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-phone"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"dateOfBirth",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Date of Birth"}),s.jsx(ut,{children:s.jsx(qe,{...d,type:"date",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-dob"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"jerseyNumber",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Jersey Number"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-jersey",children:s.jsx(Mt,{placeholder:"Select number"})})}),s.jsx(Dt,{className:"max-h-[200px]",children:Array.from({length:99},(u,h)=>h+1).map(u=>s.jsx(xe,{value:u.toString(),children:u},u))})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"position",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Position"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-position",children:s.jsx(Mt,{placeholder:"Select position"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"PG",children:"PG - Point Guard"}),s.jsx(xe,{value:"SG",children:"SG - Shooting Guard"}),s.jsx(xe,{value:"SF",children:"SF - Small Forward"}),s.jsx(xe,{value:"PF",children:"PF - Power Forward"}),s.jsx(xe,{value:"C",children:"C - Center"})]})]}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"height",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Height"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-height",children:s.jsx(Mt,{placeholder:"Select height"})})}),s.jsx(Dt,{className:"max-h-[200px]",children:(()=>{const u=[];for(let h=3;h<=7;h++)for(let f=0;f<12;f++)u.push(`${h}'${f}"`);return u.map(h=>s.jsx(xe,{value:h,children:h},h))})()})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"city",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"City"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"City",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-city"})}),s.jsx(ft,{})]})})]}),s.jsx(te,{type:"submit",disabled:l.isPending,className:"w-full",style:{backgroundColor:vBe},"data-testid":"button-create-profile",children:l.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Profile..."]}):"Create Profile"})]})})})]})]})})}function jBe(){dn();const[,e]=Wt(),[t,n]=j.useState(!1),r=()=>{e("/create-profile?type=player")},i=a=>{n(!1),e(a==="admin"?"/admin":"/coach-dashboard")};return s.jsxs("div",{className:"min-h-screen-safe text-white safe-bottom flex items-center justify-center p-4",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(59,130,246,0.15), transparent 60%), #000"},children:[s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:s.jsx(Fi,{className:"w-10 h-10 text-white"})}),s.jsx("h1",{className:"text-3xl font-bold mb-3",children:"Welcome"}),s.jsx("p",{className:"text-white/70",children:"Create your player profile to get started"})]}),s.jsx(ye,{onClick:r,className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-player-type",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-lg bg-white/10 grid place-items-center text-white",children:s.jsx(Us,{className:"h-7 w-7"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg mb-1",children:"Player Profile"}),s.jsx("p",{className:"text-sm text-white/70",children:"Access your team information, training programs, and track your progress"})]})]})})}),s.jsxs("div",{className:"mt-8 text-center text-sm text-white/50",children:[s.jsx("p",{children:"Your profile will be automatically synced with our system if you're using a registered email."}),s.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-white/60 hover:text-white/90 underline transition-colors","data-testid":"button-staff-login",children:"Staff login (Admin/Coach)"})]})]}),s.jsx($n,{open:t,onOpenChange:n,children:s.jsxs(Qn,{className:"bg-gray-900 border-gray-800 text-white",children:[s.jsx(es,{children:s.jsx(qn,{className:"text-2xl",children:"Select Your Role"})}),s.jsxs("div",{className:"space-y-3 mt-4",children:[s.jsx(ye,{onClick:()=>i("admin"),className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-admin-role",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-600 grid place-items-center text-white",children:s.jsx(Fi,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:"Administrator"}),s.jsx("p",{className:"text-sm text-white/60",children:"Full access to all features and settings"})]})]})})}),s.jsx(ye,{onClick:()=>i("coach"),className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-coach-role",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-600 grid place-items-center text-white",children:s.jsx(Une,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:"Coach"}),s.jsx("p",{className:"text-sm text-white/60",children:"Manage teams, events, and player progress"})]})]})})})]})]})})]})}function NBe(){const{data:e,isLoading:t}=Ge({queryKey:["/api/account/me"]}),{data:n=[],isLoading:r}=Ge({queryKey:["/api/profiles/me"]});if(t||r)return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center","data-testid":"loading-registration",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading registration status..."})]})});if(!e)return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsx(ye,{className:"w-full max-w-md",children:s.jsxs(we,{className:"p-6 text-center",children:[s.jsx(qi,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Account Not Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"We couldn't find your account information. Please contact support for assistance."})]})})});const a=u=>{switch(u){case"active":return{icon:s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),label:"Active",variant:"default",description:"Your registration is complete and active"};case"payment_required":return{icon:s.jsx(ba,{className:"w-5 h-5 text-orange-600"}),label:"Payment Required",variant:"destructive",description:"Payment is needed to complete registration"};default:return{icon:s.jsx(Ar,{className:"w-5 h-5 text-gray-600"}),label:"Pending",variant:"secondary",description:"Registration is being processed"}}},o=u=>{switch(u){case"paid":return{icon:s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),label:"Paid",variant:"default"};case"overdue":return{icon:s.jsx(qi,{className:"w-5 h-5 text-red-600"}),label:"Overdue",variant:"destructive"};default:return{icon:s.jsx(Ar,{className:"w-5 h-5 text-yellow-600"}),label:"Pending",variant:"secondary"}}},l=a(e.registrationStatus),c=o(e.paymentStatus),d=n.filter(u=>u.profileType==="player");return s.jsx("div",{className:"scrollable-page bg-gray-50 safe-bottom p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2","data-testid":"title-registration",children:"Registration Status"}),s.jsx("p",{className:"text-gray-600",children:"View your registration and payment status for BoxStat"})]}),e.registrationStatus==="payment_required"&&s.jsxs(_c,{className:"border-orange-200 bg-orange-50","data-testid":"alert-payment-required",children:[s.jsx(qi,{className:"h-4 w-4 text-orange-600"}),s.jsxs(Bc,{className:"text-orange-700",children:[s.jsx("strong",{children:"Payment Required:"})," Your registration is pending payment. You should have received payment instructions via email. Please complete payment to activate your account."]})]}),e.paymentStatus==="overdue"&&s.jsxs(_c,{className:"border-red-200 bg-red-50","data-testid":"alert-payment-overdue",children:[s.jsx(qi,{className:"h-4 w-4 text-red-600"}),s.jsxs(Bc,{className:"text-red-700",children:[s.jsx("strong",{children:"Payment Overdue:"})," Your payment is overdue. Please complete payment immediately to avoid service interruption."]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs(ye,{"data-testid":"card-registration-status",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[l.icon,"Registration Status"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx(et,{variant:l.variant,"data-testid":"badge-registration-status",children:l.label})]}),s.jsx("p",{className:"text-sm text-gray-600",children:l.description}),s.jsx("div",{className:"pt-2 border-t",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Account Email:"}),s.jsx("span",{className:"font-medium","data-testid":"text-account-email",children:e.email})]})})]})]}),s.jsxs(ye,{"data-testid":"card-payment-status",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[c.icon,"Payment Status"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx(et,{variant:c.variant,"data-testid":"badge-payment-status",children:c.label})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Payments are processed through our registration system.",e.paymentStatus==="pending"&&" You will receive payment instructions via email.",e.paymentStatus==="overdue"&&" Please check your email for payment details."]}),e.paymentStatus!=="paid"&&s.jsx(_c,{className:"bg-blue-50 border-blue-200",children:s.jsxs(Bc,{className:"text-blue-700 text-sm",children:[s.jsx("strong",{children:"Need Help?"})," If you have questions about payment or haven't received instructions, please contact our support team."]})})]})]})]}),s.jsxs(ye,{"data-testid":"card-players-info",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(vs,{className:"w-5 h-5"}),"Registered Players (",d.length,")"]})}),s.jsx(we,{children:d.length>0?s.jsx("div",{className:"grid gap-4",children:d.map((u,h)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg","data-testid":`player-card-${h}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-semibold",children:[u.firstName.charAt(0),u.lastName.charAt(0)]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium","data-testid":`player-name-${h}`,children:[u.firstName," ",u.lastName]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[u.jerseyNumber&&`#${u.jerseyNumber} â€¢ `,"Player Profile"]})]})]}),s.jsx(et,{variant:"outline","data-testid":`player-status-${h}`,children:"Registered"})]},u.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(vs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No player profiles found"}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Player profiles will appear here once registration is complete"})]})})]}),e.registrationStatus==="active"&&s.jsxs(ye,{"data-testid":"card-next-steps",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-5 h-5"}),"What's Next?"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Check the schedule for upcoming practices and games"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Complete player profiles with emergency contacts"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Download the team communication app if available"})]})]})})]})]})})}function CBe(){const e=async()=>{try{const t=await fetch("/api/auth/user");if(!t.ok){console.error("Failed to get user info");return}const n=await t.json();(await fetch("/api/ghl/sync?email="+encodeURIComponent(n.email))).ok&&window.location.reload()}catch(t){console.error("Sync failed:",t)}};return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(jd,{className:"w-6 h-6 text-yellow-600"})}),s.jsx(Ke,{children:"No Profiles Found"})]}),s.jsxs(we,{className:"text-center space-y-4",children:[s.jsx("p",{className:"text-muted-foreground",children:"We couldn't find your family profiles. This usually means your data is still being processed from GoHighLevel."}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(te,{onClick:e,className:"w-full gap-2","data-testid":"button-retry-sync",children:[s.jsx(Pne,{className:"w-4 h-4"}),"Retry Sync"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"If this problem persists, please contact support."})]})]})]})})}function _Be(){const{user:e}=dn(),[,t]=Wt(),{toast:n}=Tt(),r=os(),[i,a]=j.useState(1),[o,l]=j.useState([]),[c,d]=j.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phone:(e==null?void 0:e.phoneNumber)||""}),[u,h]=j.useState([{firstName:"",lastName:""}]),[f,m]=j.useState({}),{data:y=[],isLoading:x}=Ge({queryKey:["/api/programs"],enabled:i===2}),b=y.reduce((T,$)=>{const D=$.category||"Other";return T[D]||(T[D]=[]),T[D].push($),T},{}),g=ot({mutationFn:async T=>await bt("POST","/api/onboarding/complete",T),onSuccess:T=>{var D;n({title:"Players Created!",description:"Now let's select packages for each player."});const $=((D=T.players)==null?void 0:D.map(O=>O.id))||[];l($),h(O=>O.map((V,K)=>({...V,id:$[K]}))),r.invalidateQueries({queryKey:["/api/auth/user"]}),r.invalidateQueries({queryKey:["/api/profiles"]}),a(2)},onError:T=>{n({title:"Setup Failed",description:T.message||"Failed to create player profiles. Please try again.",variant:"destructive"})}}),v=ot({mutationFn:async T=>await bt("POST","/api/family/package-selections",{selections:T}),onSuccess:()=>{n({title:"Package Selections Saved!",description:"Redirecting to payment..."}),r.invalidateQueries({queryKey:["/api/family/package-selections"]}),setTimeout(()=>t("/payments"),500)},onError:T=>{n({title:"Failed to Save Selections",description:T.message||"Please try again.",variant:"destructive"})}}),_=()=>{h(T=>[...T,{firstName:"",lastName:""}])},B=T=>{if(u.length>1){h(O=>O.filter((V,K)=>K!==T));const $={...f};delete $[T];const D={};Object.keys($).forEach(O=>{const V=parseInt(O);V>T?D[V-1]=$[V]:D[V]=$[V]}),m(D)}},I=(T,$,D)=>{h(O=>O.map((V,K)=>K===T?{...V,[$]:D}:V))},Q=(T,$)=>{d(D=>({...D,[T]:$}))},F=()=>{if(!c.firstName||!c.lastName){n({title:"Missing Information",description:"Please fill in parent's first and last name.",variant:"destructive"});return}const T=u.filter(D=>D.firstName&&D.lastName);if(T.length===0){n({title:"Missing Information",description:"Please add at least one player with first and last name.",variant:"destructive"});return}const $={parent:c,players:T};g.mutate($)},P=()=>{const T=u.filter(O=>O.firstName&&O.lastName);if(!T.every((O,V)=>f[V])){n({title:"Missing Selections",description:"Please select a package for each player.",variant:"destructive"});return}const D=T.map((O,V)=>({childUserId:O.id,programId:f[V]}));v.mutate(D)};return s.jsxs("div",{className:"min-h-screen-safe text-white safe-bottom",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(216,36,40,0.15), transparent 60%), #000"},children:[s.jsx("header",{className:"sticky top-0 z-10 bg-black/50 backdrop-blur-sm border-b border-white/10",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>i===1?t("/profile-selection"):a(1),className:"p-2 rounded-md border border-white/15 hover:bg-white/5 transition","data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(vs,{className:"h-6 w-6 text-red-500"}),s.jsx("h1",{className:"text-xl font-bold",children:"Family Setup"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsxs("div",{className:`flex items-center gap-2 ${i===1?"text-red-500":"text-white/50"}`,children:[s.jsx(Zp,{className:`h-4 w-4 ${i>1?"text-green-500":""}`}),s.jsx("span",{children:"Player Info"})]}),s.jsx(Gs,{className:"h-4 w-4 text-white/30"}),s.jsxs("div",{className:`flex items-center gap-2 ${i===2?"text-red-500":"text-white/50"}`,children:[s.jsx(Zp,{className:`h-4 w-4 ${i>2?"text-green-500":""}`}),s.jsx("span",{children:"Packages"})]})]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-6 pb-16",children:s.jsxs("div",{className:"space-y-6 pt-6",children:[i===1&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to BoxStat!"}),s.jsx("p",{className:"text-white/70 max-w-2xl mx-auto",children:"Let's set up your family profiles. You'll be able to manage all your players, register for programs, and track their progress from one account."})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-white",children:"Parent / Guardian Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"First name *"}),s.jsx(qe,{value:c.firstName,onChange:T=>Q("firstName",T.target.value),placeholder:"First name","data-testid":"input-parent-first-name",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Last name *"}),s.jsx(qe,{value:c.lastName,onChange:T=>Q("lastName",T.target.value),placeholder:"Last name","data-testid":"input-parent-last-name",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Phone number"}),s.jsx(qe,{value:c.phone,onChange:T=>Q("phone",T.target.value),placeholder:"(555) 123-4567","data-testid":"input-parent-phone",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]})]})})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsxs(Ve,{className:"flex flex-row items-center justify-between",children:[s.jsx(Ke,{className:"text-white",children:"Your Players"}),s.jsxs(te,{variant:"outline",size:"sm",onClick:_,className:"gap-2 border-white/20 text-white hover:bg-white/10","data-testid":"button-add-player",children:[s.jsx(sl,{className:"h-4 w-4"})," Add Player"]})]}),s.jsx(we,{className:"space-y-4",children:u.map((T,$)=>s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"First name *"}),s.jsx(qe,{value:T.firstName,onChange:D=>I($,"firstName",D.target.value),placeholder:"First name","data-testid":`input-player-first-name-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Last name *"}),s.jsx(qe,{value:T.lastName,onChange:D=>I($,"lastName",D.target.value),placeholder:"Last name","data-testid":`input-player-last-name-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Date of Birth"}),s.jsx(qe,{type:"date",value:T.dob??"",onChange:D=>I($,"dob",D.target.value),"data-testid":`input-player-dob-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Grade"}),s.jsx(qe,{value:T.grade??"",onChange:D=>I($,"grade",D.target.value),placeholder:"9th","data-testid":`input-player-grade-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Current Team (if any)"}),s.jsx(qe,{value:T.teamName??"",onChange:D=>I($,"teamName",D.target.value),placeholder:"Team name","data-testid":`input-player-team-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsx("div",{className:"flex items-end justify-end",children:u.length>1&&s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>B($),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","data-testid":`button-remove-player-${$}`,children:s.jsx(Lne,{className:"h-4 w-4"})})})]})]},$))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end pt-4",children:[s.jsx(te,{variant:"outline",onClick:()=>t("/profile-selection"),className:"border-white/20 text-white hover:bg-white/10","data-testid":"button-cancel",children:"Cancel"}),s.jsx(te,{onClick:F,disabled:g.isPending,className:"bg-red-600 hover:bg-red-700 text-white gap-2","data-testid":"button-next-to-packages",children:g.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 animate-spin"}),"Creating Players..."]}):s.jsxs(s.Fragment,{children:["Continue to Package Selection",s.jsx(Gs,{className:"h-4 w-4"})]})})]})]}),i===2&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Select Packages for Your Players"}),s.jsx("p",{className:"text-white/70 max-w-2xl mx-auto",children:"Choose the right program for each of your players. You'll complete payment on the next page."})]}),x?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Nc,{className:"h-8 w-8 animate-spin text-red-500","data-testid":"loader-programs"})}):s.jsx(s.Fragment,{children:u.filter(T=>T.firstName&&T.lastName).map((T,$)=>{const D=f[$],O=y.find(V=>V.id===D);return s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-white flex items-center justify-between",children:[s.jsxs("span",{children:["Package for ",T.firstName," ",T.lastName]}),O&&s.jsx("span",{className:"text-sm font-normal text-green-400","data-testid":`text-selected-program-${$}`,children:"âœ“ Selected"})]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Select Program *"}),s.jsxs(Qt,{value:f[$]||"",onValueChange:V=>m(K=>({...K,[$]:V})),children:[s.jsx(Ut,{className:"bg-white/5 border-white/20 text-white","data-testid":`select-package-${$}`,children:s.jsx(Mt,{placeholder:"Choose a program..."})}),s.jsx(Dt,{className:"bg-zinc-900 border-white/20",children:Object.entries(b).map(([V,K])=>s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-white/60 uppercase",children:V}),K.map(oe=>s.jsx(xe,{value:oe.id,className:"text-white hover:bg-white/10","data-testid":`option-program-${oe.id}`,children:s.jsxs("div",{className:"flex items-center justify-between w-full gap-4",children:[s.jsx("span",{children:oe.name}),oe.price&&s.jsxs("span",{className:"text-white/60 text-sm",children:["$",(oe.price/100).toFixed(2),oe.pricingModel==="monthly"&&"/mo"]})]})},oe.id))]},V))})]})]}),O&&s.jsx("div",{className:"rounded-lg bg-white/5 p-4 space-y-2 border border-white/10",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-white",children:O.name}),O.description&&s.jsx("p",{className:"text-sm text-white/60 mt-1",children:O.description})]}),O.price&&s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-white",children:["$",(O.price/100).toFixed(2)]}),O.pricingModel&&s.jsx("p",{className:"text-xs text-white/60",children:O.pricingModel})]})]})})]})]},$)})}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between pt-4",children:[s.jsxs(te,{variant:"outline",onClick:()=>a(1),className:"border-white/20 text-white hover:bg-white/10","data-testid":"button-back-to-players",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Player Info"]}),s.jsx(te,{onClick:P,disabled:v.isPending||x,className:"bg-red-600 hover:bg-red-700 text-white gap-2","data-testid":"button-complete-package-selection",children:v.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 animate-spin"}),"Saving Selections..."]}):s.jsxs(s.Fragment,{children:["Continue to Payment",s.jsx(Gs,{className:"h-4 w-4"})]})})]}),s.jsx("div",{className:"text-center text-sm text-white/60 pt-4",children:s.jsx("p",{children:"You'll complete payment on the next page. All selections can be modified later if needed."})})]})]})})]})}const e6=[{id:"parent-profile-001",accountId:"demo-account-001",profileType:"parent",firstName:"Sarah",lastName:"Johnson",email:"sarah.johnson@email.com",description:"Manage family profiles, payments, and communication"},{id:"player-profile-001",accountId:"demo-account-001",profileType:"player",firstName:"Emma",lastName:"Johnson",teamName:"U12 Thunder",jerseyNumber:15,position:"Point Guard",grade:"6th Grade",description:"Track progress and team communication"},{id:"player-profile-002",accountId:"demo-account-001",profileType:"player",firstName:"Jake",lastName:"Johnson",teamName:"U10 Lightning",jerseyNumber:8,position:"Forward",grade:"4th Grade",description:"Skills development and team activities"}];function BBe(){const[,e]=Wt(),[t,n]=j.useState(null),[r,i]=j.useState(!1);Ft.useEffect(()=>{const d=new URLSearchParams(window.location.search).get("demo")==="active"||window.location.pathname.includes("demo");i(d),fetch("/api/auth/demo-status").then(u=>u.json()).then(u=>{u.isDemoMode&&(console.log("Demo mode confirmed:",u),i(!0))}).catch(u=>{console.log("Not in demo mode:",u),i(!1)})},[]);const a=c=>{switch(console.log("Profile selected:",c),n(c),sessionStorage.setItem("demoProfile",JSON.stringify(c)),sessionStorage.setItem("currentProfile",JSON.stringify(c)),sessionStorage.setItem("isDemoMode","true"),console.log("Session storage set, navigating to:",c.profileType),c.profileType){case"player":console.log("Navigating to player dashboard"),e("/player-dashboard?demo=true");break;case"parent":console.log("Navigating to parent dashboard"),e("/parent-dashboard?demo=true");break;case"coach":console.log("Navigating to admin dashboard"),e("/admin-dashboard?demo=true");break;default:console.log("Navigating to home"),e("/?demo=true")}},o=c=>{switch(c){case"parent":return s.jsx(vs,{className:"h-6 w-6 text-blue-600"});case"player":return s.jsx(Us,{className:"h-6 w-6 text-green-600"});case"coach":return s.jsx(hne,{className:"h-6 w-6 text-purple-600"});default:return s.jsx(Us,{className:"h-6 w-6"})}},l=c=>{switch(c){case"parent":return"bg-blue-100 border-blue-500";case"player":return"bg-green-100 border-green-500";case"coach":return"bg-purple-100 border-purple-500";default:return"bg-gray-100 border-gray-500"}};return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white border-b",children:s.jsx("div",{className:"max-w-2xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Select Profile"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Choose which profile to use"})]}),s.jsx(te,{variant:"outline",size:"sm",onClick:()=>e("/settings"),"data-testid":"button-settings",children:s.jsx(dj,{className:"h-4 w-4"})})]})})}),s.jsxs("main",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[r&&s.jsx(ye,{className:"bg-orange-50 border-orange-200",children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"text-orange-600 text-lg",children:"ðŸŽ­"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:"Demo Mode Active"}),s.jsx("p",{className:"text-sm text-orange-800",children:"You're experiencing the unified account system demo. This shows how Sarah Johnson's account contains multiple family member profiles with profile switching capabilities."}),s.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[s.jsx(te,{size:"sm",variant:"outline",onClick:()=>window.location.href="/",className:"text-orange-800 border-orange-300 hover:bg-orange-100",children:"Exit Demo"}),s.jsx(te,{size:"sm",variant:"outline",onClick:()=>e("/test-accounts"),className:"text-orange-800 border-orange-300 hover:bg-orange-100",children:"Back to Test Accounts"})]})]})]})})}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-lg flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Account: sarah.johnson@email.com"]})}),s.jsx(we,{children:s.jsxs("p",{className:"text-sm text-gray-600",children:["You have ",e6.length," profiles in this account"]})})]}),s.jsx(ye,{className:"bg-blue-50 border-blue-200",children:s.jsxs(we,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Demo: Unified Account System"}),s.jsx("p",{className:"text-sm text-blue-800",children:"This demonstrates the new unified profile system where one account can contain multiple profiles. Sarah's account includes herself as a parent and her two children on different teams."})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Your Profiles"}),s.jsxs(te,{onClick:()=>alert("Create Profile functionality would open here"),size:"sm","data-testid":"button-create-profile",children:[s.jsx(sl,{className:"h-4 w-4 mr-2"}),"Add Profile"]})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e6.map(c=>s.jsx(ye,{className:`cursor-pointer hover:shadow-md transition-shadow border-l-4 ${l(c.profileType)}`,onClick:()=>a(c),"data-testid":`profile-card-${c.id}`,children:s.jsxs(we,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${l(c.profileType)} border`,children:o(c.profileType)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:[c.firstName," ",c.lastName]}),s.jsx("p",{className:"text-sm text-gray-600 capitalize",children:c.profileType})]})]}),s.jsx(et,{variant:c.profileType==="player"?"default":c.profileType==="parent"?"secondary":"outline",className:"capitalize",children:c.profileType})]}),c.profileType==="player"&&s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Team:"})," ",c.teamName]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Jersey:"})," #",c.jerseyNumber]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Position:"})," ",c.position]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Grade:"})," ",c.grade]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:c.description}),s.jsx(te,{className:"w-full","data-testid":`button-select-${c.id}`,onClick:()=>a(c),children:"Select Profile"})]})},c.id))})]}),s.jsx(ye,{className:"bg-green-50 border-green-200",children:s.jsxs(we,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Family Account Benefits"}),s.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[s.jsx("li",{children:"â€¢ Single login for entire family"}),s.jsx("li",{children:"â€¢ Unified payment management"}),s.jsx("li",{children:"â€¢ Cross-team communication and scheduling"}),s.jsx("li",{children:"â€¢ Centralized progress tracking"}),s.jsx("li",{children:"â€¢ Seamless profile switching"})]})]})})]})]})}const ff=sj("PushNotifications",{}),SBe=Pc.isNativePlatform()?"https://boxstat.replit.app":"";function kBe(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${SBe}${e}`}const sY=()=>Pc.isNativePlatform(),PBe=async()=>{if(!sY()){console.log("[Push Init] Not running on native platform, skipping push notification setup");return}console.log("[Push Init] ðŸ”” Initializing push notification listeners..."),console.log("[Push Init] Platform:",Pc.getPlatform()),await ff.addListener("registration",async e=>{console.log("[Push Registration] âœ… FCM token received:",e.value),console.log("[Push Registration] Token length:",e.value.length);try{const t=kBe("/api/push/register");console.log("[Push Registration] Sending token to backend:",t);const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e.value})});if(console.log("[Push Registration] Backend response status:",n.status),n.ok){const r=await n.json();console.log("[Push Registration] âœ… Token successfully registered with backend"),console.log("[Push Registration] Backend response:",r)}else{const r=await n.text();console.error("[Push Registration] âŒ Failed to register token with backend"),console.error("[Push Registration] Status:",n.status),console.error("[Push Registration] Error:",r)}}catch(t){console.error("[Push Registration] âŒ Network error registering token:",t)}}),await ff.addListener("registrationError",e=>{console.error("[Push Registration] âŒ FCM registration failed:",e),console.error("[Push Registration] Error details:",JSON.stringify(e))}),await ff.addListener("pushNotificationReceived",e=>{console.log("[Push Notification] ðŸ“¬ Received in foreground"),console.log("[Push Notification] Title:",e.title),console.log("[Push Notification] Body:",e.body),console.log("[Push Notification] Data:",e.data)}),await ff.addListener("pushNotificationActionPerformed",e=>{console.log("[Push Notification] ðŸ‘† User tapped notification"),console.log("[Push Notification] Action:",e.actionId),console.log("[Push Notification] Data:",e.notification.data)}),console.log("[Push Init] âœ… All push notification listeners initialized successfully")},EBe=async()=>{if(!sY()){console.log("[Push Register] Not on native platform, skipping push notification registration");return}console.log("[Push Register] Starting push notification registration flow...");try{let e=await ff.checkPermissions();if(console.log("[Push Register] ðŸ” Current permission status:",e.receive),e.receive==="prompt"&&(console.log("[Push Register] ðŸ” Permission not yet requested, requesting now..."),e=await ff.requestPermissions(),console.log("[Push Register] Permission request result:",e.receive)),e.receive!=="granted"){console.error("[Push Register] âŒ Push notification permissions denied by user"),console.error("[Push Register] Final permission status:",e.receive);return}console.log("[Push Register] âœ… Push notification permissions granted"),console.log("[Push Register] ðŸ“± Calling PushNotifications.register() to get FCM token..."),await ff.register(),console.log("[Push Register] ðŸ“± Registration API called successfully, waiting for FCM token callback...")}catch(e){console.error("[Push Register] âŒ Error during push notification registration:",e),console.error("[Push Register] Error type:",e instanceof Error?e.name:typeof e),console.error("[Push Register] Error message:",e instanceof Error?e.message:String(e))}},FBe=sj("App",{web:()=>rb(()=>import("./web-DuY-3dpt.js"),[]).then(e=>new e.AppWeb)});let TBe=null;async function IBe(){if(Pc.isNativePlatform())try{FBe.addListener("appUrlOpen",e=>{console.log("[DeepLink] App opened with URL:",e.url),TBe||LBe(e.url)}),console.log("[DeepLink] Deep link listener initialized")}catch(e){console.error("[DeepLink] Failed to initialize deep links:",e)}}function LBe(e){try{const t=new URL(e),n=t.pathname,r=t.searchParams;if(console.log("[DeepLink] Handling URL:",{pathname:n,params:Object.fromEntries(r)}),n==="/magic-link-login"||n.startsWith("/magic-link-login")){const i=r.get("token");i&&(console.log("[DeepLink] Magic link token detected, navigating..."),window.location.href=`/magic-link-login?token=${i}`)}else if(n==="/claim-verify"||n.startsWith("/claim-verify")){const i=r.get("token");i&&(console.log("[DeepLink] Claim verify token detected, navigating..."),window.location.href=`/claim-verify?token=${i}`)}else console.log("[DeepLink] Unknown path, navigating to:",n),window.location.href=n+t.search}catch(t){console.error("[DeepLink] Error handling deep link:",t)}}function UBe(){var v,_;const{user:e}=dn(),[t,n]=Wt(),[r,i]=j.useState(null),[a,o]=j.useState(null),[l,c]=j.useState(!1),d=j.useRef(null),u=j.useRef(null),{toast:h}=Tt(),f=os(),m=ot({mutationFn:async B=>{const I=new FormData;I.append("photo",B);const Q=await fetch("/api/upload-profile-photo",{method:"POST",body:I});if(!Q.ok)throw new Error("Upload failed");return Q.json()},onSuccess:()=>{h({title:"Success",description:"Profile photo updated successfully!"}),f.invalidateQueries({queryKey:["/api/auth/user"]}),n("/player-dashboard")},onError:()=>{h({title:"Error",description:"Failed to upload photo. Please try again."})}}),y=B=>{var Q;const I=(Q=B.target.files)==null?void 0:Q[0];if(I){if(I.size>5*1024*1024){h({title:"Error",description:"File size must be less than 5MB"});return}if(!I.type.startsWith("image/")){h({title:"Error",description:"Please select an image file"});return}i(I);const F=URL.createObjectURL(I);o(F)}},x=()=>{r&&(c(!0),m.mutate(r))},b=()=>{i(null),a&&(URL.revokeObjectURL(a),o(null))},g=e?`${((v=e.firstName)==null?void 0:v[0])||""}${((_=e.lastName)==null?void 0:_[0])||""}`.toUpperCase():"";return s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-gray-900 to-gray-800 safe-bottom p-4",children:s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>n("/player-dashboard"),className:"text-white hover:bg-white/10",children:s.jsx(vn,{className:"h-6 w-6"})}),s.jsx("h1",{className:"text-xl font-semibold text-white",children:"Update Profile Photo"}),s.jsx("div",{className:"w-10"})]}),s.jsxs(ye,{className:"bg-white/10 border-white/20 backdrop-blur-sm",children:[s.jsx(Ve,{className:"text-center",children:s.jsx(Ke,{className:"text-white",children:"Choose New Photo"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsxs(wr,{className:"h-32 w-32",children:[s.jsx(Ur,{src:a||(e==null?void 0:e.profileImageUrl),alt:"Profile"}),s.jsx(br,{className:"text-2xl font-bold bg-gray-300",children:g})]}),a&&s.jsx(te,{variant:"outline",size:"icon",className:"absolute -top-2 -right-2 h-8 w-8 rounded-full bg-red-500 border-red-500 text-white hover:bg-red-600",onClick:b,children:s.jsx(Mf,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(te,{variant:"outline",className:"w-full h-14 bg-white/10 border-white/20 text-white hover:bg-white/20",onClick:()=>{var B;return(B=u.current)==null?void 0:B.click()},children:[s.jsx(oj,{className:"h-6 w-6 mr-3"}),"Take Selfie"]}),s.jsxs(te,{variant:"outline",className:"w-full h-14 bg-white/10 border-white/20 text-white hover:bg-white/20",onClick:()=>{var B;return(B=d.current)==null?void 0:B.click()},children:[s.jsx(hj,{className:"h-6 w-6 mr-3"}),"Upload from Gallery"]}),r&&s.jsx(te,{className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white",onClick:x,disabled:l,children:l?"Uploading...":"Save New Photo"})]}),r&&s.jsxs("div",{className:"text-center text-white/70 text-sm",children:["Selected: ",r.name,s.jsx("br",{}),"Size: ",(r.size/1024/1024).toFixed(2)," MB"]})]})]}),s.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:y,className:"hidden"}),s.jsx("input",{ref:u,type:"file",accept:"image/*",capture:"user",onChange:y,className:"hidden"})]})})}function DBe(){return s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-b from-orange-50 to-white safe-bottom",children:[s.jsx("div",{className:"bg-[#FF6B35] text-white py-12",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4","data-testid":"text-support-title",children:"Support Center"}),s.jsx("p",{className:"text-lg opacity-90","data-testid":"text-support-subtitle",children:"We're here to help! Get in touch with our team for any questions or assistance."})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[s.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-12",children:[s.jsxs(ye,{"data-testid":"card-email-support",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:s.jsx($i,{className:"h-6 w-6 text-[#FF6B35]"})}),s.jsxs("div",{children:[s.jsx(Ke,{children:"Email Support"}),s.jsx(zn,{children:"We typically respond within 24 hours"})]})]})}),s.jsx(we,{children:s.jsx("a",{href:"mailto:support@boxstat.app",className:"text-[#FF6B35] hover:underline font-medium","data-testid":"link-email-support",children:"support@boxstat.app"})})]}),s.jsxs(ye,{"data-testid":"card-general-contact",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:s.jsx(xa,{className:"h-6 w-6 text-[#FF6B35]"})}),s.jsxs("div",{children:[s.jsx(Ke,{children:"General Inquiries"}),s.jsx(zn,{children:"For general questions and feedback"})]})]})}),s.jsx(we,{children:s.jsx("a",{href:"mailto:info@boxstat.app",className:"text-[#FF6B35] hover:underline font-medium","data-testid":"link-general-contact",children:"info@boxstat.app"})})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"mb-12",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6","data-testid":"text-help-resources-title",children:"Help Resources"}),s.jsxs("div",{className:"grid gap-4",children:[s.jsxs(ye,{"data-testid":"card-getting-started",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(pne,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Getting Started"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"New to BoxStat? Learn how to set up your account, manage teams, and track player development."})})]}),s.jsxs(ye,{"data-testid":"card-event-checkins",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(wo,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Event Check-ins"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"Learn how to check in to events, track attendance, and manage your team's schedule."})})]}),s.jsxs(ye,{"data-testid":"card-player-development",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(wo,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Player Development"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"Track player progress, view skill assessments, and earn badges and trophies."})})]})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"mb-12",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6","data-testid":"text-faq-title",children:"Frequently Asked Questions"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{"data-testid":"faq-account",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I create an account?"}),s.jsx("p",{className:"text-gray-600",children:`Download the BoxStat app and click "Register" to create a new account. You'll need to verify your email address before you can access all features.`})]}),s.jsxs("div",{"data-testid":"faq-checkin",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How does event check-in work?"}),s.jsx("p",{className:"text-gray-600",children:`Event check-in uses geo-fencing technology. You must be within 200 meters of the event location and within the event's time window to check in. Simply tap the "Check In" button on the event card.`})]}),s.jsxs("div",{"data-testid":"faq-teams",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I join a team?"}),s.jsx("p",{className:"text-gray-600",children:"Your coach will add you to a team roster. Once added, the team will appear in your dashboard and you'll receive notifications about team events and activities."})]}),s.jsxs("div",{"data-testid":"faq-privacy",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Is my data secure?"}),s.jsx("p",{className:"text-gray-600",children:"Yes! We take privacy seriously. Your personal information is encrypted and stored securely. You can control your privacy settings in the app's Settings menu."})]}),s.jsxs("div",{"data-testid":"faq-payments",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I make payments?"}),s.jsx("p",{className:"text-gray-600",children:"Payments for fees, uniforms, and tournaments can be made securely through the app using Stripe. Navigate to the Payments section in your dashboard to view and pay any outstanding balances."})]})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-8 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4","data-testid":"text-contact-cta",children:"Still need help?"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Our support team is ready to assist you with any questions or issues."}),s.jsx(te,{asChild:!0,className:"bg-[#FF6B35] hover:bg-[#E55A2B]","data-testid":"button-contact-support",children:s.jsxs("a",{href:"mailto:support@boxstat.app",children:[s.jsx($i,{className:"mr-2 h-4 w-4"}),"Contact Support"]})})]}),s.jsxs("div",{className:"mt-12 text-center text-sm text-gray-500",children:[s.jsx("p",{"data-testid":"text-support-hours",children:"Support Hours: Monday - Friday, 9:00 AM - 6:00 PM EST"}),s.jsx("p",{className:"mt-2","data-testid":"text-support-footer",children:"BoxStat - Empowering Youth Basketball Programs"})]})]})]})}function t6(e){switch(e){case"badge_earned":return s.jsx(Jp,{className:"h-5 w-5 text-yellow-500"});case"trophy_progress":return s.jsx(Ai,{className:"h-5 w-5 text-amber-500"});case"event_rsvp_available":case"event_checkin_available":case"event_reminder":return s.jsx(dr,{className:"h-5 w-5 text-blue-500"});case"training_reminder":return s.jsx(g8,{className:"h-5 w-5 text-green-500"});case"skills_evaluation":return s.jsx(Aj,{className:"h-5 w-5 text-purple-500"});case"improvement_recommendation":return s.jsx(uj,{className:"h-5 w-5 text-indigo-500"});case"payment_due":return s.jsx(ba,{className:"h-5 w-5 text-red-500"});case"team_message":return s.jsx(kS,{className:"h-5 w-5 text-cyan-500"});default:return s.jsx(Pi,{className:"h-5 w-5 text-gray-500"})}}function n6(e){switch(e){case"high":return"border-l-red-500 bg-red-50/50 dark:bg-red-950/20";case"normal":return"border-l-blue-500 bg-blue-50/50 dark:bg-blue-950/20";case"low":return"border-l-gray-400 bg-gray-50/50 dark:bg-gray-950/20";default:return"border-l-gray-400"}}function QBe(){Wt();const[e,t]=j.useState("all"),[n,r]=j.useState(null),[i,a]=j.useState(!1),{toast:o}=Tt(),l=os(),{data:c=[],isLoading:d}=Ge({queryKey:["/api/notifications",{hideReadAfterHours:24}],queryFn:()=>bt("/api/notifications?hideReadAfterHours=24"),enabled:e==="all"}),{data:u=[],isLoading:h}=Ge({queryKey:["/api/notifications",{unreadOnly:!0}],queryFn:()=>bt("/api/notifications?unreadOnly=true"),enabled:e==="unread"}),f=e==="all"?c:u,m=e==="all"?d:h,y=ot({mutationFn:_=>bt(`/api/notifications/${_}/read`,{method:"POST"}),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/notifications"]}),l.invalidateQueries({queryKey:["/api/notifications/unread-count"]})},onError:()=>{o({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}),x=ot({mutationFn:()=>bt("/api/notifications/read-all",{method:"POST"}),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/notifications"]}),l.invalidateQueries({queryKey:["/api/notifications/unread-count"]}),o({title:"Success",description:"All notifications marked as read"})},onError:()=>{o({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}}),b=_=>{r(_),a(!0),_.isRead||y.mutate(_.id)},g=()=>{x.mutate()},v=u.length;return s.jsxs("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b sticky top-0 z-10",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),"data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Notifications"}),v>0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[v," unread notification",v!==1?"s":""]})]})]}),v>0&&s.jsxs(te,{variant:"outline",size:"sm",onClick:g,disabled:x.isPending,"data-testid":"button-mark-all-read-page",children:[s.jsx(Ra,{className:"h-4 w-4 mr-2"}),"Mark all read"]})]})})}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsxs(My,{value:e,onValueChange:_=>t(_),children:[s.jsxs(Fg,{className:"grid w-full max-w-md grid-cols-2 mb-6","data-testid":"tabs-notifications",children:[s.jsxs(Wr,{value:"all","data-testid":"tab-all",children:["All",c.length>0&&s.jsx(et,{variant:"secondary",className:"ml-2",children:c.length})]}),s.jsxs(Wr,{value:"unread","data-testid":"tab-unread",children:["Unread",v>0&&s.jsx(et,{variant:"destructive",className:"ml-2",children:v})]})]}),s.jsx(Gr,{value:"all",className:"mt-0",children:m?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Loading notifications..."})]})}):f.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx(Pi,{className:"h-16 w-16 text-muted-foreground/30 mx-auto mb-4"}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You don't have any notifications at the moment."})]})}):s.jsx("div",{className:"space-y-2",children:f.map(_=>{var B;return s.jsxs(ye,{className:`cursor-pointer hover:shadow-md transition-all border-l-4 ${n6(_.priority)} ${_.isRead?"":"bg-accent/30"}`,onClick:()=>b(_),"data-testid":`notification-card-${_.id}`,children:[s.jsx(Ve,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:t6(((B=_.types)==null?void 0:B[0])||"notification")}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx(Ke,{className:`text-base leading-tight ${_.isRead?"":"font-bold"}`,children:_.title}),!_.isRead&&s.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full flex-shrink-0 mt-1"})]}),s.jsx(zn,{className:"mt-2 line-clamp-2",children:_.message})]})]})}),s.jsx(we,{className:"pt-0 pb-3",children:s.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground pl-8",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"h-3 w-3"}),L0(new Date(_.createdAt),{addSuffix:!0})]}),_.priority==="high"&&s.jsx(et,{variant:"destructive",className:"text-xs px-1.5 py-0",children:"Urgent"}),_.isRead&&s.jsx(et,{variant:"outline",className:"text-xs px-1.5 py-0",children:"Read"})]})})]},_.id)})})}),s.jsx(Gr,{value:"unread",className:"mt-0",children:m?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Loading notifications..."})]})}):f.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx(Ra,{className:"h-16 w-16 text-green-500/30 mx-auto mb-4"}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"All caught up!"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You've read all your notifications."})]})}):s.jsx("div",{className:"space-y-2",children:f.map(_=>{var B;return s.jsxs(ye,{className:`cursor-pointer hover:shadow-md transition-all border-l-4 ${n6(_.priority)} bg-accent/30`,onClick:()=>b(_),"data-testid":`notification-card-${_.id}`,children:[s.jsx(Ve,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:t6(((B=_.types)==null?void 0:B[0])||"notification")}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx(Ke,{className:"text-base leading-tight font-bold",children:_.title}),s.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full flex-shrink-0 mt-1"})]}),s.jsx(zn,{className:"mt-2 line-clamp-2",children:_.message})]})]})}),s.jsx(we,{className:"pt-0 pb-3",children:s.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground pl-8",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"h-3 w-3"}),L0(new Date(_.createdAt),{addSuffix:!0})]}),_.priority==="high"&&s.jsx(et,{variant:"destructive",className:"text-xs px-1.5 py-0",children:"Urgent"})]})})]},_.id)})})})]})}),s.jsx(PK,{notification:n,open:i,onOpenChange:a,onMarkAsRead:_=>y.mutate(_)})]})}function MBe(){return j.useEffect(()=>{fetch("/api/auth/logout",{method:"POST"}).then(()=>{hn.clear(),window.location.href="/"}).catch(()=>{window.location.href="/"})},[]),s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Logging out..."})]})})}const RBe=[{value:"PG",label:"PG - Point Guard"},{value:"SG",label:"SG - Shooting Guard"},{value:"SF",label:"SF - Small Forward"},{value:"PF",label:"PF - Power Forward"},{value:"C",label:"C - Center"}],OBe=[`4'4"`,`4'5"`,`4'6"`,`4'7"`,`4'8"`,`4'9"`,`4'10"`,`4'11"`,`5'0"`,`5'1"`,`5'2"`,`5'3"`,`5'4"`,`5'5"`,`5'6"`,`5'7"`,`5'8"`,`5'9"`,`5'10"`,`5'11"`,`6'0"`,`6'1"`,`6'2"`,`6'3"`,`6'4"`,`6'5"`,`6'6"`,`6'7"`,`6'8"`,`6'9"`,`6'10"`],HBe=["9","10","11","12","13","14","15","16","17","18"],VBe=Array.from({length:99},(e,t)=>(t+1).toString());function KBe(){var v,_;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),i=typeof window<"u"?localStorage.getItem("selectedPlayerId"):null,a=(e==null?void 0:e.activeProfileId)||i||(e==null?void 0:e.id),{data:o,isLoading:l}=Ge({queryKey:[`/api/profile/${a}`],enabled:!!a}),[c,d]=j.useState({firstName:"",lastName:"",position:"",jerseyNumber:"",city:"",age:"",height:"",phoneNumber:"",emergencyContact:"",emergencyPhone:"",medicalInfo:"",allergies:""});Ft.useEffect(()=>{var B;o&&d({firstName:o.firstName||"",lastName:o.lastName||"",position:o.position||"",jerseyNumber:((B=o.jerseyNumber)==null?void 0:B.toString())||"",city:(o==null?void 0:o.city)||o.address||"",age:(o==null?void 0:o.age)||"",height:(o==null?void 0:o.height)||"",phoneNumber:o.phoneNumber||"",emergencyContact:o.emergencyContact||"",emergencyPhone:o.emergencyPhone||"",medicalInfo:o.medicalInfo||"",allergies:o.allergies||""})},[o,e]);const u=j.useRef(null),[h,f]=j.useState(null),[m,y]=j.useState(null),x=ot({mutationFn:async B=>{const I=e==null?void 0:e.id,Q=new FormData;Q.append("photo",B);const F=`/api/upload-profile-photo?profileId=${a}`,P=await fetch(F,{method:"POST",credentials:"include",body:Q});if(!P.ok)throw new Error("Upload failed");return{result:await P.json(),accountId:I}},onSuccess:async({accountId:B})=>{t({title:"Success",description:"Profile photo updated successfully!"}),await n.invalidateQueries({queryKey:[`/api/profile/${a}`],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profile/${B}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/child-profiles",B],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),f(null),m&&(URL.revokeObjectURL(m),y(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),b=B=>{var Q;const I=(Q=B.target.files)==null?void 0:Q[0];if(I){if(I.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!I.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}f(I);const F=URL.createObjectURL(I);y(F),x.mutate(I)}},g=ot({mutationFn:async B=>{const I={...B,address:B.city,jerseyNumber:B.jerseyNumber?parseInt(B.jerseyNumber):null};return await bt(`/api/profile/${a}`,{method:"PATCH",data:I})},onSuccess:B=>{var Q;d({firstName:B.firstName||"",lastName:B.lastName||"",position:B.position||"",jerseyNumber:((Q=B.jerseyNumber)==null?void 0:Q.toString())||"",city:B.address||"",age:B.age||"",height:B.height||"",phoneNumber:B.phoneNumber||"",emergencyContact:B.emergencyContact||"",emergencyPhone:B.emergencyPhone||"",medicalInfo:B.medicalInfo||"",allergies:B.allergies||""});const I=e==null?void 0:e.id;n.setQueryData([`/api/profile/${a}`],B),n.invalidateQueries({queryKey:[`/api/profile/${a}`]}),n.invalidateQueries({queryKey:[`/api/profile/${I}`]}),n.invalidateQueries({queryKey:[`/api/players/${a}/profile`]}),n.invalidateQueries({queryKey:[`/api/players/${I}/profile`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/child-profiles",I]}),n.invalidateQueries({queryKey:["/api/users",I]}),n.invalidateQueries({queryKey:["/api/users"]}),t({title:"Profile Updated",description:"Your player profile has been successfully updated."})},onError:B=>{t({title:"Failed to Update Profile",description:(B==null?void 0:B.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Player Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Basketball info and personal details"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:m||(o==null?void 0:o.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((v=c.firstName)==null?void 0:v[0])||""}${((_=c.lastName)==null?void 0:_[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var B;return(B=u.current)==null?void 0:B.click()},disabled:x.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),x.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:b,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:c.firstName,onChange:B=>d(I=>({...I,firstName:B.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:c.lastName,onChange:B=>d(I=>({...I,lastName:B.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Age"}),s.jsxs(Qt,{value:c.age,onValueChange:B=>d(I=>({...I,age:B})),children:[s.jsx(Ut,{"data-testid":"select-age",children:s.jsx(Mt,{placeholder:"Select age"})}),s.jsx(Dt,{children:HBe.map(B=>s.jsx(xe,{value:B,children:B},B))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Height"}),s.jsxs(Qt,{value:c.height,onValueChange:B=>d(I=>({...I,height:B})),children:[s.jsx(Ut,{"data-testid":"select-height",children:s.jsx(Mt,{placeholder:"Select height"})}),s.jsx(Dt,{children:OBe.map(B=>s.jsx(xe,{value:B,children:B},B))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"City (From)"}),s.jsx(qe,{value:c.city,onChange:B=>d(I=>({...I,city:B.target.value})),placeholder:"Enter your city","data-testid":"input-city"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone Number"}),s.jsx(qe,{value:c.phoneNumber,onChange:B=>d(I=>({...I,phoneNumber:B.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Basketball Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Position"}),s.jsxs(Qt,{value:c.position,onValueChange:B=>d(I=>({...I,position:B})),children:[s.jsx(Ut,{"data-testid":"select-position",children:s.jsx(Mt,{placeholder:"Select position"})}),s.jsx(Dt,{children:RBe.map(B=>s.jsx(xe,{value:B.value,children:B.label},B.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Jersey Number"}),s.jsxs(Qt,{value:c.jerseyNumber,onValueChange:B=>d(I=>({...I,jerseyNumber:B})),children:[s.jsx(Ut,{"data-testid":"select-jersey",children:s.jsx(Mt,{placeholder:"Select number"})}),s.jsx(Dt,{children:VBe.map(B=>s.jsxs(xe,{value:B,children:["#",B]},B))})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Emergency Contact Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:c.emergencyContact,onChange:B=>d(I=>({...I,emergencyContact:B.target.value})),placeholder:"Enter emergency contact name","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Phone"}),s.jsx(qe,{value:c.emergencyPhone,onChange:B=>d(I=>({...I,emergencyPhone:B.target.value})),placeholder:"Enter emergency phone number","data-testid":"input-emergency-phone"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Medical Information"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Medical Information"}),s.jsx(Vs,{value:c.medicalInfo,onChange:B=>d(I=>({...I,medicalInfo:B.target.value})),placeholder:"Enter any medical information coaches should know about",rows:3,"data-testid":"textarea-medical-info"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Include any conditions, medications, or medical notes"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allergies"}),s.jsx(Vs,{value:c.allergies,onChange:B=>d(I=>({...I,allergies:B.target.value})),placeholder:"Enter any allergies",rows:2,"data-testid":"textarea-allergies"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"List any known allergies or dietary restrictions"})]})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>g.mutate(c),disabled:g.isPending||l,className:"px-8","data-testid":"button-save-profile",children:g.isPending?"Saving Changes...":l?"Loading Profile...":"Save Changes"})})]})]})})}function zBe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState(!0),{data:i}=Ge({queryKey:["/api/privacy"],select:o=>(o==null?void 0:o.searchable)??!0});Ft.useEffect(()=>{i!==void 0&&r(i)},[i]);const a=ot({mutationFn:async o=>{const l=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:o})});if(!l.ok)throw new Error("Failed to update privacy settings");return l.json()},onSuccess:()=>{e({title:"Privacy settings updated"})},onError:()=>{e({title:"Failed to update privacy settings",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Privacy Settings"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Player Profile Visibility"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Allow other players and coaches to find your profile"})]}),s.jsx(cn,{checked:n,onCheckedChange:o=>{r(o),a.mutate({searchable:o})},"data-testid":"switch-profile-visibility"})]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.jsx("p",{children:"When enabled, your profile can be discovered by other players and coaches in the system. When disabled, your profile will only be visible to your team members and coaches."})})]})]})})]})})}function $Be(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({eventRsvp:!0,eventReminders:!0,eventCheckin:!0,trophyProgress:!0,badgeEarned:!0}),{data:i}=Ge({queryKey:["/api/notifications/preferences"]});Ft.useEffect(()=>{i&&r({eventRsvp:i.eventRsvp??!0,eventReminders:i.eventReminders??!0,eventCheckin:i.eventCheckin??!0,trophyProgress:i.trophyProgress??!0,badgeEarned:i.badgeEarned??!0})},[i]);const a=ot({mutationFn:async()=>{const l=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!l.ok)throw new Error("Failed to save preferences");return l.json()},onSuccess:()=>{e({title:"Notification settings saved"})},onError:()=>{e({title:"Failed to save notification settings",variant:"destructive"})}}),o=({label:l,checked:c,onChange:d,testId:u})=>s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:l}),s.jsx(cn,{checked:c,onCheckedChange:d,"data-testid":u})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notifications"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Event Notifications"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Event RSVP reminders",checked:n.eventRsvp,onChange:l=>r(c=>({...c,eventRsvp:l})),testId:"switch-event-rsvp"}),s.jsx(o,{label:"Event reminders",checked:n.eventReminders,onChange:l=>r(c=>({...c,eventReminders:l})),testId:"switch-event-reminders"}),s.jsx(o,{label:"Check-in availability",checked:n.eventCheckin,onChange:l=>r(c=>({...c,eventCheckin:l})),testId:"switch-event-checkin"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Achievement Notifications"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Trophy progress updates",checked:n.trophyProgress,onChange:l=>r(c=>({...c,trophyProgress:l})),testId:"switch-trophy-progress"}),s.jsx(o,{label:"Badge earned notifications",checked:n.badgeEarned,onChange:l=>r(c=>({...c,badgeEarned:l})),testId:"switch-badge-earned"})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>a.mutate(),disabled:a.isPending,"data-testid":"button-save-notifications",children:a.isPending?"Saving...":"Save Notification Settings"})})]})]})})}function qBe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(u=>u.profileType==="player"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your player profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:u=>{t({title:"Failed to Delete Profile",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),l=()=>{confirm("Are you sure you want to delete this player profile? This action cannot be undone and you will lose all your trophies and achievements.")&&o.mutate()},c=async()=>{try{await fetch("/api/logout",{method:"GET",credentials:"include"}),window.location.href="/"}catch(u){console.error("Logout error:",u),window.location.href="/"}},d=({icon:u,title:h,action:f,description:m})=>s.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(u,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium",children:h}),m&&s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m})]})]}),f]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Account & Security"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Password and device management"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-600 dark:text-red-400",children:"Danger Zone"})}),s.jsxs(we,{children:[s.jsx(d,{icon:Va,title:"Delete Player Profile",description:"Permanently delete this player profile and all associated data",action:s.jsx(te,{variant:"destructive",onClick:l,disabled:o.isPending||!a,"data-testid":"button-delete-player-profile",children:o.isPending?"Deleting...":"Delete Profile"})}),s.jsx(d,{icon:Hb,title:"Log Out",description:"Sign out of your account",action:s.jsx(te,{variant:"destructive",onClick:c,"data-testid":"button-logout",children:"Log Out"})})]})]})})]})})}function WBe(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState("unknown"),[i,a]=j.useState(!1),[o,l]=j.useState(null);Ft.useEffect(()=>{const h=navigator.userAgent,f=navigator.platform,m=navigator.language,y=`${screen.width}x${screen.height}`,x=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");l({platform:f,userAgent:h,language:m,screenSize:y,isPWA:x,cookiesEnabled:navigator.cookieEnabled,onlineStatus:navigator.onLine,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(b=>{r(b.state)})},[]);const c=async()=>{if(a(!0),!navigator.geolocation){e({title:"Location Not Supported",description:"Your browser doesn't support location services.",variant:"destructive"}),a(!1);return}navigator.geolocation.getCurrentPosition(h=>{r("granted"),e({title:"Location Permission Granted",description:`Location found: ${h.coords.latitude.toFixed(4)}, ${h.coords.longitude.toFixed(4)}`}),a(!1)},h=>{r("denied");let f="Unable to get location.";h.code===h.PERMISSION_DENIED?f="Location access was denied. Enable location in your browser settings and try again.":h.code===h.POSITION_UNAVAILABLE?f="Location information is unavailable.":h.code===h.TIMEOUT&&(f="Location request timed out."),e({title:"Location Permission Denied",description:f,variant:"destructive"}),a(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},d=()=>{switch(n){case"granted":return"text-green-600 dark:text-green-400";case"denied":return"text-red-600 dark:text-red-400";case"prompt":return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-600 dark:text-gray-400"}},u=()=>{switch(n){case"granted":return"Granted";case"denied":return"Denied";case"prompt":return"Not Set";default:return"Unknown"}};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Devices & Permissions"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage location access and device information"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"h-5 w-5"}),"Location Permission"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Location Access for Check-ins"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Status: ",s.jsx("span",{className:`font-medium ${d()}`,children:u()})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Location is required to check into events and verify attendance"})]}),s.jsx(te,{onClick:c,disabled:i,variant:n==="granted"?"outline":"default","data-testid":"button-test-location",children:i?"Testing...":n==="granted"?"Retest":"Enable Location"})]}),n==="denied"&&s.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-red-800 dark:text-red-200",children:"Location Permission Required"}),s.jsx("p",{className:"text-sm text-red-600 dark:text-red-300 mt-1",children:"To check into events, you need to enable location access:"}),s.jsxs("ul",{className:"text-xs text-red-600 dark:text-red-300 mt-2 ml-4 list-disc space-y-1",children:[s.jsx("li",{children:"Click the location icon in your browser's address bar"}),s.jsx("li",{children:'Select "Allow" for location access'}),s.jsx("li",{children:"Refresh the page and test again"})]})]}),n==="granted"&&s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-green-800 dark:text-green-200",children:"Location Permission Granted"}),s.jsx("p",{className:"text-sm text-green-600 dark:text-green-300 mt-1",children:"You can now check into events using your location."})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Current Device"]})}),s.jsx(we,{className:"space-y-4",children:o&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Platform"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-platform",children:o.platform})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Language"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-language",children:o.language})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Screen Size"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-screen",children:o.screenSize})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Timezone"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-timezone",children:o.timezone})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"App Mode"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-app-mode",children:o.isPWA?"Installed App":"Browser"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cookies Enabled"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-cookies",children:o.cookiesEnabled?"Yes":"No"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Online Status"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-online",children:o.onlineStatus?"Online":"Offline"})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Troubleshooting"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Location Issues"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 ml-4 list-disc space-y-1",children:[s.jsx("li",{children:"Make sure location services are enabled on your device"}),s.jsx("li",{children:"Check your browser's location settings"}),s.jsx("li",{children:"Try refreshing the page and testing again"}),s.jsx("li",{children:"For mobile: ensure the BoxStat app has location permission"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"App Installation"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:'Install the BoxStat app for the best experience: look for the "Install" or "Add to Home Screen" option in your browser.'})]})]})})]})]})]})})}function GBe(){Tt();const[,e]=Wt(),[t,n]=j.useState({termsAccepted:!0,privacyAccepted:!0,dataProcessingAccepted:!0,lastAccepted:new Date().toLocaleDateString()}),{data:r}=Ge({queryKey:["/api/legal/status"],initialData:{}});Ft.useEffect(()=>{r&&n({termsAccepted:r.termsAccepted??!0,privacyAccepted:r.privacyAccepted??!0,dataProcessingAccepted:r.dataProcessingAccepted??!0,lastAccepted:r.lastAccepted?new Date(r.lastAccepted).toLocaleDateString():new Date().toLocaleDateString()})},[r]);const i=o=>{const l={terms:"/terms-of-service",privacy:"/privacy-policy",data:"/data-processing-agreement"};window.open(l[o],"_blank")},a=({title:o,description:l,accepted:c,onView:d,testId:u})=>s.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200",children:o}),c?s.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[s.jsx(Yp,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:"Accepted"})]}):s.jsxs("div",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[s.jsx(Fi,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:"Required"})]})]}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l})]}),s.jsxs(te,{variant:"outline",size:"sm",onClick:d,"data-testid":u,children:[s.jsx(wo,{className:"h-4 w-4 mr-2"}),"View"]})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal & Privacy"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Terms, privacy policy, and data agreements"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Agreement Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium text-green-800 dark:text-green-200",children:"All Agreements Accepted"}),s.jsxs("p",{className:"text-sm text-green-600 dark:text-green-300 mt-1",children:["Last updated: ",t.lastAccepted]})]}),s.jsx("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:s.jsx(Yp,{className:"h-5 w-5"})})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Legal Documents"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(a,{title:"Terms of Service",description:"Rules and conditions for using the BoxStat app",accepted:t.termsAccepted,onView:()=>i("terms"),testId:"button-view-terms"}),s.jsx(a,{title:"Privacy Policy",description:"How we collect, use, and protect your personal information",accepted:t.privacyAccepted,onView:()=>i("privacy"),testId:"button-view-privacy"}),s.jsx(a,{title:"Data Processing Agreement",description:"Details about how your data is processed and stored",accepted:t.dataProcessingAccepted,onView:()=>i("data"),testId:"button-view-data-processing"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(_y,{className:"h-5 w-5"}),"Your Data & Privacy"]})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Data We Collect"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Profile information (name, age, position)"}),s.jsx("li",{children:"â€¢ Basketball statistics and achievements"}),s.jsx("li",{children:"â€¢ Event attendance and check-ins"}),s.jsx("li",{children:"â€¢ Location data (only during check-ins)"}),s.jsx("li",{children:"â€¢ App usage and preferences"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"How We Use Your Data"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Track your basketball progress"}),s.jsx("li",{children:"â€¢ Verify event attendance"}),s.jsx("li",{children:"â€¢ Send relevant notifications"}),s.jsx("li",{children:"â€¢ Improve the app experience"}),s.jsx("li",{children:"â€¢ Team and coach communications"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Your Rights"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ View all your personal data"}),s.jsx("li",{children:"â€¢ Correct inaccurate information"}),s.jsx("li",{children:"â€¢ Delete your account and data"}),s.jsx("li",{children:"â€¢ Control notification preferences"}),s.jsx("li",{children:"â€¢ Opt out of data processing"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Data Retention"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Profile data: Until account deletion"}),s.jsx("li",{children:"â€¢ Basketball stats: 7 years"}),s.jsx("li",{children:"â€¢ Location data: 30 days"}),s.jsx("li",{children:"â€¢ Messages: 1 year"}),s.jsx("li",{children:"â€¢ Backup data: 90 days"})]})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($i,{className:"h-5 w-5"}),"Questions or Concerns?"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"If you have questions about our legal policies or your data privacy, please contact us:"}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:s.jsx("div",{className:"space-y-2 text-sm",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Email:"})," ",s.jsx("a",{href:"mailto:info@upyourperformance.org",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"info@upyourperformance.org"})]})})}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"For immediate concerns about data privacy or account security, please contact us as soon as possible."})]})})]})]})]})})}function ZBe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(l=>l.profileType==="player"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your player profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:l=>{t({title:"Failed to Delete Profile",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible profile actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Player Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your player profile while keeping your account and other profiles:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This player profile will be permanently removed"}),s.jsx("li",{children:"All your trophies, badges, and achievements will be lost"}),s.jsx("li",{children:"Your team statistics and progress data will be deleted"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new player profile anytime"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this player profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this player profile? This action cannot be undone and you will lose all your trophies and achievements.")&&o.mutate()},variant:"destructive",disabled:o.isPending||!a,"data-testid":"button-delete-player-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),o.isPending?"Deleting...":"Delete Player Profile"]})]})]})]})]})})}const YBe=["parent","guardian","grandparent","sibling"];function XBe(){var x,b;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[a,o]=j.useState({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",emergencyContact:"",emergencyPhone:"",occupation:"",workPhone:"",relationship:"parent"});Ft.useEffect(()=>{if(i){const g=i;o({firstName:g.firstName||"",lastName:g.lastName||"",email:(e==null?void 0:e.email)||"",phoneNumber:g.phoneNumber||"",address:g.address||"",emergencyContact:g.emergencyContact||"",emergencyPhone:g.emergencyPhone||"",occupation:g.occupation||"",workPhone:g.workPhone||"",relationship:g.relationship||"parent"})}},[i,e]);const l=j.useRef(null),[c,d]=j.useState(null),[u,h]=j.useState(null),f=ot({mutationFn:async g=>{const v=e==null?void 0:e.activeProfileId,_=e==null?void 0:e.id,B=v||_,I=new FormData;I.append("photo",g);const Q=`/api/upload-profile-photo?profileId=${B}`,F=await fetch(Q,{method:"POST",credentials:"include",body:I});if(!F.ok)throw new Error("Upload failed");return{result:await F.json(),activeProfileId:v,accountId:_}},onSuccess:async({activeProfileId:g,accountId:v})=>{t({title:"Success",description:"Profile photo updated successfully!"});try{const _=await fetch(`/api/profile/${g}`,{credentials:"include"});if(_.ok){const B=await _.json();n.setQueryData([`/api/profile/${g}`],B)}else await n.invalidateQueries({queryKey:[`/api/profile/${g}`],refetchType:"active"})}catch{await n.invalidateQueries({queryKey:[`/api/profile/${g}`],refetchType:"active"})}await n.invalidateQueries({queryKey:[`/api/players/${g}/profile`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/profiles/me"],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profiles/${v}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),d(null),u&&(URL.revokeObjectURL(u),h(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),m=g=>{var _;const v=(_=g.target.files)==null?void 0:_[0];if(v){if(v.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!v.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}d(v);const B=URL.createObjectURL(v);h(B),f.mutate(v)}},y=ot({mutationFn:async g=>await bt(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",data:g}),onSuccess:g=>{o({firstName:g.firstName||"",lastName:g.lastName||"",email:(e==null?void 0:e.email)||"",phoneNumber:g.phoneNumber||"",address:g.address||"",emergencyContact:g.emergencyContact||"",emergencyPhone:g.emergencyPhone||"",occupation:g.occupation||"",workPhone:g.workPhone||"",relationship:g.relationship||"parent"});const v=e==null?void 0:e.activeProfileId,_=e==null?void 0:e.id;n.setQueryData([`/api/profile/${v}`],g),n.invalidateQueries({queryKey:[`/api/profile/${v}`]}),n.invalidateQueries({queryKey:[`/api/players/${v}/profile`]}),n.invalidateQueries({queryKey:[`/api/players/${_}/profile`]}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${_}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/users"]}),t({title:"Profile Updated",description:"Your parent profile has been successfully updated."})},onError:g=>{t({title:"Failed to Update Profile",description:(g==null?void 0:g.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Parent Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Personal information and contact details"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:u||(e==null?void 0:e.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((x=a.firstName)==null?void 0:x[0])||""}${((b=a.lastName)==null?void 0:b[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var g;return(g=l.current)==null?void 0:g.click()},disabled:f.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),f.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:m,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:a.firstName,onChange:g=>o(v=>({...v,firstName:g.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:a.lastName,onChange:g=>o(v=>({...v,lastName:g.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx($i,{className:"h-4 w-4"}),"Email Address"]}),s.jsx(qe,{value:a.email,onChange:g=>o(v=>({...v,email:g.target.value})),placeholder:"Enter email address",type:"email","data-testid":"input-email"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(bg,{className:"h-4 w-4"}),"Phone Number"]}),s.jsx(qe,{value:a.phoneNumber,onChange:g=>o(v=>({...v,phoneNumber:g.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Work Phone"}),s.jsx(qe,{value:a.workPhone,onChange:g=>o(v=>({...v,workPhone:g.target.value})),placeholder:"Enter work phone number","data-testid":"input-work-phone"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(Yi,{className:"h-4 w-4"}),"Address"]}),s.jsx(Vs,{value:a.address,onChange:g=>o(v=>({...v,address:g.target.value})),placeholder:"Enter home address",rows:2,"data-testid":"textarea-address"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Occupation"}),s.jsx(qe,{value:a.occupation,onChange:g=>o(v=>({...v,occupation:g.target.value})),placeholder:"Enter your occupation","data-testid":"input-occupation"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Relationship to Child"}),s.jsxs(Qt,{value:a.relationship,onValueChange:g=>o(v=>({...v,relationship:g})),children:[s.jsx(Ut,{"data-testid":"select-relationship",children:s.jsx(Mt,{placeholder:"Select relationship"})}),s.jsx(Dt,{children:YBe.map(g=>s.jsx(xe,{value:g,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]})]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Emergency Contact Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:a.emergencyContact,onChange:g=>o(v=>({...v,emergencyContact:g.target.value})),placeholder:"Enter emergency contact name","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Phone"}),s.jsx(qe,{value:a.emergencyPhone,onChange:g=>o(v=>({...v,emergencyPhone:g.target.value})),placeholder:"Enter emergency phone number","data-testid":"input-emergency-phone"})]})]})})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>y.mutate(a),disabled:y.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-profile",children:y.isPending?"Saving...":"Save Changes"})})]})]})})}function JBe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/privacy"],enabled:!!(e!=null&&e.id),initialData:{}}),[a,o]=j.useState({profileVisible:!0,contactInfoVisible:!1,allowCoachMessages:!0,shareProgressReports:!0,shareAttendanceData:!0,allowPhotoSharing:!1,showOnTeamDirectory:!0});Ft.useEffect(()=>{r&&o({profileVisible:r.profileVisible??!0,contactInfoVisible:r.contactInfoVisible??!1,allowCoachMessages:r.allowCoachMessages??!0,shareProgressReports:r.shareProgressReports??!0,shareAttendanceData:r.shareAttendanceData??!0,allowPhotoSharing:r.allowPhotoSharing??!1,showOnTeamDirectory:r.showOnTeamDirectory??!0})},[r]);const l=ot({mutationFn:async c=>{const d=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:c})});if(!d.ok)throw new Error("Failed to update privacy settings");return d.json()},onSuccess:()=>{t({title:"Privacy Settings Updated",description:"Your privacy preferences have been saved."})},onError:c=>{t({title:"Failed to Update Settings",description:(c==null?void 0:c.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing preferences"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Profile Visibility"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Make profile visible to other parents"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow other parents in your children's teams to see your profile"})]}),s.jsx(cn,{checked:a.profileVisible,onCheckedChange:c=>o(d=>({...d,profileVisible:c})),"data-testid":"switch-profile-visible"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Show contact information"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow coaches and other parents to see your contact details"})]}),s.jsx(cn,{checked:a.contactInfoVisible,onCheckedChange:c=>o(d=>({...d,contactInfoVisible:c})),"data-testid":"switch-contact-visible"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Show on team directory"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Appear in the team parent directory for communication"})]}),s.jsx(cn,{checked:a.showOnTeamDirectory,onCheckedChange:c=>o(d=>({...d,showOnTeamDirectory:c})),"data-testid":"switch-team-directory"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication Preferences"})}),s.jsx(we,{className:"space-y-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Allow coach messages"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive direct messages from your children's coaches"})]}),s.jsx(cn,{checked:a.allowCoachMessages,onCheckedChange:c=>o(d=>({...d,allowCoachMessages:c})),"data-testid":"switch-coach-messages"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Data Sharing"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Share progress reports"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow sharing of children's progress reports with other family members"})]}),s.jsx(cn,{checked:a.shareProgressReports,onCheckedChange:c=>o(d=>({...d,shareProgressReports:c})),"data-testid":"switch-share-progress"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Share attendance data"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow coaches to share attendance information with other family members"})]}),s.jsx(cn,{checked:a.shareAttendanceData,onCheckedChange:c=>o(d=>({...d,shareAttendanceData:c})),"data-testid":"switch-share-attendance"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Allow photo sharing"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Permission for coaches to share photos/videos of your children"})]}),s.jsx(cn,{checked:a.allowPhotoSharing,onCheckedChange:c=>o(d=>({...d,allowPhotoSharing:c})),"data-testid":"switch-photo-sharing"})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-privacy",children:l.isPending?"Saving...":"Save Privacy Settings"})})]})]})})}function eSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/notifications/preferences"],enabled:!!(e!=null&&e.id),initialData:{}}),[a,o]=j.useState({childScheduleChanges:!0,practiceReminders:!0,gameReminders:!0,childAttendance:!0,childProgress:!0,badgeEarned:!0,trophyEarned:!0,paymentReminders:!0,paymentConfirmation:!0,coachMessages:!0,teamAnnouncements:!0,emergencyAlerts:!0,emailNotifications:!0,pushNotifications:!0,smsNotifications:!1,quietHoursStart:"22:00",quietHoursEnd:"07:00"});Ft.useEffect(()=>{r&&o({childScheduleChanges:r.childScheduleChanges??!0,practiceReminders:r.practiceReminders??!0,gameReminders:r.gameReminders??!0,childAttendance:r.childAttendance??!0,childProgress:r.childProgress??!0,badgeEarned:r.badgeEarned??!0,trophyEarned:r.trophyEarned??!0,paymentReminders:r.paymentReminders??!0,paymentConfirmation:r.paymentConfirmation??!0,coachMessages:r.coachMessages??!0,teamAnnouncements:r.teamAnnouncements??!0,emergencyAlerts:r.emergencyAlerts??!0,emailNotifications:r.emailNotifications??!0,pushNotifications:r.pushNotifications??!0,smsNotifications:r.smsNotifications??!1,quietHoursStart:r.quietHoursStart??"22:00",quietHoursEnd:r.quietHoursEnd??"07:00"})},[r]);const l=ot({mutationFn:async c=>{const d=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!d.ok)throw new Error("Failed to update notification preferences");return d.json()},onSuccess:()=>{t({title:"Notification Preferences Updated",description:"Your notification settings have been saved."})},onError:c=>{t({title:"Failed to Update Settings",description:(c==null?void 0:c.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notification Preferences"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications about your children"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"h-5 w-5"}),"Schedule & Activity Updates"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Schedule changes"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get notified when practice or game times change"})]}),s.jsx(cn,{checked:a.childScheduleChanges,onCheckedChange:c=>o(d=>({...d,childScheduleChanges:c})),"data-testid":"switch-schedule-changes"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Practice reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders 2 hours before practices"})]}),s.jsx(cn,{checked:a.practiceReminders,onCheckedChange:c=>o(d=>({...d,practiceReminders:c})),"data-testid":"switch-practice-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Game reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders 4 hours before games"})]}),s.jsx(cn,{checked:a.gameReminders,onCheckedChange:c=>o(d=>({...d,gameReminders:c})),"data-testid":"switch-game-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Attendance notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child checks in or misses practice/games"})]}),s.jsx(cn,{checked:a.childAttendance,onCheckedChange:c=>o(d=>({...d,childAttendance:c})),"data-testid":"switch-attendance"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Progress & Achievements"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Progress updates"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Weekly and monthly progress reports"})]}),s.jsx(cn,{checked:a.childProgress,onCheckedChange:c=>o(d=>({...d,childProgress:c})),"data-testid":"switch-progress"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Badge earned"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child earns new badges"})]}),s.jsx(cn,{checked:a.badgeEarned,onCheckedChange:c=>o(d=>({...d,badgeEarned:c})),"data-testid":"switch-badges"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Trophy earned"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child earns trophies"})]}),s.jsx(cn,{checked:a.trophyEarned,onCheckedChange:c=>o(d=>({...d,trophyEarned:c})),"data-testid":"switch-trophies"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment & Billing"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Payment reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders for upcoming payments"})]}),s.jsx(cn,{checked:a.paymentReminders,onCheckedChange:c=>o(d=>({...d,paymentReminders:c})),"data-testid":"switch-payment-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Payment confirmations"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Confirmation when payments are processed"})]}),s.jsx(cn,{checked:a.paymentConfirmation,onCheckedChange:c=>o(d=>({...d,paymentConfirmation:c})),"data-testid":"switch-payment-confirmation"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Coach messages"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Direct messages from coaches"})]}),s.jsx(cn,{checked:a.coachMessages,onCheckedChange:c=>o(d=>({...d,coachMessages:c})),"data-testid":"switch-coach-messages"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Team announcements"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Important team announcements and updates"})]}),s.jsx(cn,{checked:a.teamAnnouncements,onCheckedChange:c=>o(d=>({...d,teamAnnouncements:c})),"data-testid":"switch-announcements"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Emergency alerts"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Urgent safety or emergency notifications (always enabled)"})]}),s.jsx(cn,{checked:!0,disabled:!0,"data-testid":"switch-emergency"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Delivery Methods"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Email notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications via email"})]}),s.jsx(cn,{checked:a.emailNotifications,onCheckedChange:c=>o(d=>({...d,emailNotifications:c})),"data-testid":"switch-email"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Push notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications on your device"})]}),s.jsx(cn,{checked:a.pushNotifications,onCheckedChange:c=>o(d=>({...d,pushNotifications:c})),"data-testid":"switch-push"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"SMS notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications via text message"})]}),s.jsx(cn,{checked:a.smsNotifications,onCheckedChange:c=>o(d=>({...d,smsNotifications:c})),"data-testid":"switch-sms"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"h-5 w-5"}),"Quiet Hours"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Set hours when you don't want to receive non-emergency notifications"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Start Time"}),s.jsx(qe,{type:"time",value:a.quietHoursStart,onChange:c=>o(d=>({...d,quietHoursStart:c.target.value})),"data-testid":"input-quiet-start"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"End Time"}),s.jsx(qe,{type:"time",value:a.quietHoursEnd,onChange:c=>o(d=>({...d,quietHoursEnd:c.target.value})),"data-testid":"input-quiet-end"})]})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-notifications",children:l.isPending?"Saving...":"Save Notification Settings"})})]})]})})}function tSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),[r,i]=j.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,o]=j.useState(!1),[l,c]=j.useState([{id:"1",name:"iPhone 12",location:"New York, NY",lastActive:"Today"},{id:"2",name:"MacBook Pro",location:"New York, NY",lastActive:"2 hours ago"}]),d=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/password`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(f)});if(!m.ok)throw new Error("Failed to change password");return m.json()},onSuccess:()=>{i({currentPassword:"",newPassword:"",confirmPassword:""}),t({title:"Password Changed",description:"Your password has been successfully updated."})},onError:f=>{t({title:"Failed to Change Password",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),u=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/2fa`,{method:f?"POST":"DELETE",credentials:"include"});if(!m.ok)throw new Error(`Failed to ${f?"enable":"disable"} 2FA`);return m.json()},onSuccess:(f,m)=>{o(m),t({title:m?"2FA Enabled":"2FA Disabled",description:m?"Two-factor authentication has been enabled.":"Two-factor authentication has been disabled."})},onError:f=>{t({title:"Failed to Update 2FA",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),h=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/devices/${f}`,{method:"DELETE",credentials:"include"});if(!m.ok)throw new Error("Failed to remove device");return m.json()},onSuccess:(f,m)=>{c(y=>y.filter(x=>x.id!==m)),t({title:"Device Removed",description:"Device has been removed from your trusted devices."})},onError:f=>{t({title:"Failed to Remove Device",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Account & Security"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage your account security and access"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(jh,{className:"h-5 w-5"}),"Change Password"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),s.jsx(qe,{type:"password",value:r.currentPassword,onChange:f=>i(m=>({...m,currentPassword:f.target.value})),placeholder:"Enter current password","data-testid":"input-current-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),s.jsx(qe,{type:"password",value:r.newPassword,onChange:f=>i(m=>({...m,newPassword:f.target.value})),placeholder:"Enter new password","data-testid":"input-new-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),s.jsx(qe,{type:"password",value:r.confirmPassword,onChange:f=>i(m=>({...m,confirmPassword:f.target.value})),placeholder:"Confirm new password","data-testid":"input-confirm-password"})]}),s.jsx(te,{onClick:()=>d.mutate(r),disabled:d.isPending||!r.currentPassword||!r.newPassword||r.newPassword!==r.confirmPassword,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-change-password",children:d.isPending?"Changing...":"Change Password"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Two-Factor Authentication"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Enable Two-Factor Authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),s.jsx(cn,{checked:a,onCheckedChange:f=>u.mutate(f),"data-testid":"switch-2fa"})]}),a&&s.jsx("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg",children:s.jsx("div",{className:"text-green-800 dark:text-green-200 text-sm",children:"Two-factor authentication is enabled for your account. You'll need both your password and authentication code to sign in."})})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Trusted Devices"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:l.map(f=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:f.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[f.location," â€¢ Last active ",f.lastActive]})]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>h.mutate(f.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50","data-testid":`button-remove-device-${f.id}`,children:s.jsx(Va,{className:"h-4 w-4"})})]},f.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Session Management"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Sign out of all devices"}),s.jsx("div",{className:"text-sm text-gray-500",children:"This will sign you out of all devices except this one"})]}),s.jsx(te,{variant:"outline",className:"text-red-600 hover:text-red-800 border-red-300 hover:bg-red-50","data-testid":"button-signout-all",children:"Sign Out All"})]})})]})]})]})})}function nSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({googleCalendar:!1,appleCalendar:!1,stripePayments:!1,venmoPayments:!1}),i=ot({mutationFn:async({service:a,connect:o})=>{const l=await fetch(`/api/integrations/${a}`,{method:o?"POST":"DELETE",credentials:"include"});if(!l.ok)throw new Error(`Failed to ${o?"connect":"disconnect"} ${a}`);return l.json()},onSuccess:(a,o)=>{r(l=>({...l,[o.service]:o.connect})),e({title:o.connect?"Connected":"Disconnected",description:`${o.service} has been ${o.connect?"connected":"disconnected"}.`})},onError:a=>{e({title:"Connection Failed",description:(a==null?void 0:a.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Connections"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Connect external apps and services"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"h-5 w-5"}),"Calendar Sync"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:s.jsx(_y,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Google Calendar"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Export your visible BoxStat events to your personal Google Calendar"})]})]}),s.jsx(cn,{checked:n.googleCalendar,onCheckedChange:a=>i.mutate({service:"googleCalendar",connect:a}),"data-testid":"switch-google-calendar"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:s.jsx(BA,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Apple Calendar"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Sync with iPhone and Mac calendars"})]})]}),s.jsx(cn,{checked:n.appleCalendar,onCheckedChange:a=>i.mutate({service:"appleCalendar",connect:a}),"data-testid":"switch-apple-calendar"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment Methods"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center",children:s.jsx(ba,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Stripe Payments"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Credit cards and bank transfers"})]})]}),s.jsx(cn,{checked:n.stripePayments,onCheckedChange:a=>i.mutate({service:"stripePayments",connect:a}),"data-testid":"switch-stripe"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx(bg,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Venmo"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Quick mobile payments"})]})]}),s.jsx(cn,{checked:n.venmoPayments,onCheckedChange:a=>i.mutate({service:"venmoPayments",connect:a}),"data-testid":"switch-venmo"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Connected Services"})}),s.jsxs(we,{children:[s.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["You have ",Object.values(n).filter(Boolean).length," services connected"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(n).map(([a,o])=>o&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-sm text-green-700 dark:text-green-300 capitalize",children:a.replace(/([A-Z])/g," $1").trim()})]},a))}),Object.values(n).every(a=>!a)&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(V_,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("div",{className:"text-gray-500 mb-2",children:"No services connected"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Connect services to sync data and automate tasks"})]})]})]})]})]})})}function sSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState([{id:"liability-waiver",title:"Liability Waiver",description:"Release of liability for sports activities",signed:!0,signedDate:"2025-01-15",required:!0},{id:"photo-consent",title:"Photo & Video Consent",description:"Permission to use child's image in promotional materials",signed:!1,signedDate:null,required:!1},{id:"medical-emergency",title:"Medical Emergency Authorization",description:"Authorization for emergency medical treatment",signed:!0,signedDate:"2025-01-15",required:!0},{id:"code-of-conduct",title:"Parent Code of Conduct",description:"Agreement to follow team and league conduct standards",signed:!0,signedDate:"2025-01-15",required:!0}]),i=ot({mutationFn:async a=>{const o=await fetch(`/api/legal/agreements/${a}/sign`,{method:"POST",credentials:"include"});if(!o.ok)throw new Error("Failed to sign agreement");return o.json()},onSuccess:(a,o)=>{r(l=>l.map(c=>c.id===o?{...c,signed:!0,signedDate:new Date().toISOString().split("T")[0]}:c)),e({title:"Agreement Signed",description:"The legal agreement has been digitally signed."})},onError:a=>{e({title:"Failed to Sign Agreement",description:(a==null?void 0:a.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal Agreements"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage consent forms and legal agreements"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(wo,{className:"h-5 w-5"}),"Agreement Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(a=>a.signed).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Completed"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(a=>!a.signed&&a.required).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-600",children:n.filter(a=>!a.signed&&!a.required).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Optional"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Legal Documents"})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:n.map(a=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${a.signed?"bg-green-500":a.required?"bg-orange-500":"bg-gray-400"}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.title,a.required&&s.jsx("span",{className:"ml-2 text-red-500 text-sm",children:"*Required"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[a.description,a.signed&&a.signedDate&&s.jsxs("span",{className:"ml-2 text-green-600",children:["â€¢ Signed ",new Date(a.signedDate).toLocaleDateString()]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(te,{variant:"outline",size:"sm","data-testid":`button-view-${a.id}`,children:"View"}),!a.signed&&s.jsx(te,{onClick:()=>i.mutate(a.id),disabled:i.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":`button-sign-${a.id}`,children:i.isPending?"Signing...":"Sign"}),a.signed&&s.jsxs("div",{className:"flex items-center gap-1 text-green-600 text-sm font-medium",children:[s.jsx(wo,{className:"h-4 w-4"}),"Signed"]})]})]},a.id))})})]}),s.jsxs(ye,{className:"border-amber-200 bg-amber-50 dark:bg-amber-950 dark:border-amber-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Important Information"]})}),s.jsxs(we,{className:"space-y-3 text-amber-800 dark:text-amber-200 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"All required agreements must be signed before your child can participate in team activities."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"Digital signatures are legally binding and equivalent to handwritten signatures."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"You can download copies of all signed agreements at any time."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"Contact the team administrator if you have questions about any legal documents."})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Document Downloads"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Download all signed agreements"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get a PDF copy of all your signed legal documents"})]}),s.jsx(te,{variant:"outline",disabled:n.filter(a=>a.signed).length===0,"data-testid":"button-download-agreements",children:"Download PDF"})]})})]})]})]})})}function rSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/devices"],enabled:!!(e!=null&&e.id)}),[a,o]=j.useState({locationPermissions:!0,notificationPermissions:!0,cameraPermissions:!1,microphonePermissions:!1,autoLogin:!0,biometricLogin:!1,twoFactorEnabled:!1,trustedDevicesOnly:!1});Ft.useEffect(()=>{const u=r;u!=null&&u.settings&&o(h=>({...h,...u.settings}))},[r]);const l=ot({mutationFn:async u=>bt("/api/devices/settings",{method:"POST",data:u}),onSuccess:()=>{t({title:"Device Settings Updated",description:"Your device preferences have been saved."}),hn.invalidateQueries({queryKey:["/api/devices"]})},onError:u=>{t({title:"Failed to Update Settings",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),c=ot({mutationFn:async u=>bt(`/api/devices/${u}/revoke`,{method:"POST"}),onSuccess:()=>{t({title:"Device Access Revoked",description:"The device has been removed from your trusted devices."}),hn.invalidateQueries({queryKey:["/api/devices"]})},onError:u=>{t({title:"Failed to Revoke Access",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),d=(r==null?void 0:r.devices)||[{id:"current",name:"Current Device",type:"mobile",lastUsed:new Date().toISOString(),location:"Current Location",isCurrent:!0}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Device Management"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage trusted devices and app permissions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"App Permissions"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Location Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow app to access your location for check-ins and event notifications"})]}),s.jsx(cn,{checked:a.locationPermissions,onCheckedChange:u=>o(h=>({...h,locationPermissions:u})),"data-testid":"switch-location-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications about your children's activities"})]}),s.jsx(cn,{checked:a.notificationPermissions,onCheckedChange:u=>o(h=>({...h,notificationPermissions:u})),"data-testid":"switch-notification-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Camera Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow taking photos for profile pictures and event sharing"})]}),s.jsx(cn,{checked:a.cameraPermissions,onCheckedChange:u=>o(h=>({...h,cameraPermissions:u})),"data-testid":"switch-camera-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Microphone Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow recording audio for voice messages (future feature)"})]}),s.jsx(cn,{checked:a.microphonePermissions,onCheckedChange:u=>o(h=>({...h,microphonePermissions:u})),"data-testid":"switch-microphone-permissions"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(jh,{className:"h-5 w-5"}),"Security & Access"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Auto-login on trusted devices"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Stay logged in on devices you use regularly"})]}),s.jsx(cn,{checked:a.autoLogin,onCheckedChange:u=>o(h=>({...h,autoLogin:u})),"data-testid":"switch-auto-login"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Biometric authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Use fingerprint or face recognition for quick access"})]}),s.jsx(cn,{checked:a.biometricLogin,onCheckedChange:u=>o(h=>({...h,biometricLogin:u})),"data-testid":"switch-biometric-login"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Two-factor authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Require additional verification for sensitive actions"})]}),s.jsx(cn,{checked:a.twoFactorEnabled,onCheckedChange:u=>o(h=>({...h,twoFactorEnabled:u})),"data-testid":"switch-two-factor"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Trusted devices only"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Restrict access to explicitly trusted devices"})]}),s.jsx(cn,{checked:a.trustedDevicesOnly,onCheckedChange:u=>o(h=>({...h,trustedDevicesOnly:u})),"data-testid":"switch-trusted-devices-only"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Trusted Devices"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:d.map(u=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:u.type==="mobile"?s.jsx(BA,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):s.jsx(Bne,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[u.name,u.isCurrent&&s.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-full",children:"Current"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Last used: ",new Date(u.lastUsed).toLocaleDateString(),u.location&&` â€¢ ${u.location}`]})]})]}),!u.isCurrent&&s.jsx(te,{variant:"outline",size:"sm",onClick:()=>c.mutate(u.id),disabled:c.isPending,"data-testid":`button-revoke-${u.id}`,children:"Remove"})]},u.id))})})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-device-settings",children:l.isPending?"Saving...":"Save Device Settings"})})]})]})})}function iSe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),[i,a]=j.useState(!1),[o,l]=j.useState(""),{data:c=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),d=c.find(f=>f.profileType==="parent"),u=ot({mutationFn:async()=>{if(!(d!=null&&d.id))throw new Error("No profile found");return await bt(`/api/profiles/${d.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your parent profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:f=>{t({title:"Failed to Delete Profile",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),h=ot({mutationFn:async()=>{const f=await fetch(`/api/users/${e==null?void 0:e.id}`,{method:"DELETE",credentials:"include"});if(!f.ok)throw new Error("Failed to delete account");return f.json()},onSuccess:()=>{t({title:"Account Deleted",description:"Your account has been permanently deleted."}),window.location.href="/api/logout"},onError:f=>{t({title:"Failed to Delete Account",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible account actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Parent Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your parent profile while keeping your account and other profiles (like player profiles):"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This parent profile will be permanently removed"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new parent profile anytime"}),s.jsx("li",{children:"Your children's player profiles are not affected"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this parent profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this parent profile? This action cannot be undone.")&&u.mutate()},variant:"destructive",disabled:u.isPending||!d,"data-testid":"button-delete-parent-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),u.isPending?"Deleting...":"Delete Parent Profile"]})]})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Account"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Permanently delete your account and all associated data, including:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"All child profiles and their progress data"}),s.jsx("li",{children:"Payment history and billing information"}),s.jsx("li",{children:"Messages and communication history"}),s.jsx("li",{children:"Trophies, badges, and achievements"}),s.jsx("li",{children:"Photos and videos shared within the app"})]}),s.jsx("p",{className:"font-medium text-red-600 dark:text-red-400",children:"This action cannot be reversed. Your children will lose access to their accounts."})]}),i?s.jsxs("div",{className:"space-y-4 p-4 bg-red-50 dark:bg-red-950 border border-red-300 dark:border-red-700 rounded-lg",children:[s.jsx("div",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:'Type "DELETE MY ACCOUNT" to confirm account deletion:'}),s.jsx(qe,{value:o,onChange:f=>l(f.target.value),placeholder:"Type DELETE MY ACCOUNT",className:"border-red-300 focus:border-red-500","data-testid":"input-delete-confirm"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{onClick:()=>h.mutate(),disabled:o!=="DELETE MY ACCOUNT"||h.isPending,variant:"destructive","data-testid":"button-delete-account-confirm",children:h.isPending?"Deleting...":"Permanently Delete Account"}),s.jsx(te,{variant:"outline",onClick:()=>{a(!1),l("")},"data-testid":"button-cancel-delete",children:"Cancel"})]})]}):s.jsxs(te,{onClick:()=>a(!0),variant:"destructive","data-testid":"button-delete-account-initial",children:[s.jsx(qi,{className:"h-4 w-4 mr-2"}),"Delete Account"]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Export Your Data"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Download your data"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get a copy of all your account data before deletion"})]}),s.jsx(te,{variant:"outline","data-testid":"button-export-data",children:"Export Data"})]})})]})]})]})})}function aSe({title:e,description:t,backPath:n,userType:r,category:i}){const[,a]=Wt();return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>a(n),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:e}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:t})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:e})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsxs("div",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["This ",i," settings page is currently under development."]}),s.jsxs("div",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Settings for ",r," users will be available here soon."]})]})})})]})})]})})}const oSe=["0-1 years","2-3 years","4-5 years","6-10 years","10+ years"];function lSe(){var b,g;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[a,o]=j.useState({firstName:"",lastName:"",phoneNumber:"",email:"",city:"",coachingExperience:"",yearsExperience:"",bio:"",previousTeams:"",playingExperience:"",philosophy:""});Ft.useEffect(()=>{i&&o({firstName:i.firstName||"",lastName:i.lastName||"",phoneNumber:i.phoneNumber||"",email:(e==null?void 0:e.email)||"",city:i.city||i.address||"",coachingExperience:(i==null?void 0:i.coachingExperience)||"",yearsExperience:(i==null?void 0:i.yearsExperience)||"",bio:(i==null?void 0:i.bio)||"",previousTeams:(i==null?void 0:i.previousTeams)||"",playingExperience:(i==null?void 0:i.playingExperience)||"",philosophy:(i==null?void 0:i.philosophy)||""})},[i,e]);const l=j.useRef(null),[c,d]=j.useState(null),[u,h]=j.useState(null),f=ot({mutationFn:async v=>{const _=e==null?void 0:e.activeProfileId,B=e==null?void 0:e.id,I=_||B,Q=new FormData;Q.append("photo",v);const F=`/api/upload-profile-photo?profileId=${I}`,P=await fetch(F,{method:"POST",credentials:"include",body:Q});if(!P.ok)throw new Error("Upload failed");return{result:await P.json(),activeProfileId:_,accountId:B}},onSuccess:async({activeProfileId:v,accountId:_})=>{t({title:"Success",description:"Profile photo updated successfully!"});try{const B=await fetch(`/api/profile/${v}`,{credentials:"include"});if(B.ok){const I=await B.json();n.setQueryData([`/api/profile/${v}`],I)}else await n.invalidateQueries({queryKey:[`/api/profile/${v}`],refetchType:"active"})}catch{await n.invalidateQueries({queryKey:[`/api/profile/${v}`],refetchType:"active"})}await n.invalidateQueries({queryKey:[`/api/players/${v}/profile`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/profiles/me"],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profiles/${_}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),d(null),u&&(URL.revokeObjectURL(u),h(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),m=v=>{var B;const _=(B=v.target.files)==null?void 0:B[0];if(_){if(_.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!_.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}d(_);const I=URL.createObjectURL(_);h(I),f.mutate(_)}},y=ot({mutationFn:async v=>{const _={...v,address:v.city},B=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(_)});if(!B.ok)throw new Error("Failed to update coach profile");return B.json()},onSuccess:v=>{o({firstName:v.firstName||"",lastName:v.lastName||"",phoneNumber:v.phoneNumber||"",email:(e==null?void 0:e.email)||"",city:v.city||v.address||"",coachingExperience:v.coachingExperience||"",yearsExperience:v.yearsExperience||"",bio:v.bio||"",previousTeams:v.previousTeams||"",playingExperience:v.playingExperience||"",philosophy:v.philosophy||""});const _=e==null?void 0:e.activeProfileId,B=e==null?void 0:e.id;n.setQueryData([`/api/profile/${_}`],v),n.invalidateQueries({queryKey:[`/api/players/${_}/profile`]}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${B}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),t({title:"Saved",description:"Your profile changes have been saved."})},onError:v=>{t({title:"Failed to Save",description:(v==null?void 0:v.message)||"Please try again.",variant:"destructive"})}}),x=()=>{y.mutate(a)};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/unified-account"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-account",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Account"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Coach Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Personal information and coaching credentials"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:u||(e==null?void 0:e.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((b=a.firstName)==null?void 0:b[0])||""}${((g=a.lastName)==null?void 0:g[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var v;return(v=l.current)==null?void 0:v.click()},disabled:f.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),f.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:m,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:a.firstName,onChange:v=>o(_=>({..._,firstName:v.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:a.lastName,onChange:v=>o(_=>({..._,lastName:v.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx($i,{className:"h-4 w-4"}),"Email Address"]}),s.jsx(qe,{value:a.email,onChange:v=>o(_=>({..._,email:v.target.value})),placeholder:"Enter email address",type:"email","data-testid":"input-email"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(bg,{className:"h-4 w-4"}),"Phone Number"]}),s.jsx(qe,{value:a.phoneNumber,onChange:v=>o(_=>({..._,phoneNumber:v.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(Yi,{className:"h-4 w-4"}),"City"]}),s.jsx(qe,{value:a.city,onChange:v=>o(_=>({..._,city:v.target.value})),placeholder:"Enter your city","data-testid":"input-city"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($u,{className:"h-5 w-5"}),"Coaching Experience"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Years of Experience"}),s.jsxs(Qt,{value:a.yearsExperience,onValueChange:v=>o(_=>({..._,yearsExperience:v})),children:[s.jsx(Ut,{"data-testid":"select-years-experience",children:s.jsx(Mt,{placeholder:"Select experience level"})}),s.jsx(Dt,{children:oSe.map(v=>s.jsx(xe,{value:v,children:v},v))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Coaching Bio"}),s.jsx(Vs,{value:a.bio,onChange:v=>o(_=>({..._,bio:v.target.value})),placeholder:"Tell players and parents about your coaching background and approach",rows:4,"data-testid":"textarea-bio"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This will be visible to players and parents"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Previous Teams/Organizations"}),s.jsx(Vs,{value:a.previousTeams,onChange:v=>o(_=>({..._,previousTeams:v.target.value})),placeholder:"List previous teams or organizations you've coached",rows:3,"data-testid":"textarea-previous-teams"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Playing Experience"}),s.jsx(Vs,{value:a.playingExperience,onChange:v=>o(_=>({..._,playingExperience:v.target.value})),placeholder:"Describe your playing background",rows:3,"data-testid":"textarea-playing-experience"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Coaching Philosophy"}),s.jsx(Vs,{value:a.philosophy,onChange:v=>o(_=>({..._,philosophy:v.target.value})),placeholder:"Share your coaching philosophy and what's important to you",rows:4,"data-testid":"textarea-philosophy"})]})]})]}),s.jsx("div",{className:"flex justify-end pb-6",children:s.jsx(te,{onClick:x,disabled:y.isPending,className:"bg-red-600 hover:bg-red-700 text-white px-8","data-testid":"button-save-profile",children:y.isPending?"Saving...":"Save Changes"})})]})]})})}function cSe(){var c,d,u,h;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),[i,a]=j.useState({specialties:((c=e==null?void 0:e.specialties)==null?void 0:c.join(", "))||"",coachingLicense:(e==null?void 0:e.coachingLicense)||"",availability:(e==null?void 0:e.availability)||"",ageGroups:((d=e==null?void 0:e.ageGroups)==null?void 0:d.join(", "))||"",coachingStyle:(e==null?void 0:e.coachingStyle)||"",emergencyContact:(e==null?void 0:e.emergencyContact)||"",emergencyPhone:(e==null?void 0:e.emergencyPhone)||"",medicalCertifications:((u=e==null?void 0:e.medicalCertifications)==null?void 0:u.join(", "))||"",languages:((h=e==null?void 0:e.languages)==null?void 0:h.join(", "))||""}),o=ot({mutationFn:async f=>{const m={...f,specialties:f.specialties.split(",").map(x=>x.trim()).filter(Boolean),ageGroups:f.ageGroups.split(",").map(x=>x.trim()).filter(Boolean),medicalCertifications:f.medicalCertifications.split(",").map(x=>x.trim()).filter(Boolean),languages:f.languages.split(",").map(x=>x.trim()).filter(Boolean)},y=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});if(!y.ok)throw new Error("Failed to update coaching info");return y.json()},onSuccess:f=>{var m,y,x,b;a({specialties:((m=f.specialties)==null?void 0:m.join(", "))||"",coachingLicense:f.coachingLicense||"",availability:f.availability||"",ageGroups:((y=f.ageGroups)==null?void 0:y.join(", "))||"",coachingStyle:f.coachingStyle||"",emergencyContact:f.emergencyContact||"",emergencyPhone:f.emergencyPhone||"",medicalCertifications:((x=f.medicalCertifications)==null?void 0:x.join(", "))||"",languages:((b=f.languages)==null?void 0:b.join(", "))||""}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:[`/api/users/${e==null?void 0:e.id}`]}),t({title:"Saved",description:"Your changes have been saved."})},onError:f=>{t({title:"Failed to Save",description:(f==null?void 0:f.message)||"Please try again.",variant:"destructive"})}}),l=()=>{o.mutate(i)};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Coaching Information"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Coaching experience and qualifications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Availability & Emergency Contact"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Availability"}),s.jsx(Vs,{value:i.availability,onChange:f=>a(m=>({...m,availability:f.target.value})),onBlur:l,placeholder:"Describe your general availability (days, times, etc.)",rows:3,"data-testid":"textarea-availability"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:i.emergencyContact,onChange:f=>a(m=>({...m,emergencyContact:f.target.value})),onBlur:l,placeholder:"Emergency contact person","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Phone"}),s.jsx(qe,{value:i.emergencyPhone,onChange:f=>a(m=>({...m,emergencyPhone:f.target.value})),onBlur:l,placeholder:"Emergency contact phone","data-testid":"input-emergency-phone"})]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Additional Information"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Medical/Safety Certifications"}),s.jsx(qe,{value:i.medicalCertifications,onChange:f=>a(m=>({...m,medicalCertifications:f.target.value})),onBlur:l,placeholder:"First Aid, CPR, etc. (comma separated)","data-testid":"input-medical-certs"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Languages Spoken"}),s.jsx(qe,{value:i.languages,onChange:f=>a(m=>({...m,languages:f.target.value})),onBlur:l,placeholder:"Languages (comma separated)","data-testid":"input-languages"})]})]})]})]})]})})}function dSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({profileVisible:!0,contactVisible:!0,scheduleVisible:!0,allowMessages:!0,allowPhoneCalls:!1,shareWithParents:!0,shareWithOtherCoaches:!0,dataSharing:!0}),{data:i}=Ge({queryKey:["/api/privacy"],select:l=>l||{}});Ft.useEffect(()=>{i&&r({profileVisible:i.profileVisible??!0,contactVisible:i.contactVisible??!0,scheduleVisible:i.scheduleVisible??!0,allowMessages:i.allowMessages??!0,allowPhoneCalls:i.allowPhoneCalls??!1,shareWithParents:i.shareWithParents??!0,shareWithOtherCoaches:i.shareWithOtherCoaches??!0,dataSharing:i.dataSharing??!0})},[i]);const a=ot({mutationFn:async l=>{const c=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:l})});if(!c.ok)throw new Error("Failed to update privacy settings");return c.json()},onSuccess:()=>{e({title:"Privacy settings updated"})},onError:()=>{e({title:"Failed to update privacy settings",variant:"destructive"})}}),o=({label:l,description:c,checked:d,onChange:u,testId:h})=>s.jsxs("div",{className:"flex items-start justify-between py-3 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:l}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]}),s.jsx(cn,{checked:d,onCheckedChange:u,"data-testid":h,className:"ml-4"})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Profile Visibility"})}),s.jsxs(we,{children:[s.jsx(o,{label:"Coach Profile Visible",description:"Allow players, parents, and other coaches to view your profile",checked:n.profileVisible,onChange:l=>{r(c=>({...c,profileVisible:l})),a.mutate({...n,profileVisible:l})},testId:"switch-profile-visible"}),s.jsx(o,{label:"Contact Information Visible",description:"Show your contact details to team members",checked:n.contactVisible,onChange:l=>{r(c=>({...c,contactVisible:l})),a.mutate({...n,contactVisible:l})},testId:"switch-contact-visible"}),s.jsx(o,{label:"Schedule Information Visible",description:"Allow others to see your coaching schedule and availability",checked:n.scheduleVisible,onChange:l=>{r(c=>({...c,scheduleVisible:l})),a.mutate({...n,scheduleVisible:l})},testId:"switch-schedule-visible"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication Preferences"})}),s.jsx(we,{children:s.jsx(o,{label:"Allow Messages",description:"Receive messages from players and parents through the app",checked:n.allowMessages,onChange:l=>{r(c=>({...c,allowMessages:l})),a.mutate({...n,allowMessages:l})},testId:"switch-allow-messages"})})]})]})]})})}function ASe(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({teamUpdates:!0,eventChanges:!0,playerCheckIn:!0,playerRsvp:!0,teamMessages:!0,playerAwards:!0,playerProgress:!0,pushNotifications:!0,emailNotifications:!0,smsNotifications:!1}),{data:i}=Ge({queryKey:["/api/notifications/preferences"]});Ft.useEffect(()=>{i&&r({teamUpdates:i.teamUpdates??!0,eventChanges:i.eventChanges??!0,playerCheckIn:i.playerCheckIn??!0,playerRsvp:i.playerRsvp??!0,teamMessages:i.teamMessages??!0,playerAwards:i.playerAwards??!0,playerProgress:i.playerProgress??!0,pushNotifications:i.pushNotifications??!0,emailNotifications:i.emailNotifications??!0,smsNotifications:i.smsNotifications??!1})},[i]);const a=ot({mutationFn:async()=>{const l=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!l.ok)throw new Error("Failed to save preferences");return l.json()},onSuccess:()=>{e({title:"Notification settings saved"})},onError:()=>{e({title:"Failed to save notification settings",variant:"destructive"})}}),o=({label:l,description:c,checked:d,onChange:u,testId:h})=>s.jsxs("div",{className:"flex items-start justify-between py-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:l}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]}),s.jsx(cn,{checked:d,onCheckedChange:u,"data-testid":h,className:"ml-4"})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notifications"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Pi,{className:"h-5 w-5"}),"Team Notifications"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Team Updates",description:"When a player sets one of your teams as their team",checked:n.teamUpdates,onChange:l=>r(c=>({...c,teamUpdates:l})),testId:"switch-team-updates"}),s.jsx(o,{label:"Event Changes",description:"Any changes to events in the calendar that you can see",checked:n.eventChanges,onChange:l=>r(c=>({...c,eventChanges:l})),testId:"switch-event-changes"}),s.jsx(o,{label:"Player Check-In Alerts",description:"When players in your roster check in to events",checked:n.playerCheckIn,onChange:l=>r(c=>({...c,playerCheckIn:l})),testId:"switch-player-checkin"}),s.jsx(o,{label:"Player RSVP Alerts",description:"When players in your roster RSVP to events",checked:n.playerRsvp,onChange:l=>r(c=>({...c,playerRsvp:l})),testId:"switch-player-rsvp"}),s.jsx(o,{label:"Team Messages",description:"Notifications for messages in teams you're a part of",checked:n.teamMessages,onChange:l=>r(c=>({...c,teamMessages:l})),testId:"switch-team-messages"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Player Development"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Player Awards",description:"When players earn badges or trophies",checked:n.playerAwards,onChange:l=>r(c=>({...c,playerAwards:l})),testId:"switch-player-awards"}),s.jsx(o,{label:"Player Progress",description:"When players make progress toward achievements",checked:n.playerProgress,onChange:l=>r(c=>({...c,playerProgress:l})),testId:"switch-player-progress"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Delivery Methods"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Push Notifications",description:"Receive push notifications on your mobile device",checked:n.pushNotifications,onChange:l=>r(c=>({...c,pushNotifications:l})),testId:"switch-push-notifications"}),s.jsx(o,{label:"Email Notifications",description:"Receive notifications via email",checked:n.emailNotifications,onChange:l=>r(c=>({...c,emailNotifications:l})),testId:"switch-email-notifications"}),s.jsx(o,{label:"SMS Notifications",description:"Receive critical notifications via text message",checked:n.smsNotifications,onChange:l=>r(c=>({...c,smsNotifications:l})),testId:"switch-sms-notifications"})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>a.mutate(),disabled:a.isPending,className:"px-8","data-testid":"button-save-notifications",children:a.isPending?"Saving Settings...":"Save Settings"})})]})]})})}function uSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,a]=j.useState(!1),[o,l]=j.useState([{id:1,name:"iPhone 14",lastActive:"2025-09-15",current:!0},{id:2,name:"MacBook Pro",lastActive:"2025-09-14",current:!1}]),c=ot({mutationFn:async f=>{const m=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(f)});if(!m.ok)throw new Error("Failed to update password");return m.json()},onSuccess:()=>{r({currentPassword:"",newPassword:"",confirmPassword:""}),e({title:"Password updated successfully"})},onError:f=>{e({title:"Failed to update password",description:f.message,variant:"destructive"})}}),d=ot({mutationFn:async f=>{const m=await fetch("/api/auth/2fa",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({enabled:f})});if(!m.ok)throw new Error("Failed to update 2FA settings");return m.json()},onSuccess:f=>{a(f.enabled),e({title:f.enabled?"Two-factor authentication enabled":"Two-factor authentication disabled"})},onError:()=>{e({title:"Failed to update 2FA settings",variant:"destructive"})}}),u=async f=>{l(m=>m.filter(y=>y.id!==f)),e({title:"Device removed from trusted devices"})},h=n.currentPassword&&n.newPassword&&n.newPassword===n.confirmPassword&&n.newPassword.length>=8;return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Security Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Password and account security management"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Change Password"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),s.jsx(qe,{type:"password",value:n.currentPassword,onChange:f=>r(m=>({...m,currentPassword:f.target.value})),placeholder:"Enter current password","data-testid":"input-current-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),s.jsx(qe,{type:"password",value:n.newPassword,onChange:f=>r(m=>({...m,newPassword:f.target.value})),placeholder:"Enter new password","data-testid":"input-new-password"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Password must be at least 8 characters long"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),s.jsx(qe,{type:"password",value:n.confirmPassword,onChange:f=>r(m=>({...m,confirmPassword:f.target.value})),placeholder:"Confirm new password","data-testid":"input-confirm-password"})]}),s.jsx(te,{onClick:()=>c.mutate(n),disabled:!h||c.isPending,"data-testid":"button-change-password",children:c.isPending?"Updating Password...":"Update Password"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Two-Factor Authentication"})}),s.jsxs(we,{children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Two-Factor Authentication (2FA)"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Add an extra layer of security to your account"})]}),s.jsx(cn,{checked:i,onCheckedChange:f=>{a(f),d.mutate(f)},"data-testid":"switch-2fa"})]}),i&&s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[s.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Two-factor authentication is enabled. You'll need to use an authenticator app to sign in."}),s.jsx(te,{variant:"outline",size:"sm",className:"mt-2","data-testid":"button-2fa-setup",children:"View Recovery Codes"})]})]})]}),s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Trusted Devices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Devices that you've used to sign in to your account"})]}),s.jsx(we,{className:"space-y-3",children:o.map(f=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",children:[f.name,f.current&&s.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Current"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Last active: ",f.lastActive]})]})]}),!f.current&&s.jsx(te,{variant:"outline",size:"sm",onClick:()=>u(f.id),"data-testid":`button-remove-device-${f.id}`,children:"Remove"})]},f.id))})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Activity"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("span",{className:"text-sm",children:"Last login"}),s.jsx("span",{className:"text-sm text-gray-500",children:"September 15, 2025 - 11:43 PM"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("span",{className:"text-sm",children:"Password changed"}),s.jsx("span",{className:"text-sm text-gray-500",children:"September 10, 2025"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-sm",children:"Account created"}),s.jsx("span",{className:"text-sm text-gray-500",children:"August 1, 2025"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Session Management"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Log Out"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sign out of your account on this device"})]}),s.jsx(te,{variant:"outline",className:"text-red-600 hover:text-red-800 border-red-300 hover:bg-red-50",onClick:()=>window.location.href="/api/logout","data-testid":"button-logout",children:"Log Out"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Sign Out All Devices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This will sign you out of all devices except this one"})]}),s.jsx(te,{variant:"outline",className:"text-orange-600 hover:text-orange-800 border-orange-300 hover:bg-orange-50","data-testid":"button-signout-all",children:"Sign Out All"})]})]})]})]})]})})}function hSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({googleCalendar:!1,slack:!1,zoom:!1,stripeConnect:!1,syncEnabled:!0}),{data:i}=Ge({queryKey:["/api/connections"],select:l=>l||{}});Ft.useEffect(()=>{i&&r({googleCalendar:i.googleCalendar??!1,slack:i.slack??!1,zoom:i.zoom??!1,stripeConnect:i.stripeConnect??!1,syncEnabled:i.syncEnabled??!0})},[i]);const a=async(l,c)=>{try{if(!(await fetch(`/api/connections/${l}`,{method:c?"POST":"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error(`Failed to ${c?"connect":"disconnect"} ${l}`);r(u=>({...u,[l]:c})),e({title:`${l} ${c?"Connected":"Disconnected"}`,description:`Successfully ${c?"connected to":"disconnected from"} ${l}`})}catch(d){e({title:"Connection Error",description:d.message,variant:"destructive"})}},o=({title:l,description:c,icon:d,service:u,connected:h,testId:f})=>s.jsx(ye,{children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:d}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:l}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:c}),h&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"Connected"})]})]})]}),s.jsx(te,{variant:h?"outline":"default",onClick:()=>a(u,!h),"data-testid":f,children:h?"Disconnect":"Connect"})]})})});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Connections & Integrations"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Connect external apps and services"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Calendar Integrations"}),s.jsx("div",{className:"space-y-4",children:s.jsx(o,{title:"Google Calendar",description:"Export your visible BoxStat events to your personal Google Calendar",icon:s.jsx(dr,{className:"h-5 w-5"}),service:"googleCalendar",connected:n.googleCalendar,testId:"button-google-calendar"})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Communication Tools"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(o,{title:"Slack",description:"Receive team notifications and updates in your Slack workspace",icon:s.jsx(V_,{className:"h-5 w-5"}),service:"slack",connected:n.slack,testId:"button-slack"}),s.jsx(o,{title:"Zoom",description:"Schedule and manage team meetings with Zoom integration",icon:s.jsx(V_,{className:"h-5 w-5"}),service:"zoom",connected:n.zoom,testId:"button-zoom"})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Payment Processing"}),s.jsx("div",{className:"space-y-4",children:s.jsx(o,{title:"Stripe Connect",description:"Receive direct payments for private coaching and camps",icon:s.jsx(ba,{className:"h-5 w-5"}),service:"stripeConnect",connected:n.stripeConnect,testId:"button-stripe"})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Sync Settings"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Auto-sync Data"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically sync schedule and attendance data with connected services"})]}),s.jsx(cn,{checked:n.syncEnabled,onCheckedChange:l=>r(c=>({...c,syncEnabled:l})),"data-testid":"switch-auto-sync"})]})})]})]})]})})}function fSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),[r,i]=j.useState({paypalEmail:(e==null?void 0:e.paypalEmail)||"",venmoUsername:(e==null?void 0:e.venmoUsername)||"",bankAccount:(e==null?void 0:e.bankAccount)||"",routingNumber:(e==null?void 0:e.routingNumber)||"",taxId:(e==null?void 0:e.taxId)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||"",invoicePrefix:(e==null?void 0:e.invoicePrefix)||"COACH",autoInvoicing:!0});j.useState([{id:1,type:"PayPal",email:"coach@example.com",isDefault:!0},{id:2,type:"Bank Account",last4:"1234",isDefault:!1}]);const[a]=j.useState([{id:1,date:"2025-09-10",description:"Private lesson - John Smith",amount:75,status:"paid"},{id:2,date:"2025-09-08",description:"Team camp - Eagles",amount:200,status:"pending"},{id:3,date:"2025-09-05",description:"Skills training - Sarah Johnson",amount:50,status:"paid"}]),o=ot({mutationFn:async l=>{const c=await fetch(`/api/users/${e==null?void 0:e.id}/billing`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to update billing information");return c.json()},onSuccess:()=>{t({title:"Billing Information Updated",description:"Your payment and billing settings have been saved."})},onError:l=>{t({title:"Failed to Update Billing",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Billing & Payments"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage payment methods and billing settings"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PayPal Email"}),s.jsx(qe,{type:"email",value:r.paypalEmail,onChange:l=>i(c=>({...c,paypalEmail:l.target.value})),placeholder:"your@paypal.com","data-testid":"input-paypal-email"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Venmo Username"}),s.jsx(qe,{value:r.venmoUsername,onChange:l=>i(c=>({...c,venmoUsername:l.target.value})),placeholder:"@your-venmo","data-testid":"input-venmo"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Bank Account Number"}),s.jsx(qe,{value:r.bankAccount,onChange:l=>i(c=>({...c,bankAccount:l.target.value})),placeholder:"Account number","data-testid":"input-bank-account"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Routing Number"}),s.jsx(qe,{value:r.routingNumber,onChange:l=>i(c=>({...c,routingNumber:l.target.value})),placeholder:"Routing number","data-testid":"input-routing-number"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tax ID / SSN"}),s.jsx(qe,{value:r.taxId,onChange:l=>i(c=>({...c,taxId:l.target.value})),placeholder:"Tax ID or Social Security Number","data-testid":"input-tax-id"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Required for tax reporting purposes"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Coaching Rates & Invoicing"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Hourly Rate ($)"}),s.jsx(qe,{type:"number",value:r.hourlyRate,onChange:l=>i(c=>({...c,hourlyRate:l.target.value})),placeholder:"75","data-testid":"input-hourly-rate"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Invoice Prefix"}),s.jsx(qe,{value:r.invoicePrefix,onChange:l=>i(c=>({...c,invoicePrefix:l.target.value})),placeholder:"COACH","data-testid":"input-invoice-prefix"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"e.g., COACH-001, COACH-002"})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Auto-generate Invoices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically create invoices after coaching sessions"})]}),s.jsx(cn,{checked:r.autoInvoicing,onCheckedChange:l=>i(c=>({...c,autoInvoicing:l})),"data-testid":"switch-auto-invoicing"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Transactions"})}),s.jsxs(we,{children:[s.jsx("div",{className:"space-y-3",children:a.map(l=>s.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:l.description}),s.jsx("div",{className:"text-xs text-gray-500",children:l.date})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-medium",children:["$",l.amount]}),s.jsx("div",{className:`text-xs px-2 py-1 rounded ${l.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:l.status})]})]},l.id))}),s.jsx("div",{className:"mt-4 pt-4 border-t",children:s.jsx(te,{variant:"outline",className:"w-full","data-testid":"button-view-all-transactions",children:"View All Transactions"})})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>o.mutate(r),disabled:o.isPending,className:"px-8","data-testid":"button-save-billing",children:o.isPending?"Saving Changes...":"Save Changes"})})]})]})})}function mSe(){return s.jsx(aSe,{title:"Devices",description:"Trusted devices and app permissions",backPath:"/coach-settings",userType:"coach",category:"devices"})}function pSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({coachingAgreement:!1,liabilityWaiver:!1,backgroundCheck:!1,safeSportTrained:!1,privacyPolicy:!1,codeOfConduct:!1}),[i]=j.useState([{id:"coaching-agreement",title:"Coaching Service Agreement",description:"Terms and conditions for coaching services",required:!0,signed:!0,signedDate:"2025-08-01"},{id:"liability-waiver",title:"Liability Waiver",description:"Release of liability for coaching activities",required:!0,signed:!0,signedDate:"2025-08-01"},{id:"background-check",title:"Background Check Authorization",description:"Consent for background check verification",required:!0,signed:!1,signedDate:null},{id:"safe-sport",title:"SafeSport Training Certificate",description:"Completion of mandatory SafeSport education",required:!0,signed:!1,signedDate:null},{id:"code-of-conduct",title:"Coach Code of Conduct",description:"Ethical guidelines and professional behavior standards",required:!0,signed:!0,signedDate:"2025-08-01"}]),{data:a}=Ge({queryKey:["/api/legal/status"],select:c=>c||{}});Ft.useEffect(()=>{a&&r({coachingAgreement:a.coachingAgreement??!1,liabilityWaiver:a.liabilityWaiver??!1,backgroundCheck:a.backgroundCheck??!1,safeSportTrained:a.safeSportTrained??!1,privacyPolicy:a.privacyPolicy??!1,codeOfConduct:a.codeOfConduct??!1})},[a]);const o=async c=>{try{if(!(await fetch(`/api/legal/sign/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error("Failed to sign document");e({title:"Document Signed",description:"Your signature has been recorded."})}catch(d){e({title:"Signing Error",description:d.message,variant:"destructive"})}},l=(c,d)=>{e({title:"Download Started",description:`Downloading ${d}...`})};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal Documents & Agreements"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage coaching agreements and legal compliance"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Compliance Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Agreements"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"3/3"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Required agreements signed"})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Certifications"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"1/2"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Required certifications"})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Background Check"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"0/1"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Verification pending"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(wo,{className:"h-5 w-5"}),"Legal Documents"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:i.map(c=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-1 rounded-full ${c.signed?"bg-green-100 text-green-600":c.required?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:s.jsx(wo,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c.title}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:c.description}),c.signed&&c.signedDate&&s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Signed on ",c.signedDate]}),!c.signed&&c.required&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Signature required"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{variant:"outline",size:"sm",onClick:()=>l(c.id,c.title),"data-testid":`button-download-${c.id}`,children:"View"}),!c.signed&&s.jsx(te,{size:"sm",onClick:()=>o(c.id),"data-testid":`button-sign-${c.id}`,children:"Sign"})]})]},c.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Important Notices"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Background Check Required"}),s.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:"You must complete a background check authorization to continue coaching. This is required for all youth sports coaches."})]}),s.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"SafeSport Training"}),s.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:"Complete your SafeSport training to stay compliant with league requirements. Training must be renewed annually."}),s.jsx(te,{size:"sm",variant:"outline",className:"mt-2","data-testid":"button-safesport-training",children:"Start Training"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"Document Retention"}),s.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:"All signed documents are stored securely and maintained for legal compliance. You can request copies at any time."})]})]})})]})]})]})})}function gSe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(l=>l.profileType==="coach"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your coach profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:l=>{t({title:"Failed to Delete Profile",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible profile actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Coach Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your coach profile while keeping your account and other profiles:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This coach profile will be permanently removed"}),s.jsx("li",{children:"Your team rosters and player evaluations will be reassigned"}),s.jsx("li",{children:"Your coaching history and statistics will be archived"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new coach profile anytime"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this coach profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this coach profile? This action cannot be undone.")&&o.mutate()},variant:"destructive",disabled:o.isPending||!a,"data-testid":"button-delete-coach-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),o.isPending?"Deleting...":"Delete Coach Profile"]})]})]})]})]})})}function Fn({component:e}){const{user:t,isLoading:n}=dn(),[,r]=Wt();return n?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):t?s.jsx(e,{}):(r("/"),null)}const xSe=()=>s.jsx(Fn,{component:QBe}),s6=()=>s.jsx(Fn,{component:Z_e}),ySe=()=>s.jsx(Fn,{component:Y_e}),vSe=()=>s.jsx(Fn,{component:X_e}),wSe=()=>s.jsx(Fn,{component:f5e}),bSe=()=>s.jsx(Fn,{component:_fe}),r6=()=>s.jsx(Fn,{component:Vge}),jSe=()=>s.jsx(Fn,{component:v_e}),NSe=()=>s.jsx(Fn,{component:C5e}),CSe=()=>s.jsx(Fn,{component:cBe}),_Se=()=>s.jsx(Fn,{component:dBe}),BSe=()=>s.jsx(Fn,{component:ABe}),SSe=()=>s.jsx(Fn,{component:uBe}),kSe=()=>s.jsx(Fn,{component:KBe}),PSe=()=>s.jsx(Fn,{component:zBe}),ESe=()=>s.jsx(Fn,{component:$Be}),FSe=()=>s.jsx(Fn,{component:qBe}),TSe=()=>s.jsx(Fn,{component:WBe}),ISe=()=>s.jsx(Fn,{component:GBe}),LSe=()=>s.jsx(Fn,{component:ZBe}),USe=()=>s.jsx(Fn,{component:XBe}),DSe=()=>s.jsx(Fn,{component:JBe}),QSe=()=>s.jsx(Fn,{component:eSe}),MSe=()=>s.jsx(Fn,{component:tSe}),RSe=()=>s.jsx(Fn,{component:nSe}),OSe=()=>s.jsx(Fn,{component:sSe}),HSe=()=>s.jsx(Fn,{component:rSe}),VSe=()=>s.jsx(Fn,{component:iSe}),KSe=()=>s.jsx(Fn,{component:lSe}),zSe=()=>s.jsx(Fn,{component:cSe}),$Se=()=>s.jsx(Fn,{component:dSe}),qSe=()=>s.jsx(Fn,{component:ASe}),WSe=()=>s.jsx(Fn,{component:uSe}),GSe=()=>s.jsx(Fn,{component:hSe}),ZSe=()=>s.jsx(Fn,{component:fSe}),YSe=()=>s.jsx(Fn,{component:mSe}),XSe=()=>s.jsx(Fn,{component:pSe}),JSe=()=>s.jsx(Fn,{component:gSe}),e4e=()=>s.jsx(Fn,{component:P_e}),t4e=()=>s.jsx(Fn,{component:E_e}),n4e=()=>s.jsx(Fn,{component:F_e}),s4e=()=>s.jsx(Fn,{component:j5e}),r4e=()=>s.jsx(Fn,{component:N5e}),i4e=()=>s.jsx(Fn,{component:xBe}),a4e=()=>s.jsx(Fn,{component:mBe}),o4e=()=>s.jsx(Fn,{component:gBe});function l4e(){const{user:e,isLoading:t}=dn(),[,n]=Wt();return t?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e?(n("/home"),null):(n("/login"),null)}function c4e(){const[,e]=Wt();return j.useEffect(()=>{e("/home")},[e]),s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})}function d4e(){const{user:e,isLoading:t,isAuthenticated:n}=dn();return Wt(),n&&e&&(e!=null&&e.profileCompleted),j.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(i=>{console.log("SW registered: ",i)}).catch(i=>{console.log("SW registration failed: ",i)}),IBe().then(()=>{console.log("Deep link listeners initialized")});const r=i=>{console.error("Unhandled promise rejection:",i.reason),i.preventDefault()};return window.addEventListener("unhandledrejection",r),()=>{window.removeEventListener("unhandledrejection",r)}},[]),j.useEffect(()=>{n&&e&&(console.log("User authenticated, initializing push notifications..."),PBe().then(()=>{console.log("Push notification listeners set up"),EBe()}))},[n,e]),t?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):s.jsxs(Fee,{children:[s.jsx(Ct,{path:"/privacy",component:Ose}),s.jsx(Ct,{path:"/privacy-policy",component:Hse}),s.jsx(Ct,{path:"/support",component:DBe}),s.jsx(Ct,{path:"/notifications",component:xSe}),s.jsx(Ct,{path:"/teams",component:Fse}),s.jsx(Ct,{path:"/registration",component:WL}),s.jsx(Ct,{path:"/login",component:J_e}),s.jsx(Ct,{path:"/register",component:WL}),s.jsx(Ct,{path:"/verify-email",component:v5e}),s.jsx(Ct,{path:"/magic-link-login",component:w5e}),s.jsx(Ct,{path:"/logout",component:MBe}),s.jsx(Ct,{path:"/",component:zse}),s.jsx(Ct,{path:"/home",component:vSe}),s.jsx(Ct,{path:"/profile-gateway",component:ySe}),s.jsx(Ct,{path:"/parent-dashboard",component:s6}),s.jsx(Ct,{path:"/account",component:l4e}),s.jsx(Ct,{path:"/unified-account",component:s6}),s.jsx(Ct,{path:"/add-player",component:wSe}),s.jsx(Ct,{path:"/dashboard",component:c4e}),s.jsx(Ct,{path:"/player-dashboard",component:bSe}),s.jsx(Ct,{path:"/admin-dashboard",component:r6}),s.jsx(Ct,{path:"/coach-dashboard",component:jSe}),s.jsx(Ct,{path:"/admin",component:r6}),s.jsx(Ct,{path:"/search",component:C_e}),s.jsx(Ct,{path:"/teams/:slug",component:__e}),s.jsx(Ct,{path:"/players/:id",component:k_e}),s.jsx(Ct,{path:"/profile",component:NSe}),s.jsx(Ct,{path:"/settings",component:CSe}),s.jsx(Ct,{path:"/player-settings",component:_Se}),s.jsx(Ct,{path:"/coach-settings",component:BSe}),s.jsx(Ct,{path:"/parent-settings",component:SSe}),s.jsx(Ct,{path:"/player-settings/profile",component:kSe}),s.jsx(Ct,{path:"/player-settings/privacy",component:PSe}),s.jsx(Ct,{path:"/player-settings/notifications",component:ESe}),s.jsx(Ct,{path:"/player-settings/security",component:FSe}),s.jsx(Ct,{path:"/player-settings/devices",component:TSe}),s.jsx(Ct,{path:"/player-settings/legal",component:ISe}),s.jsx(Ct,{path:"/player-settings/danger",component:LSe}),s.jsx(Ct,{path:"/parent-settings/profile",component:USe}),s.jsx(Ct,{path:"/parent-settings/privacy",component:DSe}),s.jsx(Ct,{path:"/parent-settings/notifications",component:QSe}),s.jsx(Ct,{path:"/parent-settings/security",component:MSe}),s.jsx(Ct,{path:"/parent-settings/connections",component:RSe}),s.jsx(Ct,{path:"/parent-settings/legal",component:OSe}),s.jsx(Ct,{path:"/parent-settings/devices",component:HSe}),s.jsx(Ct,{path:"/parent-settings/danger",component:VSe}),s.jsx(Ct,{path:"/coach-settings/profile",component:KSe}),s.jsx(Ct,{path:"/coach-settings/coaching",component:zSe}),s.jsx(Ct,{path:"/coach-settings/privacy",component:$Se}),s.jsx(Ct,{path:"/coach-settings/notifications",component:qSe}),s.jsx(Ct,{path:"/coach-settings/security",component:WSe}),s.jsx(Ct,{path:"/coach-settings/connections",component:GSe}),s.jsx(Ct,{path:"/coach-settings/billing",component:ZSe}),s.jsx(Ct,{path:"/coach-settings/devices",component:YSe}),s.jsx(Ct,{path:"/coach-settings/legal",component:XSe}),s.jsx(Ct,{path:"/coach-settings/danger",component:JSe}),s.jsx(Ct,{path:"/team",component:e4e}),s.jsx(Ct,{path:"/schedule",component:t4e}),s.jsx(Ct,{path:"/chat",component:n4e}),s.jsx(Ct,{path:"/training",component:s4e}),s.jsx(Ct,{path:"/training-library",component:r4e}),s.jsx(Ct,{path:"/test-route",component:i4e}),s.jsx(Ct,{path:"/trophies-badges",component:a4e}),s.jsx(Ct,{path:"/skills",component:o4e}),s.jsx(Ct,{path:"/photo-upload",component:UBe}),s.jsx(Ct,{path:"/payments",component:NBe}),s.jsx(Ct,{path:"/no-profiles",component:CBe}),s.jsx(Ct,{path:"/select-profile-type",component:jBe}),s.jsx(Ct,{path:"/profile-selection",component:BBe}),s.jsx(Ct,{path:"/create-profile",component:bBe}),s.jsx(Ct,{path:"/family-onboarding",component:_Be}),(e==null?void 0:e.userType)==="parent"&&s.jsxs(s.Fragment,{children:[s.jsx(Ct,{path:"/roster",component:GL}),s.jsx(Ct,{path:"/schedule-requests",component:ZL}),s.jsx(Ct,{path:"/family",component:Ew}),s.jsx(Ct,{path:"/family-management",component:Ew})]}),(e==null?void 0:e.userType)==="player"&&s.jsx(s.Fragment,{children:s.jsx(Ct,{path:"/player/team-chat",component:F5e})}),(e==null?void 0:e.userType)==="admin"&&s.jsxs(s.Fragment,{children:[s.jsx(Ct,{path:"/coach/team-messages/:teamId",component:P5e}),s.jsx(Ct,{path:"/coach/parent-messages/:teamId",component:E5e}),s.jsx(Ct,{path:"/roster",component:GL}),s.jsx(Ct,{path:"/schedule-requests",component:ZL}),s.jsx(Ct,{path:"/family",component:Ew}),s.jsx(Ct,{path:"/family-management",component:Ew})]}),s.jsx(Ct,{component:yBe})]})}function A4e(){return s.jsx(Xee,{client:hn,children:s.jsxs(NO,{children:[s.jsx(d4e,{}),s.jsx(Nse,{})]})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})});const rY=document.getElementById("root");if(!rY)throw new Error("Root container not found");const u4e=hO(rY);u4e.render(s.jsx(A4e,{}));export{MO as W,Ls as _,kY as c,NB as g};
jackmeadows@Jacks-MacBook-Air ~ % grep -o "Manage billing.*settings" ~/Documents/boxstat/ios/App/App/public/assets/*.js
/Users/jackmeadows/Documents/boxstat/ios/App/App/public/assets/index-BnVbWN2e.js:Manage billing, players & settings"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),o&&s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("coach"),"data-testid":"card-coach-profile",children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:s.jsx(Us,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Coach View"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Manage teams, rosters & evaluations"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),l&&s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("admin"),"data-testid":"card-admin-profile",children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:s.jsx(Fi,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Admin View"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Full system administration"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})}),r.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-gray-700 my-6 pt-4",children:s.jsx("h2",{className:"text-sm font-medium text-gray-400 mb-4 px-1",children:"PLAYER PROFILES"})}),r.map(u=>{var h,f;return s.jsx(ye,{className:"bg-gray-800/50 border-gray-700 hover:bg-gray-800 transition-all cursor-pointer group",onClick:()=>d("player",u.id),"data-testid":`card-player-${u.id}`,children:s.jsxs(we,{className:"p-4 flex items-center gap-4",children:[s.jsxs(wr,{className:"w-16 h-16",children:[s.jsx(Ur,{src:u.profileImageUrl,alt:`${u.firstName} ${u.lastName}`}),s.jsxs(br,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white text-xl font-bold",children:[(h=u.firstName)==null?void 0:h[0],(f=u.lastName)==null?void 0:f[0]]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white",children:[u.firstName," ",u.lastName]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Player Dashboard"})]}),s.jsx(Gs,{className:"w-5 h-5 text-gray-500 group-hover:text-white transition-colors"})]})},u.id)})]})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("button",{onClick:async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}localStorage.removeItem("authToken"),localStorage.removeItem("selectedPlayerId"),localStorage.removeItem("viewingAsParent"),localStorage.removeItem("lastViewedProfileType"),n("/")},className:"text-gray-500 hover:text-gray-300 text-sm transition-colors","data-testid":"button-sign-out",children:"Sign Out"})})]})})}function X_e(){const{user:e,isLoading:t}=dn(),[,n]=Wt(),r=j.useRef(!1),{data:i=[],isLoading:a}=Ge({queryKey:["/api/account/players"],enabled:!!e,staleTime:5*60*1e3});return j.useEffect(()=>{if(t||a||r.current)return;if(!e){n("/");return}r.current=!0;const o=e==null?void 0:e.role,l=e==null?void 0:e.id,c=e==null?void 0:e.activeProfileId,d=e==null?void 0:e.defaultDashboardView,u=o==="coach",h=o==="admin",f=o==="parent",m=o==="player",y=i&&i.length>0,x=localStorage.getItem("lastViewedProfileType"),b=localStorage.getItem("selectedPlayerId"),g=(_,B)=>{localStorage.setItem("selectedPlayerId",_),B?localStorage.setItem("viewingAsParent","true"):localStorage.removeItem("viewingAsParent"),n("/player-dashboard")},v=()=>{localStorage.removeItem("selectedPlayerId"),localStorage.removeItem("viewingAsParent"),n("/parent-dashboard")};if(d){if(d==="player"&&c){g(c,f||h);return}else if(d==="coach"&&(u||h)){n("/coach-dashboard");return}else if(d==="admin"&&h){n("/admin-dashboard");return}else if(d==="parent"){v();return}}if(x){if(x==="player"&&b){g(b,f||h);return}else if(x==="coach"&&(u||h)){n("/coach-dashboard");return}else if(x==="admin"&&h){n("/admin-dashboard");return}else if(x==="parent"){v();return}}h||u||f&&y?n("/profile-gateway"):f&&!y?v():m?g(l,!1):v()},[e,t,i,a,n]),s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})}function J_e(){const[,e]=Wt(),{toast:t}=Tt(),[n,r]=j.useState(""),[i,a]=j.useState(""),[o,l]=j.useState(!1),[c,d]=j.useState(""),[u,h]=j.useState(!1),[f,m]=j.useState(!1),y=async b=>{var g;b.preventDefault(),l(!0);try{console.log("ðŸ” Attempting login with email:",n),console.log("ðŸŒ Current window location:",window.location.href),console.log("ðŸ“¡ Sending POST to /api/auth/login");const v=await bt("POST","/api/auth/login",{email:n,password:i});if(console.log("âœ… Login response received:",v),v.success){if(console.log("ðŸŽ¯ Login success branch - token present?",!!v.token),v.token){console.log("ðŸ’¾ About to store JWT token..."),localStorage.setItem("authToken",v.token),console.log("âœ… Token stored! Verifying...");const B=localStorage.getItem("authToken");console.log("ðŸ” Token retrieved from storage:",B?B.substring(0,20)+"...":"NULL")}else console.warn("âš ï¸ No token in response!");t({title:"Login Successful",description:"Welcome back!"});let _="/account";(g=v.user)!=null&&g.defaultDashboardView&&(v.user.defaultDashboardView==="parent"?_="/unified-account":(localStorage.setItem("selectedPlayerId",v.user.defaultDashboardView),_="/player-dashboard")),console.log("ðŸš€ Redirecting to:",_),await new Promise(B=>setTimeout(B,100)),window.location.href=_}else throw new Error(v.message||"Login failed")}catch(v){console.error("âŒ Login error:",v),console.error("âŒ Error message:",v.message),console.error("âŒ Error stack:",v.stack),v.message&&v.message.includes("verify your email")?t({title:"Email Verification Required",description:v.message,variant:"destructive"}):t({title:"Login Failed",description:v.message||"Invalid email or password",variant:"destructive"})}finally{l(!1)}},x=async b=>{b.preventDefault(),h(!0);try{const g=await bt("POST","/api/auth/request-magic-link",{email:c});if(g.success)t({title:"Magic Link Sent!",description:"Check your email for the login link."}),d("");else throw new Error(g.message||"Failed to send magic link")}catch(g){t({title:"Failed to Send Magic Link",description:g.message||"Please try again later.",variant:"destructive"})}finally{h(!1)}};return s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-br from-gray-900 via-gray-800 to-black safe-bottom",children:[s.jsx("div",{className:"absolute top-6 left-6 safe-top",children:s.jsx("button",{onClick:()=>e("/"),className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 transition-colors","data-testid":"button-back-to-home",children:s.jsx(wa,{className:"w-5 h-5 text-white"})})}),s.jsx("div",{className:"flex flex-col justify-center min-h-screen-safe px-8 py-16 safe-top",children:s.jsxs("div",{className:"w-full max-w-sm mx-auto space-y-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h1",{className:"text-4xl font-bold text-white tracking-tight",children:"Welcome Back"}),s.jsx("p",{className:"text-gray-400 text-lg",children:"Login to access your account"})]}),f?s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"magic-link-email",className:"text-gray-300 text-sm font-medium",children:"Email"}),s.jsx(qe,{id:"magic-link-email",type:"email",placeholder:"your.email@example.com",value:c,onChange:b=>d(b.target.value),required:!0,"data-testid":"input-magic-link-email",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"}),s.jsx("p",{className:"text-sm text-gray-500",children:"We'll send you a secure login link to your email"})]}),s.jsxs(te,{type:"submit",className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold",disabled:u,"data-testid":"button-send-magic-link",children:[s.jsx($i,{className:"w-4 h-4 mr-2"}),u?"Sending...":"Send Magic Link"]})]}),s.jsxs(te,{variant:"ghost",className:"w-full text-gray-400 hover:text-white hover:bg-white/5",onClick:()=>m(!1),"data-testid":"button-back-to-password",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back to Password Login"]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:y,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"email",className:"text-gray-300 text-sm font-medium",children:"Email"}),s.jsx(qe,{id:"email",type:"email",placeholder:"your.email@example.com",value:n,onChange:b=>r(b.target.value),required:!0,"data-testid":"input-email",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{htmlFor:"password",className:"text-gray-300 text-sm font-medium",children:"Password"}),s.jsx(qe,{id:"password",type:"password",placeholder:"Enter your password",value:i,onChange:b=>a(b.target.value),required:!0,"data-testid":"input-password",className:"h-12 bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-red-500 focus:ring-red-500/20"})]}),s.jsxs(te,{type:"submit",className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold",disabled:o,"data-testid":"button-login",children:[s.jsx(_ne,{className:"w-4 h-4 mr-2"}),o?"Logging in...":"Login"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Fl,{className:"bg-white/10"}),s.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-900 px-4 text-sm text-gray-500",children:"or"})]}),s.jsxs(te,{variant:"outline",className:"w-full h-12 bg-transparent border-white/20 text-white hover:bg-white/10",onClick:()=>m(!0),"data-testid":"button-show-magic-link",children:[s.jsx($i,{className:"w-4 h-4 mr-2"}),"Login with Magic Link"]})]}),s.jsxs("div",{className:"space-y-4 pt-4",children:[s.jsxs("p",{className:"text-center text-gray-400",children:["Don't have an account?"," ",s.jsx(te,{variant:"link",className:"p-0 h-auto text-red-500 hover:text-red-400",onClick:()=>e("/register"),"data-testid":"link-register",children:"Register here"})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/privacy-policy"),className:"text-gray-500 text-xs hover:text-gray-400 underline transition-colors","data-testid":"link-privacy-policy",children:"Privacy Policy"})})]})]})})]})}var Gk="Radio",[e5e,MZ]=bi(Gk),[t5e,n5e]=e5e(Gk),RZ=j.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:i=!1,required:a,disabled:o,value:l="on",onCheck:c,form:d,...u}=e,[h,f]=j.useState(null),m=In(t,b=>f(b)),y=j.useRef(!1),x=h?d||!!h.closest("form"):!0;return s.jsxs(t5e,{scope:n,checked:i,disabled:o,children:[s.jsx(zt.button,{type:"button",role:"radio","aria-checked":i,"data-state":VZ(i),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:m,onClick:Rt(e.onClick,b=>{i||c==null||c(),x&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),x&&s.jsx(s5e,{control:h,bubbles:!y.current,name:r,value:l,checked:i,required:a,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});RZ.displayName=Gk;var OZ="RadioIndicator",HZ=j.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...i}=e,a=n5e(OZ,n);return s.jsx(qa,{present:r||a.checked,children:s.jsx(zt.span,{"data-state":VZ(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t})})});HZ.displayName=OZ;var s5e=e=>{const{control:t,checked:n,bubbles:r=!0,...i}=e,a=j.useRef(null),o=Sy(n),l=ky(t);return j.useEffect(()=>{const c=a.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==n&&h){const f=new Event("click",{bubbles:r});h.call(c,n),c.dispatchEvent(f)}},[o,n,r]),s.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:a,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function VZ(e){return e?"checked":"unchecked"}var r5e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Zk="RadioGroup",[i5e,F4e]=bi(Zk,[Uj,MZ]),KZ=Uj(),zZ=MZ(),[a5e,o5e]=i5e(Zk),$Z=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:i,value:a,required:o=!1,disabled:l=!1,orientation:c,dir:d,loop:u=!0,onValueChange:h,...f}=e,m=KZ(n),y=em(d),[x,b]=vo({prop:a,defaultProp:i,onChange:h});return s.jsx(a5e,{scope:n,name:r,required:o,disabled:l,value:x,onValueChange:b,children:s.jsx(RK,{asChild:!0,...m,orientation:c,dir:y,loop:u,children:s.jsx(zt.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:y,...f,ref:t})})})});$Z.displayName=Zk;var qZ="RadioGroupItem",WZ=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...i}=e,a=o5e(qZ,n),o=a.disabled||r,l=KZ(n),c=zZ(n),d=j.useRef(null),u=In(t,d),h=a.value===i.value,f=j.useRef(!1);return j.useEffect(()=>{const m=x=>{r5e.includes(x.key)&&(f.current=!0)},y=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",y)}},[]),s.jsx(OK,{asChild:!0,...l,focusable:!o,active:h,children:s.jsx(RZ,{disabled:o,required:a.required,checked:h,...c,...i,name:a.name,ref:u,onCheck:()=>a.onValueChange(i.value),onKeyDown:Rt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:Rt(i.onFocus,()=>{var m;f.current&&((m=d.current)==null||m.click())})})})});WZ.displayName=qZ;var l5e="RadioGroupIndicator",GZ=j.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,i=zZ(n);return s.jsx(HZ,{...i,...r,ref:t})});GZ.displayName=l5e;var ZZ=$Z,YZ=WZ,c5e=GZ;const XZ=j.forwardRef(({className:e,...t},n)=>s.jsx(ZZ,{className:_t("grid gap-2",e),...t,ref:n}));XZ.displayName=ZZ.displayName;const JZ=j.forwardRef(({className:e,...t},n)=>s.jsx(YZ,{ref:n,className:_t("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(c5e,{className:"flex items-center justify-center",children:s.jsx(y8,{className:"h-2.5 w-2.5 fill-current text-current"})})}));JZ.displayName=YZ.displayName;const d5e=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required")}),A5e=q.object({dateOfBirth:q.string().min(1,"Date of birth is required")}),u5e=q.object({gender:q.enum(["male","female","other"],{required_error:"Please select a gender"})}),h5e=q.object({packageId:q.string().min(1,"Please select a package")});function f5e(){const[,e]=Wt(),{toast:t}=Tt(),[n,r]=j.useState(1),[i,a]=j.useState({}),{data:o=[],isLoading:l}=Ge({queryKey:["/api/programs"],enabled:n>=4}),c=o.reduce((y,x)=>{const b=x.category||"Other";return y[b]||(y[b]=[]),y[b].push(x),y},{}),d=ot({mutationFn:async y=>await bt("/api/account/players",{method:"POST",data:y}),onSuccess:y=>{y.checkoutUrl?(t({title:"Redirecting to Payment",description:"Please complete payment to finalize player registration."}),setTimeout(()=>{window.location.href=y.checkoutUrl},1e3)):(hn.invalidateQueries({queryKey:["/api/account/players"]}),hn.invalidateQueries({queryKey:["/api/payments"]}),t({title:"Player Added!",description:"Player has been successfully added to your account."}),setTimeout(()=>{e("/unified-account")},1e3))},onError:y=>{t({title:"Failed to Add Player",description:y.message||"Something went wrong. Please try again.",variant:"destructive"})}}),u=()=>r(y=>Math.min(y+1,5)),h=()=>r(y=>Math.max(y-1,1)),f=n/5*100,m=o.find(y=>y.id===i.packageId);return s.jsx("div",{className:"scrollable-page bg-gray-50 safe-bottom py-8 px-4",children:s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Gu,{className:"w-6 h-6"}),"Add Player"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${f}%`}})}),s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Step ",n," of 5"]})]}),s.jsxs(we,{children:[n===1&&s.jsx(m5e,{defaultValues:{firstName:i.firstName||"",lastName:i.lastName||""},onSubmit:y=>{a({...i,...y}),u()},onBack:()=>e("/unified-account")}),n===2&&s.jsx(p5e,{defaultValues:{dateOfBirth:i.dateOfBirth||""},onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===3&&s.jsx(g5e,{defaultValues:{gender:i.gender||""},onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===4&&s.jsx(x5e,{defaultValues:{packageId:i.packageId||""},programs:o,programsByCategory:c,isLoading:l,onSubmit:y=>{a({...i,...y}),u()},onBack:h}),n===5&&s.jsx(y5e,{playerData:i,selectedProgram:m,onSubmit:()=>{const y={...i};d.mutate(y)},onBack:h,isSubmitting:d.isPending})]})]})})})}function m5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(d5e),defaultValues:e});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"firstName",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"First Name *"}),s.jsx(ut,{children:s.jsx(qe,{...i,"data-testid":"input-firstName"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:r.control,name:"lastName",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Last Name *"}),s.jsx(ut,{children:s.jsx(qe,{...i,"data-testid":"input-lastName"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function p5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(A5e),defaultValues:e});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"dateOfBirth",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Date of Birth *"}),s.jsx(ut,{children:s.jsx(qe,{type:"date",...i,"data-testid":"input-dateOfBirth"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function g5e({defaultValues:e,onSubmit:t,onBack:n}){const r=Dr({resolver:Qr(u5e),defaultValues:{gender:e.gender}});return s.jsx(Mr,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-4",children:[s.jsx(it,{control:r.control,name:"gender",render:({field:i})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Gender *"}),s.jsxs(Qt,{onValueChange:i.onChange,defaultValue:i.value,children:[s.jsx(ut,{children:s.jsx(Ut,{"data-testid":"select-gender",children:s.jsx(Mt,{placeholder:"Select gender"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"male","data-testid":"option-male",children:"Male"}),s.jsx(xe,{value:"female","data-testid":"option-female",children:"Female"}),s.jsx(xe,{value:"other","data-testid":"option-other",children:"Other"})]})]}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:n,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function x5e({defaultValues:e,programs:t,programsByCategory:n,isLoading:r,onSubmit:i,onBack:a}){const o=Dr({resolver:Qr(h5e),defaultValues:{packageId:e.packageId||""}});return r?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(Nc,{className:"w-8 h-8 animate-spin text-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Loading programs..."})]}):t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-gray-600",children:"No programs available at this time."}),s.jsxs(te,{onClick:a,variant:"outline",className:"mt-4","data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]})]}):s.jsx(Mr,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(i),className:"space-y-6",children:[s.jsx(it,{control:o.control,name:"packageId",render:({field:l})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Select a Program *"}),s.jsx(ut,{children:s.jsx(XZ,{onValueChange:l.onChange,defaultValue:l.value,className:"space-y-3","data-testid":"radiogroup-packages",children:Object.entries(n).map(([c,d])=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"font-semibold text-gray-700 text-sm mt-4",children:c}),d.map(u=>s.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-gray-50 transition","data-testid":`package-option-${u.id}`,children:[s.jsx(JZ,{value:u.id,id:u.id,"data-testid":`radio-${u.id}`}),s.jsx(yt,{htmlFor:u.id,className:"flex-1 cursor-pointer",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900","data-testid":`text-program-name-${u.id}`,children:u.name}),u.description&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.description}),s.jsxs("div",{className:"flex gap-2 mt-2 flex-wrap",children:[u.type&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:u.type}),u.billingModel&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800",children:u.billingModel}),u.type==="Subscription"&&u.billingCycle&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800",children:u.billingCycle})]})]}),u.price&&s.jsxs("div",{className:"text-right ml-4",children:[s.jsxs("p",{className:"font-bold text-blue-600","data-testid":`text-program-price-${u.id}`,children:["$",(u.price/100).toFixed(2)]}),u.type==="Subscription"&&u.billingCycle&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["per ",u.billingCycle.toLowerCase()]})]})]})})]},u.id))]},c))})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:a,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs(te,{type:"submit","data-testid":"button-next",children:["Next",s.jsx(Gs,{className:"w-4 h-4 ml-2"})]})]})]})})}function y5e({playerData:e,selectedProgram:t,onSubmit:n,onBack:r,isSubmitting:i}){return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Payment Summary"}),s.jsxs("div",{className:"border rounded-lg p-4 mb-4 bg-gray-50",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Player Information"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("p",{"data-testid":"text-player-name",children:[s.jsx("span",{className:"text-gray-600",children:"Name:"})," ",s.jsxs("span",{className:"font-medium",children:[e.firstName," ",e.lastName]})]}),s.jsxs("p",{"data-testid":"text-player-dob",children:[s.jsx("span",{className:"text-gray-600",children:"Date of Birth:"})," ",s.jsx("span",{className:"font-medium",children:e.dateOfBirth})]}),s.jsxs("p",{"data-testid":"text-player-gender",children:[s.jsx("span",{className:"text-gray-600",children:"Gender:"})," ",s.jsx("span",{className:"font-medium capitalize",children:e.gender})]})]})]}),t&&s.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50 border-blue-200",children:[s.jsxs("h4",{className:"font-medium text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(ih,{className:"w-4 h-4"}),"Selected Package"]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold text-gray-900","data-testid":"text-selected-program-name",children:t.name}),t.description&&s.jsx("p",{className:"text-sm text-gray-600",children:t.description}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-blue-200",children:[s.jsx("span",{className:"text-gray-700 font-medium",children:"Total Amount:"}),s.jsxs("span",{className:"text-2xl font-bold text-blue-600","data-testid":"text-total-amount",children:["$",t.price?(t.price/100).toFixed(2):"0.00"]})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," You will be redirected to a secure payment page to complete your transaction. The player will be added to your account after successful payment."]})})]}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs(te,{type:"button",variant:"outline",onClick:r,disabled:i,"data-testid":"button-back",children:[s.jsx(wa,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx(te,{onClick:n,disabled:i,"data-testid":"button-proceed-payment",children:i?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"w-4 h-4 mr-2"}),"Proceed to Payment"]})})]})]})}function v5e(){const[,e]=Wt(),[t,n]=j.useState("loading"),[r,i]=j.useState(""),[a,o]=j.useState(!1);return j.useEffect(()=>{(async()=>{const c=new URLSearchParams(window.location.search),d=c.get("token"),u=c.get("email");if(!d){n("error"),i("Invalid verification link. No token provided.");return}try{let h=`/api/auth/verify-email?token=${encodeURIComponent(d)}`;u&&(h+=`&email=${encodeURIComponent(u)}`);const f=await fetch(h),m=await f.json();if(f.ok&&m.success){n("success"),i(m.message),o(m.stripeDataFound||!1);const y=m.email||c.get("email");setTimeout(()=>{e(`/registration?verified=${encodeURIComponent(y||"")}&continue=true`)},2e3)}else n("error"),i(m.message||"Verification failed. Please try again.")}catch{n("error"),i("An error occurred during verification. Please try again.")}})()},[e]),s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-blue-50 to-indigo-100 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center mb-4",children:[t==="loading"&&s.jsx(Nc,{className:"h-16 w-16 text-blue-600 animate-spin","data-testid":"icon-loading"}),t==="success"&&s.jsx(Ra,{className:"h-16 w-16 text-green-600","data-testid":"icon-success"}),t==="error"&&s.jsx(rh,{className:"h-16 w-16 text-red-600","data-testid":"icon-error"})]}),s.jsxs(Ke,{children:[t==="loading"&&"Verifying Your Email...",t==="success"&&"Email Verified!",t==="error"&&"Verification Failed"]}),s.jsx(zn,{children:r})]}),t!=="loading"&&s.jsxs(we,{className:"flex flex-col gap-3",children:[t==="success"&&a&&s.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg mb-3","data-testid":"stripe-data-found",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ba,{className:"h-5 w-5 text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900 text-sm",children:"Payment History Found"}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"We found your information from previous payments and have prefilled your profile."})]})]})}),t==="success"&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Nc,{className:"h-8 w-8 text-blue-600 animate-spin mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Redirecting you to continue registration..."})]}),t==="error"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{onClick:()=>e("/register"),className:"w-full","data-testid":"button-back-to-register",children:"Back to Registration"}),s.jsx(te,{variant:"outline",onClick:()=>e("/login"),className:"w-full","data-testid":"button-go-to-login",children:"Go to Login"})]})]})]})})}function w5e(){const[,e]=Wt(),[t,n]=j.useState("loading"),[r,i]=j.useState("");return j.useEffect(()=>{(async()=>{var c;const l=new URLSearchParams(window.location.search).get("token");if(!l){n("error"),i("Invalid magic link. No token provided.");return}try{const d=await fetch(`/api/auth/magic-link-login?token=${l}`),u=await d.json();if(d.ok&&u.success){n("success"),i(u.message);let h="/account";(c=u.user)!=null&&c.defaultDashboardView&&(u.user.defaultDashboardView==="parent"?h="/unified-account":(localStorage.setItem("selectedPlayerId",u.user.defaultDashboardView),h="/player-dashboard")),setTimeout(()=>{window.location.href=h},1e3)}else n("error"),i(u.message||"Magic link login failed. Please try again.")}catch{n("error"),i("An error occurred during login. Please try again.")}})()},[]),s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-blue-50 to-indigo-100 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center mb-4",children:[t==="loading"&&s.jsx(Nc,{className:"h-16 w-16 text-blue-600 animate-spin"}),t==="success"&&s.jsx(Ra,{className:"h-16 w-16 text-green-600"}),t==="error"&&s.jsx(rh,{className:"h-16 w-16 text-red-600"})]}),s.jsxs(Ke,{children:[t==="loading"&&"Logging You In...",t==="success"&&"Login Successful!",t==="error"&&"Login Failed"]}),s.jsxs(zn,{children:[t==="loading"&&"Please wait while we verify your magic link...",t==="success"&&"Redirecting to your account...",t==="error"&&r]})]}),t==="error"&&s.jsx(we,{className:"flex flex-col gap-3",children:s.jsx(te,{onClick:()=>e("/login"),className:"w-full","data-testid":"button-back-to-login",children:"Back to Login"})})]})})}function GL(){const{toast:e}=Tt(),t=os(),[n,r]=j.useState(null),[i,a]=j.useState(""),{data:o=[],isLoading:l}=Ge({queryKey:["/api/sportsengine/events-with-roster"]}),{data:c=[],isLoading:d}=Ge({queryKey:["/api/sportsengine/schedule-requests"]}),u=ot({mutationFn:async({rosterId:g,status:v,notes:_})=>bt("PUT",`/api/sportsengine/roster/${g}/status`,{status:v,notes:_}),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/sportsengine/events-with-roster"]}),e({title:"Roster Updated",description:"Player status has been updated successfully."})},onError:g=>{e({title:"Update Failed",description:"Failed to update roster status. Please try again.",variant:"destructive"})}}),h=async(g,v)=>{u.mutate({rosterId:g,status:v,notes:i}),a("")},f=g=>{switch(g){case"confirmed":return s.jsxs(et,{variant:"default",className:"bg-green-100 text-green-800",children:[s.jsx(Ra,{className:"w-3 h-3 mr-1"}),"Confirmed"]});case"pending":return s.jsxs(et,{variant:"secondary",children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Pending"]});case"declined":return s.jsxs(et,{variant:"destructive",children:[s.jsx(rh,{className:"w-3 h-3 mr-1"}),"Declined"]});case"unavailable":return s.jsxs(et,{variant:"outline",children:[s.jsx(jd,{className:"w-3 h-3 mr-1"}),"Unavailable"]});default:return s.jsx(et,{variant:"outline",children:g})}},m=g=>{switch(g){case"high":return s.jsx(et,{variant:"destructive",children:"High Priority"});case"medium":return s.jsx(et,{variant:"secondary",children:"Medium Priority"});case"low":return s.jsx(et,{variant:"outline",children:"Low Priority"});default:return s.jsx(et,{variant:"outline",children:g})}},y=g=>{switch(g){case"approved":return s.jsx(et,{variant:"default",className:"bg-green-100 text-green-800",children:"Approved"});case"pending":return s.jsx(et,{variant:"secondary",children:"Pending Review"});case"denied":return s.jsx(et,{variant:"destructive",children:"Denied"});default:return s.jsx(et,{variant:"outline",children:g})}};if(l||d)return s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading roster management data..."})]})});const x=o.filter(g=>new Date(g.startTime)>new Date),b=c.filter(g=>g.status==="pending");return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Roster & Schedule Management"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage team rosters and schedule requests through SportsEngine"})]}),s.jsxs(My,{defaultValue:"events",className:"space-y-6",children:[s.jsxs(Fg,{className:"grid w-full grid-cols-3",children:[s.jsx(Wr,{value:"events",children:"Event Rosters"}),s.jsx(Wr,{value:"requests",children:"Schedule Requests"}),s.jsx(Wr,{value:"analytics",children:"Team Analytics"})]}),s.jsx(Gr,{value:"events",className:"space-y-4",children:s.jsx("div",{className:"grid gap-4",children:x.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-5 h-5"}),g.title]}),s.jsxs(zn,{className:"flex items-center gap-4 mt-2",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"w-4 h-4"}),new Date(g.startTime).toLocaleDateString()," at ",new Date(g.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Yi,{className:"w-4 h-4"}),g.location]})]})]}),s.jsx(et,{variant:g.type==="game"?"default":"secondary",children:g.type.charAt(0).toUpperCase()+g.type.slice(1)})]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:g.description}),s.jsxs("div",{className:"flex gap-4 text-sm",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(vs,{className:"w-4 h-4"}),"Total: ",g.rosterStats.total]}),s.jsxs("span",{className:"text-green-600",children:["Confirmed: ",g.rosterStats.confirmed]}),s.jsxs("span",{className:"text-yellow-600",children:["Pending: ",g.rosterStats.pending]}),s.jsxs("span",{className:"text-red-600",children:["Declined: ",g.rosterStats.declined]})]}),g.rosterDeadline&&s.jsxs("div",{className:"text-sm text-orange-600",children:[s.jsx(Ar,{className:"w-4 h-4 inline mr-1"}),"Roster deadline: ",new Date(g.rosterDeadline).toLocaleDateString()," at ",new Date(g.rosterDeadline).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium",children:"Team Roster:"}),s.jsx("div",{className:"grid gap-2",children:g.roster.map(v=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Us,{className:"w-4 h-4"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:v.playerName}),v.position&&s.jsx("p",{className:"text-sm text-muted-foreground",children:v.position})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[f(v.status),v.status==="pending"&&s.jsxs($n,{children:[s.jsx(ja,{asChild:!0,children:s.jsx(te,{size:"sm",variant:"outline",onClick:()=>r(g),children:"Respond"})}),s.jsxs(Qn,{children:[s.jsxs(es,{children:[s.jsxs(qn,{children:["Roster Response - ",v.playerName]}),s.jsxs(ch,{children:["Confirm availability for ",g.title]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(yt,{htmlFor:"notes",children:"Notes (optional)"}),s.jsx(Vs,{id:"notes",placeholder:"Any additional notes...",value:i,onChange:_=>a(_.target.value)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(te,{onClick:()=>h(v.id,"confirmed"),disabled:u.isPending,className:"flex-1",children:[s.jsx(Ra,{className:"w-4 h-4 mr-2"}),"Confirm"]}),s.jsxs(te,{variant:"destructive",onClick:()=>h(v.id,"declined"),disabled:u.isPending,className:"flex-1",children:[s.jsx(rh,{className:"w-4 h-4 mr-2"}),"Decline"]})]})]})]})]})]})]},v.id))})]})]})})]},g.id))})}),s.jsx(Gr,{value:"requests",className:"space-y-4",children:s.jsxs("div",{className:"grid gap-4",children:[b.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{children:[g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{children:["Requested on ",new Date(g.requestDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[m(g.priority),y(g.status)]})]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Date:"})," ",new Date(g.requestedDate).toLocaleDateString()]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Time:"})," ",g.requestedTime]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Duration:"})," ",g.duration," minutes"]}),g.location&&s.jsxs("div",{children:[s.jsx("strong",{children:"Location:"})," ",g.location]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"Opponent:"})," ",g.opponent]})]}),g.notes&&s.jsxs("div",{children:[s.jsx("strong",{children:"Notes:"})," ",g.notes]})]})})]},g.id)),b.length===0&&s.jsx(ye,{children:s.jsx(we,{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"No pending schedule requests"})})})]})}),s.jsx(Gr,{value:"analytics",className:"space-y-4",children:s.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Event Overview"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Events:"}),s.jsx("span",{className:"font-medium",children:o.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Upcoming:"}),s.jsx("span",{className:"font-medium",children:x.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Games:"}),s.jsx("span",{className:"font-medium",children:o.filter(g=>g.type==="game").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Practices:"}),s.jsx("span",{className:"font-medium",children:o.filter(g=>g.type==="practice").length})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Roster Statistics"})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-2",children:x.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Avg Confirmed:"}),s.jsx("span",{className:"font-medium",children:Math.round(x.reduce((g,v)=>g+v.rosterStats.confirmed,0)/x.length)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Avg Pending:"}),s.jsx("span",{className:"font-medium",children:Math.round(x.reduce((g,v)=>g+v.rosterStats.pending,0)/x.length)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Response Rate:"}),s.jsxs("span",{className:"font-medium",children:[Math.round(x.reduce((g,v)=>g+v.rosterStats.confirmed+v.rosterStats.declined,0)/x.reduce((g,v)=>g+v.rosterStats.total,0)*100),"%"]})]})]})})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Schedule Requests"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Requests:"}),s.jsx("span",{className:"font-medium",children:c.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Pending:"}),s.jsx("span",{className:"font-medium",children:c.filter(g=>g.status==="pending").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Approved:"}),s.jsx("span",{className:"font-medium",children:c.filter(g=>g.status==="approved").length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Approval Rate:"}),s.jsxs("span",{className:"font-medium",children:[c.length>0?Math.round(c.filter(g=>g.status==="approved").length/c.length*100):0,"%"]})]})]})})]})]})})]})]})}const b5e=q.object({teamId:q.string().min(1,"Team is required"),requestType:q.enum(["game","tournament","camp","exhibition","practice","skills","workshop","talk","combine","training","meeting","course","tryout","skills-assessment","team-building","parent-meeting","equipment-pickup","photo-day","award-ceremony","fnh"]),requestedDate:q.string().min(1,"Date is required"),requestedTime:q.string().min(1,"Time is required"),duration:q.number().min(30,"Duration must be at least 30 minutes"),location:q.string().optional(),opponent:q.string().optional(),priority:q.enum(["high","medium","low"]),notes:q.string().optional()});function ZL(){const{toast:e}=Tt(),t=os(),[n,r]=j.useState(!1),i=Dr({resolver:Qr(b5e),defaultValues:{requestType:"practice",priority:"medium",duration:90}}),{data:a=[],isLoading:o}=Ge({queryKey:["/api/sportsengine/my-teams"]}),{data:l=[],isLoading:c}=Ge({queryKey:["/api/sportsengine/schedule-requests"]}),d=ot({mutationFn:async g=>bt("POST","/api/sportsengine/schedule-requests",g),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/sportsengine/schedule-requests"]}),r(!1),i.reset(),e({title:"Request Submitted",description:"Your schedule request has been submitted for review."})},onError:g=>{e({title:"Request Failed",description:"Failed to submit schedule request. Please try again.",variant:"destructive"})}}),u=g=>{d.mutate(g)},h=g=>{switch(g){case"high":return s.jsx(et,{variant:"destructive",children:"High Priority"});case"medium":return s.jsx(et,{variant:"secondary",children:"Medium Priority"});case"low":return s.jsx(et,{variant:"outline",children:"Low Priority"});default:return s.jsx(et,{variant:"outline",children:g})}},f=g=>{switch(g){case"approved":return s.jsxs(et,{variant:"default",className:"bg-green-100 text-green-800",children:[s.jsx(Ra,{className:"w-3 h-3 mr-1"}),"Approved"]});case"pending":return s.jsxs(et,{variant:"secondary",children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Pending Review"]});case"denied":return s.jsxs(et,{variant:"destructive",children:[s.jsx(rh,{className:"w-3 h-3 mr-1"}),"Denied"]});default:return s.jsx(et,{variant:"outline",children:g})}},m=g=>{switch(g){case"game":return"ðŸ€";case"practice":return"ðŸƒ";case"tournament":return"ðŸ†";default:return"ðŸ“…"}};if(o||c)return s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading schedule requests..."})]})});const y=l.filter(g=>g.status==="pending"),x=l.filter(g=>g.status==="approved"),b=l.filter(g=>g.status==="denied");return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Schedule Requests"}),s.jsx("p",{className:"text-muted-foreground",children:"Request new games, practices, and tournament slots"})]}),s.jsxs($n,{open:n,onOpenChange:r,children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{children:[s.jsx(sl,{className:"w-4 h-4 mr-2"}),"New Request"]})}),s.jsxs(Qn,{className:"max-w-2xl",children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Create Schedule Request"}),s.jsx(ch,{children:"Submit a request for a new game, practice, or tournament slot"})]}),s.jsx(Mr,{...i,children:s.jsxs("form",{onSubmit:i.handleSubmit(u),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"teamId",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Team"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select team"})})}),s.jsx(Dt,{children:a.map(v=>s.jsx(xe,{value:v.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:v.name}),s.jsx("span",{className:"text-gray-500",children:v.program==="Youth-Club"?"Youth Club":v.ageGroup})]})},v.id))})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"requestType",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Request Type"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select type"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"game",children:"Game"}),s.jsx(xe,{value:"tournament",children:"Tournament"}),s.jsx(xe,{value:"camp",children:"Camp"}),s.jsx(xe,{value:"exhibition",children:"Exhibition"}),s.jsx(xe,{value:"practice",children:"Practice"}),s.jsx(xe,{value:"skills",children:"Skills"}),s.jsx(xe,{value:"workshop",children:"Workshop"}),s.jsx(xe,{value:"talk",children:"Talk"}),s.jsx(xe,{value:"combine",children:"Combine"}),s.jsx(xe,{value:"training",children:"Training"}),s.jsx(xe,{value:"meeting",children:"Meeting"}),s.jsx(xe,{value:"course",children:"Course"}),s.jsx(xe,{value:"tryout",children:"Tryout"}),s.jsx(xe,{value:"skills-assessment",children:"Skills Assessment"}),s.jsx(xe,{value:"team-building",children:"Team Building"}),s.jsx(xe,{value:"parent-meeting",children:"Parent Meeting"}),s.jsx(xe,{value:"equipment-pickup",children:"Equipment Pickup"}),s.jsx(xe,{value:"photo-day",children:"Photo Day"}),s.jsx(xe,{value:"award-ceremony",children:"Award Ceremony"}),s.jsx(xe,{value:"fnh",children:"FNH"})]})]}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"requestedDate",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Requested Date"}),s.jsx(ut,{children:s.jsx(qe,{type:"date",...g})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"requestedTime",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Requested Time"}),s.jsx(ut,{children:s.jsx(qe,{type:"time",...g})}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:i.control,name:"duration",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Duration (minutes)"}),s.jsx(ut,{children:s.jsx(qe,{type:"number",...g,onChange:v=>g.onChange(parseInt(v.target.value))})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"priority",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Priority"}),s.jsxs(Qt,{onValueChange:g.onChange,defaultValue:g.value,children:[s.jsx(ut,{children:s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select priority"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"low",children:"Low Priority"}),s.jsx(xe,{value:"medium",children:"Medium Priority"}),s.jsx(xe,{value:"high",children:"High Priority"})]})]}),s.jsx(ft,{})]})})]}),s.jsx(it,{control:i.control,name:"location",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Preferred Location (optional)"}),s.jsx(ut,{children:s.jsx(qe,{placeholder:"e.g., Momentous Sports Center - Court A",...g})}),s.jsx(ft,{})]})}),i.watch("requestType")==="game"&&s.jsx(it,{control:i.control,name:"opponent",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Opponent (optional)"}),s.jsx(ut,{children:s.jsx(qe,{placeholder:"e.g., Thunder, Eagles",...g})}),s.jsx(ft,{})]})}),s.jsx(it,{control:i.control,name:"notes",render:({field:g})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Additional Notes (optional)"}),s.jsx(ut,{children:s.jsx(Vs,{placeholder:"Any additional details or special requirements...",...g})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(te,{type:"submit",disabled:d.isPending,className:"flex-1",children:d.isPending?"Submitting...":"Submit Request"}),s.jsx(te,{type:"button",variant:"outline",onClick:()=>r(!1),className:"flex-1",children:"Cancel"})]})]})})]})]})]}),s.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:l.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Requests"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:y.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved"})]})}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Denied"})]})})]}),y.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Pending Requests"}),s.jsx("div",{className:"grid gap-4",children:y.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx("span",{children:m(g.requestType)}),g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{children:["Submitted on ",new Date(g.requestDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[h(g.priority),f(g.status)]})]})}),s.jsxs(we,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(g.requestedDate).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),s.jsxs("span",{children:[g.requestedTime," (",g.duration," min)"]})]}),g.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),s.jsx("span",{children:g.location})]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"vs"})," ",g.opponent]})]}),g.notes&&s.jsx("div",{className:"mt-3 p-3 bg-muted rounded-lg",children:s.jsx("p",{className:"text-sm",children:g.notes})})]})]},g.id))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"All Requests"}),s.jsx("div",{className:"grid gap-4",children:l.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"text-center py-8",children:[s.jsx("p",{className:"text-muted-foreground",children:"No schedule requests yet"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "New Request" to submit your first schedule request'})]})}):l.map(g=>s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx("span",{children:m(g.requestType)}),g.requestType.charAt(0).toUpperCase()+g.requestType.slice(1)," Request"]}),s.jsxs(zn,{className:"flex items-center gap-4",children:[s.jsxs("span",{children:["Submitted: ",new Date(g.requestDate).toLocaleDateString()]}),g.approvalDate&&s.jsxs("span",{children:["Processed: ",new Date(g.approvalDate).toLocaleDateString()]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[h(g.priority),f(g.status)]})]})}),s.jsxs(we,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(g.requestedDate).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),s.jsxs("span",{children:[g.requestedTime," (",g.duration," min)"]})]}),g.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),s.jsx("span",{children:g.location})]}),g.opponent&&s.jsxs("div",{children:[s.jsx("strong",{children:"vs"})," ",g.opponent]})]}),g.notes&&s.jsx("div",{className:"mt-3 p-3 bg-muted rounded-lg",children:s.jsx("p",{className:"text-sm",children:g.notes})})]})]},g.id))})]})]})}const Yk="/assets/UYP%20Logo%20nback-DsWwmSx0.png",YL=[{id:1,title:"Elite Ball Handling",description:"Master advanced dribbling techniques and ball control skills used by professional players. Perfect for players looking to improve their handles and court vision.",previewVideoUrl:"https://player.vimeo.com/video/example1",monthlyPrice:19.99,annualPrice:199.99,duration:"8 weeks",difficulty:"Advanced",totalVideos:24,category:"Skills Development"},{id:2,title:"Advanced Shooting Techniques",description:"Develop consistent shooting form and accuracy from all areas of the court. Includes drills for catch-and-shoot, off-the-dribble, and contested shots.",previewVideoUrl:"https://player.vimeo.com/video/example2",monthlyPrice:24.99,annualPrice:249.99,duration:"10 weeks",difficulty:"Intermediate",totalVideos:30,category:"Shooting"},{id:3,title:"Vertical Jump Program",description:"Increase your vertical leap and explosiveness with scientifically-proven training methods. Includes strength training and plyometric exercises.",previewVideoUrl:"https://player.vimeo.com/video/example3",monthlyPrice:29.99,annualPrice:299.99,duration:"12 weeks",difficulty:"Advanced",totalVideos:36,category:"Athletic Performance"},{id:4,title:"Youth Fundamentals",description:"Perfect for young players starting their basketball journey. Covers basic dribbling, shooting, and defensive fundamentals in an age-appropriate way.",previewVideoUrl:"https://player.vimeo.com/video/example4",monthlyPrice:14.99,annualPrice:149.99,duration:"6 weeks",difficulty:"Beginner",totalVideos:18,category:"Fundamentals"}];function j5e(){const{user:e}=dn(),n=new URLSearchParams(window.location.search).get("mode")==="player"?"player":"parent",[,r]=Wt(),{toast:i}=Tt(),[a,o]=j.useState(null),[l,c]=j.useState("monthly"),{data:d}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"subscriptions"],enabled:!!(e!=null&&e.id)}),u=ot({mutationFn:async m=>{const y=YL.find(b=>b.id===m.programId);if(!y)throw new Error("Program not found");const x=m.type==="monthly"?y.monthlyPrice:y.annualPrice;return await bt("POST","/api/payments/sportsengine/create",{type:"training_subscription",amount:x,description:`${y.title} - ${m.type} subscription`,metadata:{programId:m.programId,subscriptionType:m.type}})},onSuccess:m=>{i({title:"Payment Initiated",description:"Redirecting to SportsEngine payment..."}),window.location.href=`/payment/training/${a==null?void 0:a.id}?type=${l}`},onError:m=>{i({title:"Payment Failed",description:m.message,variant:"destructive"})}}),h=m=>d==null?void 0:d.some(y=>y.programId===m&&y.status==="active"),f=(m,y)=>{o(m),c(y),u.mutate({programId:m.id,type:y})};return e?s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"BoxStat Academy"})]}),s.jsx(te,{variant:"ghost",onClick:()=>r("/"),className:"text-gray-600 hover:text-gray-900",children:"Back to Dashboard"})]})})}),s.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:n==="player"?"Your Training Programs":"Premium Training Programs"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:n==="player"?"Practice and improve your basketball skills with these training videos assigned to you.":"Take your game to the next level with our professional training programs. Learn from expert coaches and improve your skills with structured, progressive training."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8",children:YL.map(m=>s.jsxs(ye,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsx(Ve,{className:"p-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"aspect-video bg-gray-900 flex items-center justify-center",children:s.jsx("iframe",{src:m.previewVideoUrl,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx(et,{variant:m.difficulty==="Beginner"?"default":m.difficulty==="Intermediate"?"secondary":"destructive",children:m.difficulty})})]})}),s.jsxs(we,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Ke,{className:"text-xl",children:m.title}),h(m.id)&&s.jsxs(et,{variant:"default",className:"bg-green-500",children:[s.jsx(Ra,{className:"h-3 w-3 mr-1"}),"Subscribed"]})]}),s.jsx("p",{className:"text-gray-600 mb-4",children:m.description}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ar,{className:"h-4 w-4 mr-1"}),m.duration]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(PS,{className:"h-4 w-4 mr-1"}),m.totalVideos," videos"]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Aj,{className:"h-4 w-4 mr-1"}),m.category]})]}),n==="player"?h(m.id)?s.jsx(te,{className:"w-full",onClick:()=>r(`/training/${m.id}`),children:"Continue Training"}):s.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg text-center",children:[s.jsx(jh,{className:"h-6 w-6 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Ask your parent to unlock this training program"})]}):h(m.id)?s.jsx(te,{className:"w-full",onClick:()=>r(`/training/${m.id}`),children:"Access Training"}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx("span",{className:"text-sm font-medium",children:"Subscription Options:"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(te,{variant:"outline",className:"text-sm",onClick:()=>f(m,"monthly"),disabled:u.isPending,children:[s.jsx(ih,{className:"h-4 w-4 mr-1"}),"$",m.monthlyPrice,"/month"]}),s.jsxs(te,{variant:"outline",className:"text-sm",onClick:()=>f(m,"annual"),disabled:u.isPending,children:[s.jsx(Ai,{className:"h-4 w-4 mr-1"}),"$",m.annualPrice,"/year"]})]}),s.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Save $",(m.monthlyPrice*12-m.annualPrice).toFixed(2)," with annual plan"]})]})]})]},m.id))})]})]}):s.jsx("div",{children:"Loading..."})}function N5e(){const{user:e}=dn(),n=new URLSearchParams(window.location.search).get("mode")==="player"?"player":"parent",[,r]=Wt(),[i,a]=j.useState(null),{data:o}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"training-programs"],enabled:!!(e!=null&&e.id)}),c=o||[{id:1,title:"Elite Ball Handling",progress:65,totalModules:8,completedModules:5,modules:[{id:1,title:"Basic Dribbling Foundation",description:"Master the fundamental dribbling techniques",videoUrl:"https://player.vimeo.com/video/example1",duration:"12:30",completed:!0,order:1},{id:2,title:"Advanced Crossover Moves",description:"Learn professional crossover techniques",videoUrl:"https://player.vimeo.com/video/example2",duration:"15:45",completed:!0,order:2},{id:3,title:"Behind-the-Back Dribbling",description:"Master behind-the-back moves in game situations",videoUrl:"https://player.vimeo.com/video/example3",duration:"18:20",completed:!1,order:3}]}];return e?s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"My Training Library"})]}),s.jsxs(te,{variant:"ghost",onClick:()=>r("/training"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Programs"]})]})})}),s.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(une,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Training Programs Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:n==="player"?"Ask your parent to add training programs for you to practice and improve your skills.":"Subscribe to training programs to access exclusive content and improve your skills."}),n==="parent"&&s.jsx(te,{onClick:()=>r("/training"),children:"Browse Training Programs"})]}):s.jsx("div",{className:"space-y-8",children:c.map(d=>s.jsxs(ye,{className:"overflow-hidden",children:[s.jsx(Ve,{className:"bg-primary/5",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Ke,{className:"text-2xl",children:d.title}),s.jsxs("p",{className:"text-gray-600 mt-1",children:[d.completedModules," of ",d.totalModules," modules completed"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx(Ai,{className:"h-5 w-5 text-yellow-500 mr-2"}),s.jsxs("span",{className:"text-lg font-bold",children:[d.progress,"%"]})]}),s.jsx(xd,{value:d.progress,className:"w-32"})]})]})}),s.jsx(we,{className:"p-6",children:s.jsx("div",{className:"grid gap-4",children:d.modules.map(u=>s.jsx("div",{className:`p-4 rounded-lg border-2 transition-all cursor-pointer ${u.completed?"bg-green-50 border-green-200 hover:border-green-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,onClick:()=>a(u),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${u.completed?"bg-green-500":"bg-gray-400"}`,children:u.completed?s.jsx(Ra,{className:"h-4 w-4 text-white"}):s.jsx(PS,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:u.title}),s.jsx("p",{className:"text-sm text-gray-500",children:u.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(et,{variant:"secondary",className:"flex items-center",children:[s.jsx(Ar,{className:"h-3 w-3 mr-1"}),u.duration]}),s.jsx(te,{size:"sm",variant:u.completed?"secondary":"default",children:u.completed?"Rewatch":"Watch"})]})]})},u.id))})})]},d.id))})}),i&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h3",{className:"text-lg font-medium",children:i.title}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>a(null),children:"Ã—"})]}),s.jsx("div",{className:"aspect-video",children:s.jsx("iframe",{src:i.videoUrl,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(et,{variant:"secondary",className:"flex items-center",children:[s.jsx(Ar,{className:"h-3 w-3 mr-1"}),i.duration]}),s.jsx(te,{onClick:()=>{a(null)},disabled:i.completed,children:i.completed?"Completed":"Mark as Complete"})]})]})]})})]}):s.jsx("div",{children:"Loading..."})}function C5e(){var y,x;const{user:e}=dn(),[,t]=Wt(),{data:n,isLoading:r}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),{data:i}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"payments"],enabled:!!(e!=null&&e.id)}),{data:a}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"subscriptions"],enabled:!!(e!=null&&e.id)}),{data:o}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"badges"],enabled:!!(e!=null&&e.id)}),{data:l}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"stats"],enabled:!!(e!=null&&e.id)}),{data:c}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"team"],enabled:!!(e!=null&&e.id),staleTime:5*60*1e3,gcTime:30*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:!1});if(!e||r)return s.jsx("div",{children:"Loading..."});const d=e.role==="parent",u=e.role==="player",h=(n==null?void 0:n.firstName)||e.firstName,f=(n==null?void 0:n.lastName)||e.lastName,m=(n==null?void 0:n.profileImageUrl)||e.profileImageUrl;return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:Yk,alt:"BoxStat Academy",className:"h-10 w-10 mr-3 object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"My Profile"})]}),s.jsxs(te,{variant:"ghost",onClick:()=>t("/"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsx(ye,{className:"overflow-hidden",children:s.jsxs(we,{className:"p-0",children:[s.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[s.jsx("div",{className:"w-full aspect-square rounded-2xl overflow-hidden shadow-2xl ring-4 ring-white",children:s.jsxs(wr,{className:"w-full h-full rounded-none",children:[s.jsx(Ur,{src:m,alt:h,className:"object-cover"}),s.jsxs(br,{className:"text-6xl font-bold bg-gradient-to-br from-red-100 to-red-50 text-red-600 rounded-none",children:[h==null?void 0:h[0],f==null?void 0:f[0]]})]})}),s.jsxs("div",{className:"absolute top-4 right-4 text-right space-y-1",children:[s.jsxs("div",{className:"opacity-50",children:[s.jsx("h1",{className:"text-3xl font-black tracking-tight leading-none text-white",children:h}),s.jsx("h2",{className:"text-3xl font-black tracking-tight leading-none text-white",children:f})]}),s.jsxs("div",{className:"text-white text-sm font-bold uppercase tracking-wide opacity-50",children:[((y=e.role)==null?void 0:y.charAt(0).toUpperCase())+((x=e.role)==null?void 0:x.slice(1)),c&&` | ${c.name}`]})]})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx($i,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:e.email})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(dr,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Joined ",Yn(new Date(e.createdAt),"MMMM yyyy")]})]}),s.jsxs(te,{className:"w-full mt-4",variant:"outline",onClick:()=>t("/settings"),children:[s.jsx(dj,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),s.jsx(te,{className:"w-full",variant:"outline",onClick:()=>window.location.href="/api/logout",children:"Sign Out"})]})]})})}),s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[d&&s.jsxs(s.Fragment,{children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(ba,{className:"h-5 w-5 mr-2"}),"Payment History"]})}),s.jsx(we,{children:(i==null?void 0:i.length)>0?s.jsxs("div",{className:"space-y-3",children:[i.slice(0,5).map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:b.description}),s.jsx("p",{className:"text-sm text-gray-500",children:Yn(new Date(b.createdAt),"MMM d, yyyy")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-medium",children:["$",b.amount]}),s.jsx(et,{variant:b.status==="completed"?"default":"secondary",children:b.status})]})]},b.id)),s.jsx(te,{variant:"outline",className:"w-full",onClick:()=>t("/payment"),children:"View All Payments"})]}):s.jsx("p",{className:"text-gray-500",children:"No payment history yet."})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Jp,{className:"h-5 w-5 mr-2"}),"Training Subscriptions"]})}),s.jsx(we,{children:(a==null?void 0:a.length)>0?s.jsxs("div",{className:"space-y-3",children:[a.map(b=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:b.programTitle}),s.jsxs("p",{className:"text-sm text-gray-500",children:[b.type," subscription"]})]}),s.jsx(et,{variant:b.status==="active"?"default":"secondary",children:b.status})]},b.id)),s.jsx(te,{variant:"outline",className:"w-full",onClick:()=>t("/training-library"),children:"Access Training Library"})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-gray-500 mb-3",children:"No active training subscriptions."}),s.jsx(te,{onClick:()=>t("/training"),children:"Browse Training Programs"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(vs,{className:"h-5 w-5 mr-2"}),"Linked Children"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(wr,{className:"w-10 h-10 mr-3",children:s.jsx(br,{children:"AJ"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Alex Johnson"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Lightning Bolts â€¢ Age 10"})]})]}),s.jsx(te,{variant:"outline",className:"w-full",children:"Manage Children"})]})})]})]}),u&&s.jsxs(s.Fragment,{children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Ai,{className:"h-5 w-5 mr-2"}),"Badges & Achievements"]})}),s.jsx(we,{children:(o==null?void 0:o.length)>0?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:o.map(b=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-500 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(Ai,{className:"h-6 w-6 text-white"})}),s.jsx("p",{className:"text-sm font-medium",children:b.title}),s.jsx("p",{className:"text-xs text-gray-500",children:Yn(new Date(b.earnedAt),"MMM d, yyyy")})]},b.id))}):s.jsx("p",{className:"text-gray-500",children:"No badges earned yet. Keep training!"})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center",children:[s.jsx(Jp,{className:"h-5 w-5 mr-2"}),"Player Statistics"]})}),s.jsx(we,{children:(l==null?void 0:l.length)>0?s.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map(b=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:b.value}),s.jsx("p",{className:"text-sm text-gray-600",children:b.statType})]},b.id))}):s.jsx("p",{className:"text-gray-500",children:"No statistics recorded yet."})})]})]})]})]})})]})}const _5e=q.object({playerEmail:q.string().email("Valid email is required"),relationship:q.enum(["parent","guardian","sibling","grandparent"]),canMakePayments:q.boolean(),canViewReports:q.boolean(),emergencyContact:q.boolean()}),B5e=q.object({playerId:q.string().min(1,"Player selection is required"),contact:q.string().min(1,"Contact information is required"),code:q.string().length(6,"Verification code must be 6 digits")});function Ew(){dn();const{toast:e}=Tt(),t=os(),[,n]=Wt(),[r,i]=j.useState(!1),[a,o]=j.useState(!1),[l,c]=j.useState(null),[d,u]=j.useState(""),[h,f]=j.useState("search"),[m,y]=j.useState(""),x=Dr({resolver:Qr(_5e),defaultValues:{relationship:"parent",canMakePayments:!0,canViewReports:!0,emergencyContact:!1}}),b=Dr({resolver:Qr(B5e),defaultValues:{playerId:"",contact:"",code:""}}),{data:g=[],isLoading:v}=Ge({queryKey:["/api/parent/players"]}),{data:_=[],isLoading:B}=Ge({queryKey:["/api/search/notion-players",d],enabled:d.length>=2}),I=ot({mutationFn:async U=>bt("POST","/api/family-members",U),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),i(!1),x.reset(),e({title:"Family Member Added",description:"The player has been successfully added to your family."})},onError:U=>{e({title:"Failed to Add Member",description:"Could not add family member. Please check the email and try again.",variant:"destructive"})}}),Q=ot({mutationFn:async({playerId:U,contact:Z})=>bt("POST","/api/players/claim/request",{playerId:U,contact:Z}),onSuccess:()=>{f("verify"),e({title:"Verification Code Sent",description:`A verification code has been sent to ${m}.`})},onError:U=>{e({title:"Failed to Send Code",description:"Could not send verification code. Please try again.",variant:"destructive"})}}),F=ot({mutationFn:async U=>bt("POST","/api/players/claim/verify",U),onSuccess:U=>{var Z;t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),o(!1),f("search"),c(null),b.reset(),e({title:"Player Claimed Successfully",description:`${(Z=U.player)==null?void 0:Z.fullName} has been added to your family.`})},onError:U=>{e({title:"Verification Failed",description:"Invalid verification code. Please check and try again.",variant:"destructive"})}}),P=ot({mutationFn:async U=>bt("DELETE",`/api/parent/players/${U}`),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),e({title:"Player Removed",description:"The player has been removed from your family successfully."})},onError:U=>{e({title:"Removal Failed",description:"Failed to remove player from family. Please try again.",variant:"destructive"})}}),T=ot({mutationFn:async({memberId:U,permissions:Z})=>bt("PUT",`/api/family-members/${U}`,Z),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/parent/players"]}),t.invalidateQueries({queryKey:["/api/family-members"]}),e({title:"Permissions Updated",description:"Family member permissions have been updated."})},onError:U=>{e({title:"Update Failed",description:"Failed to update permissions. Please try again.",variant:"destructive"})}}),$=U=>{I.mutate(U)},D=(U,Z)=>{confirm(`Are you sure you want to remove ${Z} from your family? This action cannot be undone.`)&&P.mutate(U)},O=U=>{c(U),b.setValue("playerId",U.id),f("request")},V=()=>{l&&m&&(Q.mutate({playerId:l.id,contact:m}),b.setValue("contact",m))},K=U=>{F.mutate(U)},oe=()=>{o(!1),f("search"),c(null),y(""),b.reset(),u("")},ae=(U,Z,pe)=>{T.mutate({memberId:U,permissions:{[Z]:!pe}})},ie=U=>{switch(U){case"parent":return s.jsx(et,{variant:"default",children:"Parent"});case"guardian":return s.jsx(et,{variant:"secondary",children:"Guardian"});case"sibling":return s.jsx(et,{variant:"outline",children:"Sibling"});case"grandparent":return s.jsx(et,{variant:"outline",children:"Grandparent"});default:return s.jsx(et,{variant:"outline",children:U})}};return v?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Loading family members..."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Family Management"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage linked player profiles and permissions"})]})]})}),s.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex gap-3 flex-wrap",children:[s.jsxs($n,{open:a,onOpenChange:U=>U?o(!0):oe(),children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{"data-testid":"button-claim-player",children:[s.jsx(Wu,{className:"w-4 h-4 mr-2"}),"Find & Claim Player"]})}),s.jsxs(Qn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Claim Player Profile"}),s.jsxs(ch,{children:[h==="search"&&"Search for your child's player profile in our system",h==="request"&&"Request verification to claim this player",h==="verify"&&"Enter the verification code sent to you"]})]}),h==="search"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(qe,{"data-testid":"input-search-player",placeholder:"Search by player name...",value:d,onChange:U=>u(U.target.value),className:"flex-1"}),s.jsx(te,{variant:"outline",disabled:B,children:s.jsx(Wu,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:B?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Searching..."}):_.length>0?_.map(U=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium","data-testid":`text-player-name-${U.id}`,children:U.fullName}),s.jsxs("div",{className:"text-sm text-gray-500",children:[U.teamName&&s.jsxs("span",{className:"inline-flex items-center gap-1 mr-3",children:[s.jsx(Xp,{className:"w-3 h-3"}),U.teamName]}),U.jerseyNumber&&s.jsxs("span",{className:"inline-flex items-center gap-1 mr-3",children:[s.jsx(KE,{className:"w-3 h-3"}),"#",U.jerseyNumber]}),U.position&&s.jsx("span",{children:U.position})]})]})]}),s.jsx(te,{size:"sm",onClick:()=>O(U),"data-testid":`button-select-player-${U.id}`,children:"Select"})]},U.id)):d.length>=2?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No players found"}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:"Type to search for players"})})]}),h==="request"&&l&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 border rounded-lg bg-blue-50",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:l.fullName}),s.jsxs("div",{className:"text-sm text-gray-600",children:[l.teamName," â€¢ #",l.jerseyNumber]})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Information"}),s.jsx(qe,{"data-testid":"input-claim-contact",placeholder:"Email or phone number for verification",value:m,onChange:U=>y(U.target.value)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"We'll send a verification code to confirm you're authorized to claim this player"})]})]}),h==="verify"&&l&&s.jsx(Mr,{...b,children:s.jsxs("form",{onSubmit:b.handleSubmit(K),className:"space-y-4",children:[s.jsx("div",{className:"p-4 border rounded-lg bg-green-50",children:s.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[s.jsx(N8,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-medium",children:["Verification code sent to ",m]})]})}),s.jsx(it,{control:b.control,name:"code",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Verification Code"}),s.jsx(ut,{children:s.jsx(qe,{"data-testid":"input-verification-code",placeholder:"Enter 6-digit code",maxLength:6,...U})}),s.jsx(ft,{})]})})]})}),s.jsxs(IA,{children:[h==="search"&&s.jsx(te,{variant:"outline",onClick:oe,children:"Cancel"}),h==="request"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{variant:"outline",onClick:()=>f("search"),children:"Back"}),s.jsx(te,{onClick:V,disabled:!m||Q.isPending,"data-testid":"button-send-verification",children:Q.isPending?"Sending...":"Send Verification Code"})]}),h==="verify"&&s.jsxs(s.Fragment,{children:[s.jsx(te,{variant:"outline",onClick:()=>f("request"),children:"Back"}),s.jsx(te,{onClick:b.handleSubmit(K),disabled:!b.watch("code")||F.isPending,"data-testid":"button-claim-player-verify",children:F.isPending?"Verifying...":"Claim Player"})]})]})]})]}),s.jsxs($n,{open:r,onOpenChange:i,children:[s.jsx(ja,{asChild:!0,children:s.jsxs(te,{variant:"outline","data-testid":"button-add-member-email",children:[s.jsx(Gu,{className:"w-4 h-4 mr-2"}),"Add by Email"]})}),s.jsxs(Qn,{children:[s.jsxs(es,{children:[s.jsx(qn,{children:"Add Family Member"}),s.jsx(ch,{children:"Add a player to your family account to manage their payments and information."})]}),s.jsx(Mr,{...x,children:s.jsxs("form",{onSubmit:x.handleSubmit($),className:"space-y-4",children:[s.jsx(it,{control:x.control,name:"playerEmail",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Player Email Address"}),s.jsx(ut,{children:s.jsx(qe,{type:"email",placeholder:"player@example.com","data-testid":"input-player-email",...U})}),s.jsx(ft,{})]})}),s.jsx(it,{control:x.control,name:"relationship",render:({field:U})=>s.jsxs(rt,{children:[s.jsx(at,{children:"Relationship"}),s.jsxs(Qt,{onValueChange:U.onChange,defaultValue:U.value,children:[s.jsx(ut,{children:s.jsx(Ut,{"data-testid":"select-relationship",children:s.jsx(Mt,{placeholder:"Select relationship"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"parent",children:"Parent"}),s.jsx(xe,{value:"guardian",children:"Guardian"}),s.jsx(xe,{value:"sibling",children:"Sibling"}),s.jsx(xe,{value:"grandparent",children:"Grandparent"})]})]}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(it,{control:x.control,name:"canMakePayments",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-can-make-payments"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Can Make Payments"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow this family member to make payments for the player"})]})]})}),s.jsx(it,{control:x.control,name:"canViewReports",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-can-view-reports"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Can View Reports"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow viewing of performance reports and statistics"})]})]})}),s.jsx(it,{control:x.control,name:"emergencyContact",render:({field:U})=>s.jsxs(rt,{className:"flex flex-row items-start space-x-3 space-y-0",children:[s.jsx(ut,{children:s.jsx(js,{checked:U.value,onCheckedChange:U.onChange,"data-testid":"checkbox-emergency-contact"})}),s.jsxs("div",{className:"space-y-1 leading-none",children:[s.jsx(at,{children:"Emergency Contact"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Mark as an emergency contact for the player"})]})]})})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(te,{type:"submit",disabled:I.isPending,className:"flex-1","data-testid":"button-add-member-submit",children:I.isPending?"Adding...":"Add Member"}),s.jsx(te,{type:"button",variant:"outline",onClick:()=>i(!1),className:"flex-1",children:"Cancel"})]})]})})]})]})]}),s.jsx("div",{className:"grid gap-4",children:g.length===0?s.jsx(ye,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:s.jsxs(we,{className:"text-center py-12",children:[s.jsx(vs,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Family Members"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Add players to your family account to manage their basketball experience."}),s.jsxs(te,{onClick:()=>o(!0),"data-testid":"button-add-first-member",children:[s.jsx(Wu,{className:"h-4 w-4 mr-2"}),"Find Your First Player"]})]})}):g.map(U=>s.jsxs(ye,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:U.player.profileImageUrl?s.jsx("img",{src:U.player.profileImageUrl,alt:`${U.player.firstName} ${U.player.lastName}`,className:"w-12 h-12 rounded-full object-cover"}):s.jsx(Us,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs(Ke,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[s.jsxs("span",{"data-testid":`text-member-name-${U.id}`,children:[U.player.firstName," ",U.player.lastName]}),ie(U.relationship)]}),s.jsxs(zn,{className:"flex items-center gap-4 text-gray-600 dark:text-gray-400",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx($i,{className:"w-4 h-4"}),U.player.email]}),U.player.phoneNumber&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(bg,{className:"w-4 h-4"}),U.player.phoneNumber]}),U.player.teamId&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Xp,{className:"w-4 h-4"}),"Team Member"]}),U.player.jerseyNumber&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(KE,{className:"w-4 h-4"}),"#",U.player.jerseyNumber]}),U.player.position&&s.jsx("span",{children:U.player.position})]})]})]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>D(U.player.id,`${U.player.firstName} ${U.player.lastName}`),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","data-testid":`button-remove-member-${U.id}`,children:s.jsx(Va,{className:"w-4 h-4"})})]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3 text-gray-900 dark:text-gray-100",children:"Permissions"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Payments"})]}),s.jsx(js,{checked:U.canMakePayments,onCheckedChange:()=>ae(U.id,"canMakePayments",U.canMakePayments),disabled:T.isPending,"data-testid":`checkbox-payments-${U.id}`})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yp,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Reports"})]}),s.jsx(js,{checked:U.canViewReports,onCheckedChange:()=>ae(U.id,"canViewReports",U.canViewReports),disabled:T.isPending,"data-testid":`checkbox-reports-${U.id}`})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Emergency"})]}),s.jsx(js,{checked:U.emergencyContact,onCheckedChange:()=>ae(U.id,"emergencyContact",U.emergencyContact),disabled:T.isPending,"data-testid":`checkbox-emergency-${U.id}`})]})]})]})})})]},U.id))}),s.jsx(ye,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:s.jsxs(we,{className:"p-6",children:[s.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"How Family Management Works"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Claiming Players"}),s.jsxs("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:[s.jsx("li",{children:"â€¢ Search our player database for your child"}),s.jsx("li",{children:"â€¢ Request verification via email or phone"}),s.jsx("li",{children:"â€¢ Enter the code to claim the profile"}),s.jsx("li",{children:"â€¢ All past achievements and data transfer over"})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Family Permissions"}),s.jsxs("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:[s.jsx("li",{children:"â€¢ Payment permissions for fees and uniforms"}),s.jsx("li",{children:"â€¢ Report access for performance tracking"}),s.jsx("li",{children:"â€¢ Emergency contact notifications"}),s.jsx("li",{children:"â€¢ Multiple families supported (divorced parents)"})]})]})]})]})})]})]})}const S5e=["ðŸ‘","â¤ï¸","ðŸ˜„","ðŸŽ‰","ðŸ‘","ðŸ”¥","âš¡","ðŸ’ª"];function k5e({messageId:e,onClose:t,position:n}){const{toast:r}=Tt(),i=os(),a=ot({mutationFn:async l=>bt(`/api/messages/${e}/reactions`,{method:"POST",body:{emoji:l}}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/announcements/team"]}),t()},onError:l=>{r({title:"Failed to add reaction",description:"Please try again.",variant:"destructive"})}}),o=l=>{a.mutate(l)};return s.jsx("div",{className:"fixed z-50 bg-white border rounded-lg shadow-lg p-2 flex gap-1",style:{left:Math.min(n.x,window.innerWidth-250),top:Math.max(n.y-60,10)},children:S5e.map(l=>s.jsx(te,{variant:"ghost",size:"sm",className:"text-lg p-2 h-10 w-10 hover:bg-gray-100",onClick:()=>o(l),disabled:a.isPending,children:l},l))})}function eY({reactions:e,messageId:t,currentUserId:n}){const r=os(),{toast:i}=Tt(),a=ot({mutationFn:async c=>bt(`/api/messages/${t}/reactions`,{method:"DELETE",body:{emoji:c}}),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/announcements/team"]})},onError:c=>{i({title:"Failed to remove reaction",description:"Please try again.",variant:"destructive"})}}),o=e.reduce((c,d)=>(c[d.emoji]||(c[d.emoji]=[]),c[d.emoji].push(d),c),{}),l=c=>{var u;((u=o[c])==null?void 0:u.some(h=>h.userId===n))&&a.mutate(c)};return Object.keys(o).length===0?null:s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(o).map(([c,d])=>{const u=d.some(h=>h.userId===n);return s.jsxs(te,{variant:"outline",size:"sm",className:`text-xs h-6 px-2 ${u?"bg-blue-100 border-blue-300":"hover:bg-gray-100"}`,onClick:()=>l(c),disabled:a.isPending,children:[c," ",d.length]},c)})})}function tY({children:e,messageId:t,className:n=""}){const[r,i]=j.useState(!1),[a,o]=j.useState({x:0,y:0}),l=j.useRef(),c=j.useRef(0),d=m=>{c.current=Date.now(),m.currentTarget.getBoundingClientRect(),l.current=setTimeout(()=>{o({x:m.clientX,y:m.clientY}),i(!0),"vibrate"in navigator&&navigator.vibrate(50)},500)},u=()=>{l.current&&clearTimeout(l.current),Date.now()-c.current<500&&i(!1)},h=()=>{l.current&&clearTimeout(l.current)},f=()=>{i(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`select-none ${n}`,onPointerDown:d,onPointerUp:u,onPointerLeave:h,style:{touchAction:"manipulation"},children:e}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40",onClick:f}),s.jsx(k5e,{messageId:t,onClose:f,position:a})]})]})}function P5e(){const{teamId:e}=wy(),[,t]=Wt(),{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState("message"),[l,c]=j.useState(""),[d,u]=j.useState(""),{data:h}=Ge({queryKey:["/api/teams",e],enabled:!!e}),{data:f=[]}=Ge({queryKey:["/api/team-players",e],enabled:!!e}),{data:m=[]}=Ge({queryKey:["/api/announcements","team",e],enabled:!!e}),y=ot({mutationFn:async v=>(await bt("POST","/api/announcements",v)).json(),onSuccess:()=>{r({title:"Message sent!",description:`Your ${a} has been sent to the team.`}),c(""),u(""),o("message"),i.invalidateQueries({queryKey:["/api/announcements","team",e]}),i.refetchQueries({queryKey:["/api/announcements","team",e]})},onError:v=>{r({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),x=()=>{const v=a!=="message";if(v&&!l.trim()||!d.trim()){r({title:"Missing information",description:v?"Please enter both a title and content.":"Please enter a message.",variant:"destructive"});return}y.mutate({title:a==="message"?d.slice(0,50)+"...":l,content:d,priority:a==="task"?"high":"medium",teamId:parseInt(e)})},b=v=>{switch(v){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},g=v=>{switch(v){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return!n||n.userType!=="admin"?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/admin-dashboard"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Team Messages"}),s.jsx("p",{className:"text-sm text-gray-600",children:(h==null?void 0:h.name)||"Loading..."})]})]}),s.jsxs(et,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[s.jsx(vs,{className:"w-3 h-3 mr-1"}),f.length," Players"]})]})})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-5 h-5 text-blue-500"}),"Send Message to Team"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Message Type:"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(te,{variant:a==="message"?"default":"outline",size:"sm",onClick:()=>o("message"),className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-4 h-4"}),"Message"]}),s.jsxs(te,{variant:a==="task"?"default":"outline",size:"sm",onClick:()=>o("task"),className:"flex items-center gap-2",children:[s.jsx(Nf,{className:"w-4 h-4"}),"Task"]}),s.jsxs(te,{variant:a==="announcement"?"default":"outline",size:"sm",onClick:()=>o("announcement"),className:"flex items-center gap-2",children:[s.jsx(qu,{className:"w-4 h-4"}),"Announcement"]})]})]}),s.jsxs("div",{className:"space-y-4",children:[a!=="message"&&s.jsxs("div",{children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:[a==="task"?"Task":"Announcement"," Title"]}),s.jsx(qe,{placeholder:`Enter ${a} title...`,value:l,onChange:v=>c(v.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:a==="task"?"Task Description":a==="announcement"?"Announcement":"Message"}),s.jsx(Vs,{placeholder:"What would you like to tell the team?",value:d,onChange:v=>u(v.target.value),rows:4,className:"resize-none"})]}),s.jsxs(te,{onClick:x,disabled:y.isPending,className:"w-full",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send ",a==="task"?"Task":a==="announcement"?"Announcement":"Message"]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center justify-between",children:["Recent Team Messages",s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(et,{variant:"outline",className:"text-xs bg-blue-50",children:[s.jsx(xa,{className:"w-3 h-3 mr-1"}),"Messages"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-orange-50",children:[s.jsx(Nf,{className:"w-3 h-3 mr-1"}),"Tasks"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-green-50",children:[s.jsx(qu,{className:"w-3 h-3 mr-1"}),"Announcements"]})]})]})}),s.jsx(we,{children:m&&m.length>0?s.jsx("div",{className:"space-y-4",children:m.slice(0,10).map(v=>{const _=v.priority==="high"?"task":v.title&&v.title!==`${v.content.slice(0,50)}...`?"announcement":"message";return s.jsx(tY,{messageId:v.id,children:s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${b(_)}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[_!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[g(_),s.jsx("span",{className:"ml-1 capitalize",children:_})]}),s.jsx(et,{variant:"outline",className:"bg-blue-100 text-blue-800 text-xs",children:"Team"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:v.content}),_==="task"&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Task Completion:"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map(B=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-300 flex items-center justify-center",children:Math.random()>.5?"âœ“":""}),s.jsxs("span",{className:"text-gray-600",children:[B.firstName," ",B.lastName]})]},B.id))})]}),_==="announcement"&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Seen by:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(B=>s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${Math.random()>.5?"bg-green-500":"bg-gray-300"}`}),s.jsx("span",{className:"text-gray-600",children:B.firstName})]},B.id))})]}),s.jsx(eY,{reactions:v.reactions||[],messageId:v.id,currentUserId:"test-admin-001"}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:new Date(v.createdAt).toLocaleString()})]})},v.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No messages sent yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Your team messages will appear here"})]})})]})]})]})}function E5e(){const{teamId:e}=wy(),[,t]=Wt(),{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState("message"),[l,c]=j.useState("all"),[d,u]=j.useState(""),[h,f]=j.useState(""),[m,y]=j.useState(""),{data:x}=Ge({queryKey:["/api/teams",e],enabled:!!e}),{data:b=[]}=Ge({queryKey:["/api/team-players",e],enabled:!!e}),g=b.map(F=>({id:`parent-${F.id}`,name:`${F.firstName}'s Parent`,email:`parent.${F.firstName.toLowerCase()}@example.com`,playerName:`${F.firstName} ${F.lastName}`,playerId:F.id})),{data:v=[]}=Ge({queryKey:["/api/announcements","parents",e],enabled:!!e}),_=ot({mutationFn:async F=>(await bt("POST","/api/announcements",F)).json(),onSuccess:()=>{r({title:"Message sent!",description:`Your ${a} has been sent to ${l==="all"?"all parents":"the selected parent"}.`}),f(""),y(""),u(""),o("message"),c("all"),i.invalidateQueries({queryKey:["/api/announcements","parents",e]}),i.refetchQueries({queryKey:["/api/announcements","parents",e]})},onError:F=>{r({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),B=()=>{const F=a!=="message";if(F&&!h.trim()||!m.trim()){r({title:"Missing information",description:F?"Please enter both a title and content.":"Please enter a message.",variant:"destructive"});return}if(l==="individual"&&!d){r({title:"Select recipient",description:"Please select a parent to send the message to.",variant:"destructive"});return}_.mutate({title:a==="message"?m.slice(0,50)+"...":h,content:m,recipientId:l==="individual"?d:null,priority:a==="task"?"high":"medium",teamId:parseInt(e)})},I=F=>{switch(F){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},Q=F=>{switch(F){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return!n||n.userType!=="admin"?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/admin-dashboard"),className:"text-gray-600 hover:text-gray-900",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Parent Messages"}),s.jsx("p",{className:"text-sm text-gray-600",children:(x==null?void 0:x.name)||"Loading..."})]})]}),s.jsxs(et,{variant:"outline",className:"bg-green-50 text-green-700",children:[s.jsx(vs,{className:"w-3 h-3 mr-1"}),g.length," Parents"]})]})})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($i,{className:"w-5 h-5 text-green-500"}),"Send Message to Parents"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Message Type:"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(te,{variant:a==="message"?"default":"outline",size:"sm",onClick:()=>o("message"),className:"flex items-center gap-2",children:[s.jsx(xa,{className:"w-4 h-4"}),"Message"]}),s.jsxs(te,{variant:a==="task"?"default":"outline",size:"sm",onClick:()=>o("task"),className:"flex items-center gap-2",children:[s.jsx(Nf,{className:"w-4 h-4"}),"Task"]}),s.jsxs(te,{variant:a==="announcement"?"default":"outline",size:"sm",onClick:()=>o("announcement"),className:"flex items-center gap-2",children:[s.jsx(qu,{className:"w-4 h-4"}),"Announcement"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Send To:"}),s.jsxs("div",{className:"flex gap-3 mb-3",children:[s.jsxs(te,{variant:l==="all"?"default":"outline",size:"sm",onClick:()=>{c("all"),u("")},className:"flex items-center gap-2",children:[s.jsx(vs,{className:"w-4 h-4"}),"All Parents"]}),s.jsxs(te,{variant:l==="individual"?"default":"outline",size:"sm",onClick:()=>c("individual"),className:"flex items-center gap-2",children:[s.jsx($i,{className:"w-4 h-4"}),"Individual Parent"]})]}),l==="individual"&&s.jsxs(Qt,{value:d,onValueChange:u,children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select a parent..."})}),s.jsx(Dt,{children:g.map(F=>s.jsxs(xe,{value:F.id,children:[F.name," (",F.playerName,")"]},F.id))})]})]}),s.jsxs("div",{className:"space-y-4",children:[a!=="message"&&s.jsxs("div",{children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:[a==="task"?"Task":"Announcement"," Title"]}),s.jsx(qe,{placeholder:`Enter ${a} title...`,value:h,onChange:F=>f(F.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:a==="task"?"Task Description":a==="announcement"?"Announcement":"Message"}),s.jsx(Vs,{placeholder:`What would you like to tell the ${l==="all"?"parents":"parent"}?`,value:m,onChange:F=>y(F.target.value),rows:4,className:"resize-none"})]}),s.jsxs(te,{onClick:B,disabled:_.isPending,className:"w-full",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send ",a==="task"?"Task":a==="announcement"?"Announcement":"Message"," to ",l==="all"?"All Parents":"Selected Parent"]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Team Parents"})}),s.jsx(we,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(F=>s.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:F.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Parent of ",F.playerName]}),s.jsx("p",{className:"text-xs text-gray-500",children:F.email})]}),s.jsxs(te,{variant:"outline",size:"sm",onClick:()=>{c("individual"),u(F.id)},children:[s.jsx($i,{className:"w-3 h-3 mr-1"}),"Message"]})]})},F.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Parent Messages"})}),s.jsx(we,{children:v.length>0?s.jsx("div",{className:"space-y-4",children:v.slice(0,10).map(F=>s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${I(F.messageType||"message")}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[F.messageType!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:F.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[Q(F.messageType||"message"),s.jsx("span",{className:"ml-1 capitalize",children:F.messageType||"message"})]}),s.jsx(et,{variant:"outline",className:"bg-green-100 text-green-800 text-xs",children:"Parents"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:F.content}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(F.createdAt).toLocaleString()})]},F.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx($i,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No parent messages sent yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Your parent messages will appear here"})]})})]})]})]})}function F5e(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[r,i]=j.useState(""),{data:a}=Ge({queryKey:["/api/users",e==null?void 0:e.id,"team"],enabled:!!(e!=null&&e.id)}),{data:o=[]}=Ge({queryKey:["/api/team-players",a==null?void 0:a.id],enabled:!!(a!=null&&a.id)}),{data:l=[]}=Ge({queryKey:["/api/announcements","team",a==null?void 0:a.id],enabled:!!(a!=null&&a.id)}),c=ot({mutationFn:async x=>(await bt("POST","/api/announcements",x)).json(),onSuccess:()=>{t({title:"Message sent!",description:"Your message has been sent to the team."}),i(""),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]}),n.refetchQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:x=>{t({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),d=ot({mutationFn:async({announcementId:x,notes:b=""})=>await bt("POST",`/api/tasks/${x}/complete`,{notes:b}),onSuccess:()=>{t({title:"Task completed!",description:"You've marked this task as complete."}),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to complete task. Please try again.",variant:"destructive"})}}),u=ot({mutationFn:async x=>await bt("POST",`/api/announcements/${x}/acknowledge`,{}),onSuccess:()=>{t({title:"Acknowledged!",description:"You've acknowledged this announcement."}),n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to acknowledge. Please try again.",variant:"destructive"})}}),h=ot({mutationFn:async({messageId:x,emoji:b})=>await bt("POST",`/api/messages/${x}/reactions`,{emoji:b}),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/announcements","team",a==null?void 0:a.id]})},onError:()=>{t({title:"Error",description:"Failed to add reaction.",variant:"destructive"})}}),f=()=>{if(!r.trim()){t({title:"Missing information",description:"Please enter a message.",variant:"destructive"});return}c.mutate({title:r.slice(0,50)+"...",content:r,priority:"medium",teamId:a==null?void 0:a.id})},m=x=>{switch(x){case"task":return"border-orange-500 bg-orange-50";case"announcement":return"border-green-500 bg-green-50";default:return"border-blue-500 bg-blue-50"}},y=x=>{switch(x){case"task":return s.jsx(Nf,{className:"w-4 h-4"});case"announcement":return s.jsx(qu,{className:"w-4 h-4"});default:return s.jsx(xa,{className:"w-4 h-4"})}};return a?s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-br from-green-500 to-blue-600 safe-bottom",children:[s.jsx("header",{className:"bg-white shadow-sm border-b safe-top",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ga,{href:"/player-dashboard",children:s.jsx(te,{variant:"ghost",size:"icon",className:"mr-2",children:s.jsx(vn,{className:"h-5 w-5"})})}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 bg-blue-500",children:s.jsx(xa,{className:"h-5 w-5 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-lg font-bold text-gray-900",children:[a.name," Team Chat"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[o==null?void 0:o.length," team members"]})]})]})]}),s.jsxs(et,{variant:"outline",className:"flex items-center bg-blue-50",children:[s.jsx(vs,{className:"h-3 w-3 mr-1"}),o==null?void 0:o.length]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(ye,{className:"h-fit",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-sm flex items-center",children:[s.jsx(vs,{className:"h-4 w-4 mr-2"}),"Team Members"]})}),s.jsx(we,{className:"space-y-3",children:o.map(x=>{var b,g;return s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(wr,{className:"h-6 w-6",children:[s.jsx(Ur,{src:x.profileImageUrl}),s.jsxs(br,{className:"text-xs",children:[(b=x.firstName)==null?void 0:b[0],(g=x.lastName)==null?void 0:g[0]]})]}),s.jsxs("span",{className:"text-sm text-gray-700",children:[x.firstName," ",x.lastName,x.id===(e==null?void 0:e.id)&&s.jsx("span",{className:"text-blue-500",children:" (You)"})]})]},x.id)})})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsxs(ye,{className:"h-[600px] flex flex-col",children:[s.jsx(Ve,{className:"flex-shrink-0",children:s.jsxs(Ke,{className:"flex items-center justify-between",children:["Team Messages",s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(et,{variant:"outline",className:"text-xs bg-blue-50",children:[s.jsx(xa,{className:"w-3 h-3 mr-1"}),"Messages"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-orange-50",children:[s.jsx(Nf,{className:"w-3 h-3 mr-1"}),"Tasks"]}),s.jsxs(et,{variant:"outline",className:"text-xs bg-green-50",children:[s.jsx(qu,{className:"w-3 h-3 mr-1"}),"Announcements"]})]})]})}),s.jsxs(we,{className:"flex-1 flex flex-col p-0",children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l&&l.length>0?l.map(x=>{const b=x.priority==="high"?"task":x.title&&x.title!==`${x.content.slice(0,50)}...`?"announcement":"message";return s.jsx(tY,{messageId:x.id,children:s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${m(b)}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[b!=="message"&&s.jsx("h4",{className:"font-semibold text-gray-900",children:x.title}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[y(b),s.jsx("span",{className:"ml-1 capitalize",children:b})]}),s.jsx(et,{variant:"outline",className:"bg-blue-100 text-blue-800 text-xs",children:"Team"})]})]}),s.jsx("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:x.content}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[b==="task"&&s.jsxs(te,{size:"sm",className:"bg-green-500 hover:bg-green-600 text-white",onClick:()=>d.mutate({announcementId:x.id}),disabled:d.isPending,children:[s.jsx(vc,{className:"w-4 h-4 mr-2"}),d.isPending?"Completing...":"Mark Complete"]}),b==="announcement"&&s.jsxs(te,{size:"sm",variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>u.mutate(x.id),disabled:u.isPending,children:[s.jsx(vc,{className:"w-4 h-4 mr-2"}),u.isPending?"Acknowledging...":"Acknowledge"]}),s.jsx("div",{className:"flex gap-1",children:["ðŸ‘","â¤ï¸","ðŸ˜Š","ðŸ”¥"].map(g=>s.jsx(te,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:()=>h.mutate({messageId:x.id,emoji:g}),disabled:h.isPending,children:g},g))})]}),b==="announcement"&&s.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Acknowledgment:"}),s.jsx(et,{variant:Math.random()>.5?"default":"outline",className:"text-xs",children:Math.random()>.5?s.jsxs(s.Fragment,{children:[s.jsx(vc,{className:"w-3 h-3 mr-1"}),"Seen"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"w-3 h-3 mr-1"}),"Not Seen"]})})]})}),s.jsx(eY,{reactions:x.reactions||[],messageId:x.id,currentUserId:e==null?void 0:e.id}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:Yn(new Date(x.createdAt),"MMM d, h:mm a")})]})},x.id)}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No messages yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Team messages will appear here"})]})}),s.jsx("div",{className:"border-t p-4 flex-shrink-0",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Vs,{placeholder:"Type your message to the team...",value:r,onChange:x=>i(x.target.value),rows:3,className:"resize-none"}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Share updates with your team"}),s.jsxs(te,{onClick:f,disabled:!r.trim()||c.isPending,className:"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700",children:[s.jsx(By,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})})]})]})})]})})]}):s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-green-500 to-blue-600 safe-bottom flex items-center justify-center",children:s.jsx(ye,{className:"p-8 text-center",children:s.jsxs(we,{children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"No Team Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You need to be assigned to a team to access team chat."}),s.jsx(ga,{href:"/player-dashboard",children:s.jsx(te,{children:"Back to Dashboard"})})]})})})}const T5e=Pc.isNativePlatform()?"https://boxstat.replit.app":"";function nY(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${T5e}${e}`}const I5e="BAlEnlAUbQITSjTIQoxGppFw8lDmp6qKlvlySV264DR0ddNHKiCYbqsL171T8IctkpZczKOVG3Voms8CFL2PsD0";function L5e(e){const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let a=0;a<r.length;++a)i[a]=r.charCodeAt(a);return i}const Xy=()=>Pc.isNativePlatform()?!1:"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,U5e=async()=>{if(!Xy())throw new Error("Web push notifications are not supported in this browser");const e=await Notification.requestPermission();return console.log("ðŸ”” Notification permission:",e),e},D5e=async()=>{if(!Xy())throw new Error("Web push notifications are not supported in this browser");if(await U5e()!=="granted")throw new Error("Notification permission denied");let t=await navigator.serviceWorker.getRegistration();t||(console.log("ðŸ“ Registering service worker..."),t=await navigator.serviceWorker.register("/sw.js"),console.log("âœ… Service worker registered")),await navigator.serviceWorker.ready;let n=await t.pushManager.getSubscription();return n?console.log("âœ… Already subscribed to push notifications"):(console.log("ðŸ“± Subscribing to push notifications..."),n=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:L5e(I5e)}),console.log("âœ… Subscribed to push notifications")),await R5e(n),n},Q5e=async()=>{if(!Xy())return;const e=await navigator.serviceWorker.getRegistration();if(!e)return;const t=await e.pushManager.getSubscription();t&&(await t.unsubscribe(),console.log("ðŸ”• Unsubscribed from push notifications"),await O5e(t))},M5e=async()=>{if(!Xy())return null;const e=await navigator.serviceWorker.getRegistration();return e?await e.pushManager.getSubscription():null};async function R5e(e){var r,i;const t=e.toJSON(),n=await fetch(nY("/api/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({endpoint:t.endpoint,keys:{p256dh:(r=t.keys)==null?void 0:r.p256dh,auth:(i=t.keys)==null?void 0:i.auth},userAgent:navigator.userAgent,deviceType:"desktop"})});if(!n.ok){const a=await n.text();throw console.error("âŒ Failed to send subscription to backend:",n.status,a),new Error("Failed to register push subscription with server")}console.log("âœ… Push subscription registered with backend")}async function O5e(e){const t=e.toJSON();(await fetch(nY("/api/notifications/unsubscribe"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({endpoint:t.endpoint})})).ok?console.log("âœ… Push subscription removed from backend"):console.error("âŒ Failed to remove subscription from backend")}function H5e(){const[e,t]=j.useState(!1),[n,r]=j.useState(!1),[i,a]=j.useState(!1),{toast:o}=Tt();j.useEffect(()=>{(async()=>{const d=Xy();if(a(d),d){const u=await M5e();t(!!u)}})()},[]);const l=async()=>{if(!i){o({variant:"destructive",title:"Not Supported",description:"Push notifications are not supported in this browser"});return}r(!0);try{e?(await Q5e(),t(!1),o({title:"Unsubscribed",description:"You will no longer receive browser push notifications"})):(await D5e(),t(!0),o({title:"Subscribed!",description:"You will now receive push notifications in your browser"}))}catch(c){console.error("Push notification error:",c),o({variant:"destructive",title:"Error",description:c instanceof Error?c.message:"Failed to toggle push notifications"})}finally{r(!1)}};return i?s.jsx(te,{variant:e?"outline":"default",size:"sm",onClick:l,disabled:n,"data-testid":e?"button-unsubscribe-push":"button-subscribe-push",children:n?s.jsx(Nc,{className:"h-4 w-4 animate-spin"}):e?s.jsxs(s.Fragment,{children:[s.jsx(Ane,{className:"h-4 w-4 mr-2"}),"Disable Browser Notifications"]}):s.jsxs(s.Fragment,{children:[s.jsx(Pi,{className:"h-4 w-4 mr-2"}),"Enable Browser Notifications"]})}):null}const bB="#d82428",V5e=["High School Elite","High School Red","High School Black","Youth Girls","14U Black","14U Red","14U White","12U Black","12U Red","12U White","10U Black","10U Red"],K5e=["9","10","11","12","13","14","15","16","17","18"],z5e=[`4'4"`,`4'5"`,`4'6"`,`4'7"`,`4'8"`,`4'9"`,`4'10"`,`4'11"`,`5'0"`,`5'1"`,`5'2"`,`5'3"`,`5'4"`,`5'5"`,`5'6"`,`5'7"`,`5'8"`,`5'9"`,`5'10"`,`5'11"`,`6'0"`,`6'1"`,`6'2"`,`6'3"`,`6'4"`,`6'5"`,`6'6"`,`6'7"`,`6'8"`,`6'9"`,`6'10"`],$5e=["Point Guard","Shooting Guard","Small Forward","Power Forward","Center"],q5e=Array.from({length:99},(e,t)=>(t+1).toString());function W5e(){const[e,t]=Wt(),[n,r]=j.useState("profile");return j.useEffect(()=>{try{if(typeof window>"u")return;const o=new URL(window.location.href).searchParams.get("tab");o&&["profile","privacy","notifications","security","connections","billing","devices","legal","danger"].includes(o)?r(o):r("profile")}catch{r("profile")}},[e]),[n,a=>{r(a),t(`/settings?tab=${a}`)}]}function DA({icon:e,title:t,subtitle:n}){return s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center",style:{background:"#fee2e2"},children:s.jsx(e,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t}),n&&s.jsx("p",{className:"text-sm text-gray-500",children:n})]})]})}function G5e({value:e,onChange:t}){const[n,r]=j.useState(e||"");return s.jsx("div",{className:"relative",children:s.jsx(qe,{placeholder:"City",value:n,onChange:i=>{r(i.target.value),t(i.target.value)}})})}function Z5e({open:e,onOpenChange:t}){const{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState((n==null?void 0:n.email)||""),l=ot({mutationFn:async()=>{const c=await fetch("/api/account/change-email",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:a})});if(!c.ok)throw new Error("Failed to change email");return c.json()},onSuccess:()=>{r({title:"Email updated",description:"Please verify your new email."}),i.invalidateQueries({queryKey:["/api/users",n==null?void 0:n.id]}),t(!1)},onError:c=>r({title:"Could not update email",description:String(c),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Change Email"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(qe,{value:a,onChange:c=>o(c.target.value),placeholder:"you@example.com"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Weâ€™ll send a verification link to your new address."})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),s.jsx(te,{onClick:()=>l.mutate(),disabled:l.isPending,children:l.isPending?"Saving...":"Save"})]})]})})}function Y5e({open:e,onOpenChange:t}){const{toast:n}=Tt(),[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(""),d=ot({mutationFn:async()=>{if(a!==l)throw new Error("Passwords do not match");const u=await fetch("/api/account/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({current:r,next:a})});if(!u.ok)throw new Error("Failed to change password");return u.json()},onSuccess:()=>{n({title:"Password updated",description:"Your password has been changed."}),t(!1),i(""),o(""),c("")},onError:u=>n({title:"Could not change password",description:String(u),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Change Password"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(qe,{type:"password",placeholder:"Current password",value:r,onChange:u=>i(u.target.value)}),s.jsx(qe,{type:"password",placeholder:"New password",value:a,onChange:u=>o(u.target.value)}),s.jsx(qe,{type:"password",placeholder:"Confirm new password",value:l,onChange:u=>c(u.target.value)})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),s.jsx(te,{onClick:()=>d.mutate(),disabled:d.isPending,children:d.isPending?"Saving...":"Save"})]})]})})}function X5e({open:e,onOpenChange:t}){const{toast:n}=Tt(),[r,i]=j.useState(!1),a=ot({mutationFn:async o=>{const l=await fetch("/api/account/2fa",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({enable:o})});if(!l.ok)throw new Error("Failed to update 2FA");return l.json()},onSuccess:()=>{n({title:"Two-factor updated"}),t(!1)},onError:o=>n({title:"Could not update 2FA",description:String(o),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Two-Factor Authentication"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Add an extra layer of security to your account. Use an authenticator app to generate one-time codes."}),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"Enable 2FA"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Use an authenticator app (TOTP)"})]}),s.jsx(cn,{checked:r,onCheckedChange:i})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Close"}),s.jsx(te,{onClick:()=>a.mutate(r),children:r?"Enable":"Disable"})]})]})})}function J5e({open:e,onOpenChange:t}){const{user:n}=dn(),{toast:r}=Tt(),i=os(),[a,o]=j.useState(""),[l,c]=j.useState(""),[d,u]=j.useState(!1);j.useEffect(()=>{n&&(n!=null&&n.passcode)&&u(!0)},[n]);const h=(y,x)=>{const b=y.replace(/\D/g,"").slice(0,4);x(b)},f=ot({mutationFn:async()=>{if(a.length!==4)throw new Error("Passcode must be 4 digits");if(a!==l)throw new Error("Passcodes do not match");const y=await fetch(`/api/users/${n==null?void 0:n.id}/passcode`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({passcode:a})});if(!y.ok)throw new Error("Failed to set passcode");return y.json()},onSuccess:()=>{r({title:"Passcode set",description:"Your 4-digit passcode has been saved."}),i.invalidateQueries({queryKey:["/api/auth/user"]}),o(""),c(""),u(!0),t(!1)},onError:y=>r({title:"Could not set passcode",description:String(y),variant:"destructive"})}),m=ot({mutationFn:async()=>{const y=await fetch(`/api/users/${n==null?void 0:n.id}/passcode`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(!y.ok)throw new Error("Failed to remove passcode");return y.json()},onSuccess:()=>{r({title:"Passcode removed",description:"Your passcode has been removed."}),i.invalidateQueries({queryKey:["/api/auth/user"]}),u(!1),t(!1)},onError:y=>r({title:"Could not remove passcode",description:String(y),variant:"destructive"})});return s.jsx($n,{open:e,onOpenChange:t,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Profile Passcode"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:d?"You have a passcode set for profile switching. You can update it or remove it.":"Set a 4-digit passcode to secure profile switching. You'll need to enter this code when switching between profiles."}),!d&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"New Passcode"}),s.jsx(qe,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter 4 digits",value:a,onChange:y=>h(y.target.value,o),maxLength:4,"data-testid":"input-passcode"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Confirm Passcode"}),s.jsx(qe,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter 4 digits again",value:l,onChange:y=>h(y.target.value,c),maxLength:4,"data-testid":"input-confirm-passcode"})]})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),d?s.jsx(te,{variant:"destructive",onClick:()=>m.mutate(),disabled:m.isPending,"data-testid":"button-remove-passcode",children:m.isPending?"Removing...":"Remove Passcode"}):s.jsx(te,{onClick:()=>f.mutate(),disabled:f.isPending||a.length!==4||l.length!==4,"data-testid":"button-set-passcode",children:f.isPending?"Setting...":"Set Passcode"})]})]})})}function XL(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),{data:r}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[i,a]=j.useState({firstName:"",lastName:"",teamName:"",age:"",height:"",location:"",position:"",jerseyNumber:""});j.useEffect(()=>{var l;r&&a({firstName:r.firstName||"",lastName:r.lastName||"",teamName:r.teamId||"",age:(e==null?void 0:e.age)||"",height:(e==null?void 0:e.height)||"",location:r.address||"",position:r.position||"",jerseyNumber:((l=r.jerseyNumber)==null?void 0:l.toString())||""})},[r,e]);const o=ot({mutationFn:async l=>{const c={firstName:l.firstName,lastName:l.lastName,address:l.location,teamName:l.teamName,age:l.age,height:l.height,position:l.position,jerseyNumber:l.jerseyNumber?parseInt(l.jerseyNumber):null},d=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!d.ok)throw new Error("Failed to save profile");return d.json()},onSuccess:l=>{var c;t({title:"Profile updated",description:"Changes saved successfully."}),l&&a({firstName:l.firstName||"",lastName:l.lastName||"",teamName:l.teamId||"",age:(e==null?void 0:e.age)||"",height:(e==null?void 0:e.height)||"",location:l.address||"",position:l.position||"",jerseyNumber:((c=l.jerseyNumber)==null?void 0:c.toString())||""}),n.invalidateQueries({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]})},onError:l=>t({title:"Save failed",description:String(l),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Us,title:"Profile Information",subtitle:"Update your basic details and team info."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"space-y-5 p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Name"}),s.jsx(qe,{value:i.firstName,onChange:l=>a(c=>({...c,firstName:l.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx(qe,{value:i.lastName,onChange:l=>a(c=>({...c,lastName:l.target.value}))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Team"}),s.jsxs(Qt,{value:i.teamName,onValueChange:l=>a(c=>({...c,teamName:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select team"})}),s.jsx(Dt,{children:V5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Age"}),s.jsxs(Qt,{value:i.age,onValueChange:l=>a(c=>({...c,age:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select age"})}),s.jsx(Dt,{children:K5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Height"}),s.jsxs(Qt,{value:i.height,onValueChange:l=>a(c=>({...c,height:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select height"})}),s.jsx(Dt,{children:z5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Position"}),s.jsxs(Qt,{value:i.position,onValueChange:l=>a(c=>({...c,position:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select position"})}),s.jsx(Dt,{children:$5e.map(l=>s.jsx(xe,{value:l,children:l},l))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jersey Number"}),s.jsxs(Qt,{value:i.jerseyNumber,onValueChange:l=>a(c=>({...c,jerseyNumber:l})),children:[s.jsx(Ut,{children:s.jsx(Mt,{placeholder:"Select number"})}),s.jsx(Dt,{children:q5e.map(l=>s.jsxs(xe,{value:l,children:["#",l]},l))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),s.jsx(G5e,{value:i.location,onChange:l=>a(c=>({...c,location:l}))})]}),s.jsx("div",{className:"pt-2",children:s.jsx(te,{className:"w-full sm:w-auto",onClick:()=>o.mutate(i),disabled:o.isPending,children:o.isPending?"Saving...":"Save Changes"})})]})})]})}function eBe(){const{user:e}=dn(),{toast:t}=Tt(),[n,r]=j.useState({makeProfilePublic:!0,showProfileToTeamOnly:!1,allowGpsCheckin:!0,allowCameraMic:!0,shareAnalytics:!0}),i=ot({mutationFn:async()=>{const a=await fetch(`/api/privacy/${e==null?void 0:e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update privacy");return a.json()},onSuccess:()=>t({title:"Privacy updated"}),onError:a=>t({title:"Could not update",description:String(a),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Fi,title:"Privacy & Permissions",subtitle:"Control visibility and device permissions."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[[{k:"makeProfilePublic",label:"Make profile public",icon:_y},{k:"showProfileToTeamOnly",label:"Show profile to team only",icon:$w},{k:"allowGpsCheckin",label:"Allow GPS-based on-site check-in",icon:Yi},{k:"allowCameraMic",label:"Allow camera & microphone for uploads",icon:$w},{k:"shareAnalytics",label:"Share anonymized usage analytics",icon:$w}].map(a=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(a.icon,{className:"h-5 w-5 text-gray-600"}),s.jsx("div",{className:"text-sm",children:a.label})]}),s.jsx(cn,{checked:n[a.k],onCheckedChange:o=>r(l=>({...l,[a.k]:o}))})]},a.k)),s.jsx("div",{className:"pt-2",children:s.jsx(te,{onClick:()=>i.mutate(),disabled:i.isPending,children:i.isPending?"Saving...":"Save Preferences"})})]})}),s.jsxs(ye,{className:"bg-transparent border-0 shadow-none",children:[s.jsx(Ve,{className:"px-6",children:s.jsx(Ke,{className:"text-base",children:"Blocked Users"})}),s.jsx(we,{className:"p-6",children:s.jsx("div",{className:"text-sm text-gray-500",children:"No blocked users."})})]})]})}function tBe(){const{toast:e}=Tt(),[t,n]=j.useState({pushTeamMessages:!0,pushEventReminders:!0,pushCheckinWindows:!0,pushProgramUpdates:!1,quietHours:!1}),r=ot({mutationFn:async()=>{const i=await fetch("/api/notifications/prefs",{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to update notifications");return i.json()},onSuccess:()=>e({title:"Notification settings saved"}),onError:i=>e({title:"Could not save",description:String(i),variant:"destructive"})});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Pi,title:"Notifications",subtitle:"Choose how you want to be notified."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(PC,{title:"Browser Push Notifications",children:s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable push notifications in your browser to receive real-time updates"}),s.jsx(H5e,{})]})}),s.jsx(Fl,{}),s.jsxs(PC,{title:"Push Notifications",children:[s.jsx(wu,{label:"Team messages",checked:t.pushTeamMessages,onChange:i=>n(a=>({...a,pushTeamMessages:i}))}),s.jsx(wu,{label:"Event reminders",checked:t.pushEventReminders,onChange:i=>n(a=>({...a,pushEventReminders:i}))}),s.jsx(wu,{label:"Check-in/RSVP windows",checked:t.pushCheckinWindows,onChange:i=>n(a=>({...a,pushCheckinWindows:i}))}),s.jsx(wu,{label:"Program updates",checked:t.pushProgramUpdates,onChange:i=>n(a=>({...a,pushProgramUpdates:i}))})]}),s.jsx(Fl,{}),s.jsx(PC,{title:"Preferences",children:s.jsx(wu,{label:"Quiet hours (10pmâ€“7am)",checked:t.quietHours,onChange:i=>n(a=>({...a,quietHours:i}))})}),s.jsx("div",{className:"pt-2",children:s.jsx(te,{onClick:()=>r.mutate(),disabled:r.isPending,children:r.isPending?"Saving...":"Save Notification Settings"})})]})})]})}function nBe(){const[e,t]=j.useState(!1),[n,r]=j.useState(!1),[i,a]=j.useState(!1),[o,l]=j.useState(!1);Wt();const c=async()=>{try{await fetch("/api/logout",{method:"GET",credentials:"include"}),window.location.href="/"}catch(d){console.error("Logout error:",d),window.location.href="/"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:Fi,title:"Account & Security",subtitle:"Manage login and security."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(uA,{icon:jh,title:"Profile Passcode",action:s.jsx(te,{variant:"outline",onClick:()=>l(!0),children:"Set"})}),s.jsx(uA,{icon:$i,title:"Change email",action:s.jsx(te,{variant:"outline",onClick:()=>t(!0),children:"Update"})}),s.jsx(uA,{icon:b8,title:"Change password",action:s.jsx(te,{variant:"outline",onClick:()=>r(!0),children:"Update"})}),s.jsx(uA,{icon:wne,title:"Two-factor authentication (2FA)",action:s.jsx(te,{variant:"outline",onClick:()=>a(!0),children:"Manage"})}),s.jsx(uA,{icon:Hb,title:"Log Out",action:s.jsx(te,{variant:"destructive",onClick:c,children:"Log Out"})}),s.jsx(uA,{icon:Hb,title:"Sign out of all devices",action:s.jsx(te,{variant:"destructive",children:"Sign out all"})})]})}),s.jsx(Z5e,{open:e,onOpenChange:t}),s.jsx(Y5e,{open:n,onOpenChange:r}),s.jsx(X5e,{open:i,onOpenChange:a}),s.jsx(J5e,{open:o,onOpenChange:l})]})}function sBe(){const{toast:e}=Tt(),{user:t}=dn(),n=os(),[r,i]=j.useState(!0),[a,o]=j.useState((t==null?void 0:t.email)||""),[l,c]=j.useState(!1),{data:d}=Ge({queryKey:["/api/auth/user"],queryFn:async()=>{const b=await fetch("/api/auth/user",{credentials:"include"});if(!b.ok)throw new Error("Failed to fetch user");return b.json()}}),u=!!(d!=null&&d.linkedAccountId),h=ot({mutationFn:async b=>{const g=await fetch("/api/settings/link-account",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:b})});if(!g.ok){const v=await g.json();throw new Error(v.message||"Failed to link account")}return g.json()},onSuccess:b=>{e({title:"Account Linked!",description:`Successfully linked to ${b.account.email}. ${b.profiles.length} profile(s) loaded.`}),c(!1),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/profiles/me"]})},onError:b=>{e({title:"Link Failed",description:b.message,variant:"destructive"})}}),f=ot({mutationFn:async()=>{const b=await fetch("/api/settings/unlink-account",{method:"POST",credentials:"include"});if(!b.ok){const g=await b.json();throw new Error(g.message||"Failed to unlink account")}return b.json()},onSuccess:()=>{e({title:"Account Unlinked",description:"Your account has been unlinked successfully."}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/profiles/me"]})},onError:b=>{e({title:"Unlink Failed",description:b.message,variant:"destructive"})}}),m=()=>{if(!a||!a.trim()){e({title:"Email Required",description:"Please enter your email address",variant:"destructive"});return}h.mutate(a)},y=async()=>{try{window.location.href="/api/connections/google/start"}catch(b){e({title:"Connection failed",description:String(b),variant:"destructive"})}},x=async()=>{try{if(!(await fetch("/api/connections/google/disconnect",{method:"POST",credentials:"include"})).ok)throw new Error("Disconnect failed");i(!1),e({title:"Disconnected Google Calendar"})}catch(b){e({title:"Could not disconnect",description:String(b),variant:"destructive"})}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:cj,title:"Connections",subtitle:"Link your program account and connect calendars."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-lg bg-red-50 flex items-center justify-center",children:s.jsx(vs,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"BoxStat Account"}),s.jsx("div",{className:"text-xs text-gray-500",children:u?"Linked - Profile data synced":"Not linked - Link to access your program data"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:u?s.jsx(te,{variant:"ghost",onClick:()=>f.mutate(),disabled:f.isPending,"data-testid":"button-unlink-account",children:f.isPending?"Unlinking...":"Unlink"}):s.jsx(te,{onClick:()=>c(!0),"data-testid":"button-link-account",children:"Link Account"})})]}),s.jsx(Fl,{}),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-lg bg-red-50 flex items-center justify-center",children:s.jsx(dr,{className:"h-5 w-5",style:{color:bB}})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:"Google Calendar"}),s.jsx("div",{className:"text-xs text-gray-500",children:r?"Connected":"Not connected"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:r?s.jsxs(s.Fragment,{children:[s.jsxs(te,{variant:"outline",onClick:()=>window.location.href="/api/connections/google/manage",children:["Manage ",s.jsx(xA,{className:"h-4 w-4 ml-1"})]}),s.jsx(te,{variant:"ghost",onClick:x,children:"Disconnect"})]}):s.jsx(te,{onClick:y,children:"Connect"})})]}),s.jsxs("div",{className:"rounded-lg p-3 hover:bg-gray-50",children:[s.jsx("div",{className:"text-sm font-medium mb-1",children:"Sync options"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[s.jsx(wu,{label:"Team events",defaultChecked:!0}),s.jsx(wu,{label:"Games",defaultChecked:!0}),s.jsx(wu,{label:"Practices",defaultChecked:!0})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Your team tags determine which events appear in your in-app calendar."})]})]})}),s.jsx($n,{open:l,onOpenChange:c,children:s.jsxs(Qn,{children:[s.jsx(es,{children:s.jsx(qn,{children:"Link Your Program Account"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Enter your email to link your account and automatically load your profile information from the program database."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Email Address"}),s.jsx(qe,{type:"email",placeholder:"your@email.com",value:a,onChange:b=>o(b.target.value),disabled:h.isPending,"data-testid":"input-link-email"}),s.jsx("p",{className:"text-xs text-gray-500",children:"This must be the email you used when registering for the program."})]})]}),s.jsxs(IA,{children:[s.jsx(te,{variant:"outline",onClick:()=>c(!1),disabled:h.isPending,children:"Cancel"}),s.jsx(te,{onClick:m,disabled:h.isPending,"data-testid":"button-confirm-link",children:h.isPending?"Linking...":"Link Account"})]})]})})]})}function rBe(){return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:ba,title:"Subscription & Billing",subtitle:"Manage your plan and payment methods."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Current plan"}),s.jsx("div",{className:"text-base font-semibold",children:"Foundation Program â€” Monthly"})]}),s.jsx(et,{className:"bg-emerald-100 text-emerald-700",children:"Active"})]}),s.jsx(Fl,{}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Next charge: ",s.jsx("span",{className:"font-medium",children:"$29 on the 15th"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{variant:"outline",onClick:()=>window.location.href="/billing",children:"Manage"}),s.jsx(te,{className:"bg-gray-900 text-white hover:bg-black",children:"Update card"})]})]})]})})]})}function iBe(){const{data:e=[]}=Ge({queryKey:["/api/sessions"],queryFn:async()=>{const t=await fetch("/api/sessions",{credentials:"include"});return t.ok?t.json():[]}});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:BA,title:"Devices & Sessions",subtitle:"Manage where you're signed in."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-3",children:[e.length===0&&s.jsx("div",{className:"text-sm text-gray-500",children:"No active sessions."}),e.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"font-medium",children:t.device||"Unknown device"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[t.location||"â€”"," â€¢ ",t.lastActive?new Date(t.lastActive).toLocaleString():"Now"]})]}),s.jsx(te,{variant:"outline",size:"sm",children:"Sign out"})]},t.id))]})})]})}function aBe(){return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:wo,title:"Legal & Data",subtitle:"Export your data or review policies."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsxs(we,{className:"p-6 space-y-4",children:[s.jsx(uA,{icon:wo,title:"Export my data",action:s.jsx(te,{variant:"outline",children:"Export"})}),s.jsx(uA,{icon:xA,title:"Privacy Policy",action:s.jsx(te,{variant:"ghost",children:"Open"})}),s.jsx(uA,{icon:xA,title:"Terms of Service",action:s.jsx(te,{variant:"ghost",children:"Open"})})]})})]})}function oBe(){const{user:e,logout:t}=dn(),{toast:n}=Tt(),[r,i]=j.useState(!1),[a,o]=j.useState(""),[l,c]=j.useState(!1),d=(e==null?void 0:e.email)||"",u=(e==null?void 0:e.role)||"",h=async()=>{if(a!==d){n({title:"Email doesn't match",description:"Please enter your email exactly as shown.",variant:"destructive"});return}c(!0);try{const f=await fetch("/api/account/delete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmEmail:a})});if(f.ok)n({title:"Account deleted",description:"Your account has been deactivated successfully."}),t(),window.location.href="/";else{const m=await f.json();n({title:"Delete failed",description:m.message||"Could not delete account.",variant:"destructive"})}}catch{n({title:"Delete failed",description:"An error occurred. Please try again.",variant:"destructive"})}finally{c(!1)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(DA,{icon:qi,title:"Danger Zone",subtitle:"Irreversible actions."}),s.jsx(ye,{className:"bg-transparent border-0 shadow-none",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-red-700",children:"Delete account"}),s.jsxs("div",{className:"text-xs text-red-600",children:["Your account will be deactivated and data removed.",(u==="parent"||u==="admin")&&" This includes all linked player profiles."]})]}),s.jsx(te,{variant:"destructive",onClick:()=>i(!0),"data-testid":"button-delete-account",children:"Delete"})]})})}),s.jsx($n,{open:r,onOpenChange:i,children:s.jsxs(Qn,{className:"max-w-md",children:[s.jsx(es,{children:s.jsxs(qn,{className:"text-red-600 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Delete Your Account"]})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-red-800 font-medium mb-2",children:"This action cannot be undone!"}),s.jsxs("ul",{className:"text-xs text-red-700 list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Your account will be deactivated"}),s.jsx("li",{children:"Your login credentials will be removed"}),(u==="parent"||u==="admin")&&s.jsx("li",{children:"All linked player profiles will also be deactivated"}),s.jsx("li",{children:"Any active subscriptions will be cancelled"}),s.jsx("li",{children:"You will lose access to all features and history"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"To confirm, please type your email address:"}),s.jsx("p",{className:"text-sm font-mono bg-gray-100 p-2 rounded",children:d}),s.jsx(qe,{type:"email",placeholder:"Enter your email to confirm",value:a,onChange:f=>o(f.target.value),className:"border-red-200 focus:border-red-500","data-testid":"input-confirm-email"})]})]}),s.jsxs(IA,{className:"gap-2",children:[s.jsx(te,{variant:"outline",onClick:()=>{i(!1),o("")},disabled:l,"data-testid":"button-cancel-delete",children:"Cancel"}),s.jsx(te,{variant:"destructive",onClick:h,disabled:l||a!==d,"data-testid":"button-confirm-delete",children:l?"Deleting...":"Permanently Delete Account"})]})]})})]})}function PC({title:e,children:t}){return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-800",children:e}),s.jsx("div",{className:"space-y-2",children:t})]})}function wu({label:e,checked:t,onChange:n,defaultChecked:r}){const[i,a]=j.useState(t??!!r);return j.useEffect(()=>{t!==void 0&&a(t)},[t]),s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsx("div",{className:"text-sm",children:e}),s.jsx(cn,{checked:i,onCheckedChange:o=>{a(o),n==null||n(o)}})]})}function uA({icon:e,title:t,action:n}){return s.jsxs("div",{className:"flex items-center justify-between rounded-lg p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(e,{className:"h-5 w-5 text-gray-600"}),s.jsx("div",{className:"text-sm",children:t})]}),n]})}function lBe(e){switch(e){case"profile":return s.jsx(XL,{});case"privacy":return s.jsx(eBe,{});case"notifications":return s.jsx(tBe,{});case"security":return s.jsx(nBe,{});case"connections":return s.jsx(sBe,{});case"billing":return s.jsx(rBe,{});case"devices":return s.jsx(iBe,{});case"legal":return s.jsx(aBe,{});case"danger":return s.jsx(oBe,{});default:return s.jsx(XL,{})}}function cBe(){const{user:e}=dn(),[,t]=Wt(),[n,r]=W5e(),i=[{key:"profile",label:"Profile",icon:Us},{key:"privacy",label:"Privacy & Permissions",icon:Fi},{key:"notifications",label:"Notifications",icon:Pi},{key:"security",label:"Account & Security",icon:$w},{key:"connections",label:"Connections",icon:cj},{key:"billing",label:"Billing",icon:ba},{key:"devices",label:"Devices",icon:BA},{key:"legal",label:"Legal & Data",icon:wo},{key:"danger",label:"Danger Zone",icon:qi}];return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white/70 backdrop-blur border-b border-gray-200 px-4 py-4 sticky top-0 z-10 safe-top",children:s.jsx("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>t("/player-dashboard"),className:"h-8 w-8",children:s.jsx(vn,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Settings"}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Signed in as ",e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]})]})]})})}),s.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-6 p-4",children:[s.jsx("aside",{className:"md:col-span-1",children:s.jsx("nav",{className:"rounded-xl p-2",children:i.map(a=>{const o=n===a.key;return s.jsxs("button",{onClick:()=>r(a.key),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${o?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100"}`,"aria-current":o?"page":void 0,children:[s.jsx(a.icon,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:a.label})]},a.key)})})}),s.jsx("main",{className:"md:col-span-3",children:s.jsx("div",{className:"rounded-xl",children:lBe(n)})})]})]})}function dBe(){const[,e]=Wt(),[t,n]=Ft.useState(!1);Ft.useEffect(()=>{const i=()=>{const a=localStorage.getItem("deviceLockedToPlayer"),o=localStorage.getItem("selectedPlayerId");n(a===o&&a!==null)};return i(),window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)},[]);const r=[{key:"profile",icon:Us,label:"Player Profile",description:"Basketball info and personal details",path:"/player-settings/profile"},{key:"privacy",icon:_y,label:"Privacy",description:"Control your visibility and data sharing",path:"/player-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/player-settings/notifications"},{key:"security",icon:Fi,label:"Account & Security",description:"Password and device management",path:"/player-settings/security"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/player-settings/legal"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Player Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:r.map(i=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(i.path),"data-testid":`settings-item-${i.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(i.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:i.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},i.key))})]})})}function ABe(){const[,e]=Wt(),t=[{key:"profile",icon:Us,label:"Profile",description:"Personal information and contact details",path:"/coach-settings/profile"},{key:"privacy",icon:Fi,label:"Privacy",description:"Control your visibility and data sharing",path:"/coach-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/coach-settings/notifications"},{key:"security",icon:b8,label:"Security",description:"Password and account management",path:"/coach-settings/security"},{key:"connections",icon:cj,label:"Connections",description:"External apps and integrations",path:"/coach-settings/connections"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/coach-settings/legal"},{key:"danger",icon:qi,label:"Account Actions",description:"Delete account and danger zone",path:"/coach-settings/danger"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/coach-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Coach Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:t.map(n=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(n.path),"data-testid":`settings-item-${n.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(n.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:n.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},n.key))})]})})}function uBe(){const[,e]=Wt(),t=[{key:"profile",icon:Us,label:"Profile",description:"Personal information and preferences",path:"/parent-settings/profile"},{key:"privacy",icon:_y,label:"Privacy",description:"Control your visibility and data sharing",path:"/parent-settings/privacy"},{key:"notifications",icon:Pi,label:"Notifications",description:"Manage alerts and communications",path:"/parent-settings/notifications"},{key:"security",icon:Fi,label:"Account & Security",description:"Password, 2FA, and device management",path:"/parent-settings/security"},{key:"connections",icon:cj,label:"Connections",description:"Connected apps and services",path:"/parent-settings/connections"},{key:"legal",icon:wo,label:"Legal",description:"Terms, privacy policy, and agreements",path:"/parent-settings/legal"},{key:"danger",icon:qi,label:"Danger Zone",description:"Account deletion and irreversible actions",path:"/parent-settings/danger"}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 safe-top",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/parent-dashboard"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-dashboard",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Parent Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage your profile and preferences"})]})]})}),s.jsx("div",{className:"p-6 space-y-3",children:t.map(n=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>e(n.path),"data-testid":`settings-item-${n.key}`,children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:s.jsx(n.icon,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:n.label}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.description})]}),s.jsx(Gs,{className:"h-5 w-5 text-gray-400"})]})})},n.key))})]})})}function Um({className:e,...t}){return s.jsx("div",{className:_t("animate-pulse rounded-md bg-muted",e),...t})}const JL={Prospect:"bg-gray-500",Starter:"bg-green-500",AllStar:"bg-blue-500",Superstar:"bg-purple-500",HallOfFame:"bg-yellow-500"},hBe={Prospect:"text-gray-600 dark:text-gray-400",Starter:"text-green-600 dark:text-green-400",AllStar:"text-blue-600 dark:text-blue-400",Superstar:"text-purple-600 dark:text-purple-400",HallOfFame:"text-yellow-600 dark:text-yellow-400"},fBe={Prospect:"border-gray-500",Starter:"border-green-500",AllStar:"border-blue-500",Superstar:"border-purple-500",HallOfFame:"border-yellow-500"};function mBe(){const{user:e}=dn(),{currentChildProfile:t}=LS(),[,n]=Wt(),[r,i]=j.useState("all"),[a,o]=j.useState("all"),[l,c]=j.useState("newest"),d=typeof window<"u"?localStorage.getItem("selectedPlayerId"):null,u=(e==null?void 0:e.activeProfileId)||d,h=u||(t==null?void 0:t.id)||(e==null?void 0:e.id),{data:f,isLoading:m}=Ge({queryKey:["/api/award-definitions"],enabled:!!e}),{data:y,isLoading:x}=Ge({queryKey:["/api/user-awards",h],queryFn:async()=>{const P=u?`/api/user-awards?userId=${u}`:"/api/user-awards",T=await fetch(P,{credentials:"include"});if(!T.ok)throw new Error("Failed to fetch user awards");return T.json()},enabled:!!e&&!!h}),b=j.useMemo(()=>!f||!y?[]:y.filter(P=>P.visible).map(P=>{const T=f.find($=>$.id===P.awardId);return T?{...T,earnedDate:P.awardedAt,awardedBy:P.awardedBy||void 0,year:P.year||void 0,notes:P.notes||void 0}:null}).filter(P=>P!==null),[f,y]),g=j.useMemo(()=>{if(!f)return[];const P=new Set(b.map(T=>T.id));return f.filter(T=>T.active&&!P.has(T.id))},[f,b]),v=j.useMemo(()=>{let P=b;return r!=="all"&&(P=P.filter(T=>T.tier===r)),a!=="all"&&(P=P.filter(T=>T.prestige===a)),P.sort((T,$)=>{if(l==="newest")return new Date($.earnedDate).getTime()-new Date(T.earnedDate).getTime();if(l==="oldest")return new Date(T.earnedDate).getTime()-new Date($.earnedDate).getTime();{const D=["HallOfFame","Superstar","AllStar","Starter","Prospect"];return D.indexOf(T.prestige)-D.indexOf($.prestige)}})},[b,r,a,l]),_=j.useMemo(()=>{let P=g;return r!=="all"&&(P=P.filter(T=>T.tier===r)),a!=="all"&&(P=P.filter(T=>T.prestige===a)),P.sort((T,$)=>{const D=["HallOfFame","Superstar","AllStar","Starter","Prospect"];return D.indexOf(T.prestige)-D.indexOf($.prestige)})},[g,r,a]),B=j.useMemo(()=>{const P=b.filter($=>$.tier==="Trophy"),T=b.filter($=>$.tier==="Badge");return{total:b.length,trophies:P.length,badges:T.length}},[b]),I=m||x,Q=()=>{n("/player-dashboard")},F=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-b from-red-950 via-gray-900 to-black text-white safe-bottom",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:Q,className:"p-2 hover:bg-white/10 rounded-lg transition-colors","data-testid":"button-back",children:s.jsx(vn,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-page-title",children:"My Trophies & Badges"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1","data-testid":"text-page-subtitle",children:"Track your achievements and earn rewards for your dedication"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-total",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Total Awards"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.total})]}),s.jsx($u,{className:"h-8 w-8 text-yellow-500"})]})})}),s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-trophies",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Trophies"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.trophies})]}),s.jsx(Ai,{className:"h-8 w-8 text-orange-500"})]})})}),s.jsx(ye,{className:"bg-white/5 border-white/10","data-testid":"card-stat-badges",children:s.jsx(we,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Badges"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:B.badges})]}),s.jsx($u,{className:"h-8 w-8 text-blue-500"})]})})})]}),s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(vne,{className:"h-4 w-4"}),s.jsx("span",{className:"font-semibold",children:"Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Type"}),s.jsxs(Qt,{value:r,onValueChange:P=>i(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-tier",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"all",children:"All Types"}),s.jsx(xe,{value:"Trophy",children:"Trophies Only"}),s.jsx(xe,{value:"Badge",children:"Badges Only"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Prestige Level"}),s.jsxs(Qt,{value:a,onValueChange:P=>o(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-prestige",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"all",children:"All Levels"}),s.jsx(xe,{value:"HallOfFame",children:"Hall of Fame"}),s.jsx(xe,{value:"Superstar",children:"Superstar"}),s.jsx(xe,{value:"AllStar",children:"All-Star"}),s.jsx(xe,{value:"Starter",children:"Starter"}),s.jsx(xe,{value:"Prospect",children:"Prospect"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Sort By"}),s.jsxs(Qt,{value:l,onValueChange:P=>c(P),children:[s.jsx(Ut,{className:"bg-white/10 border-white/20","data-testid":"select-sort",children:s.jsx(Mt,{})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"newest",children:"Newest First"}),s.jsx(xe,{value:"oldest",children:"Oldest First"}),s.jsx(xe,{value:"prestige",children:"Prestige (High to Low)"})]})]})]})]})]})}),s.jsxs(My,{defaultValue:"earned",className:"w-full",children:[s.jsxs(Fg,{className:"grid w-full grid-cols-2 bg-white/10","data-testid":"tabs-awards",children:[s.jsxs(Wr,{value:"earned","data-testid":"tab-earned",children:["Earned (",v.length,")"]}),s.jsxs(Wr,{value:"available","data-testid":"tab-available",children:["Available (",_.length,")"]})]}),s.jsx(Gr,{value:"earned",className:"mt-6",children:I?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((P,T)=>s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsx(Um,{className:"h-32 w-full mb-4 bg-white/10"}),s.jsx(Um,{className:"h-4 w-3/4 mb-2 bg-white/10"}),s.jsx(Um,{className:"h-3 w-full bg-white/10"})]})},T))}):v.length===0?s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-12 pb-12 text-center",children:[s.jsx(Ai,{className:"h-16 w-16 mx-auto mb-4 text-gray-500"}),s.jsx("h3",{className:"text-xl font-semibold mb-2","data-testid":"text-empty-state",children:"No Awards Yet"}),s.jsx("p",{className:"text-gray-400","data-testid":"text-empty-message",children:"Start attending practices and games to earn your first trophy!"})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:v.map(P=>s.jsxs(ye,{className:`bg-white/5 border-2 ${fBe[P.prestige]} hover:scale-105 transition-transform duration-200`,"data-testid":`card-award-${P.id}`,children:[s.jsxs(Ve,{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx(et,{className:JL[P.prestige],"data-testid":`badge-prestige-${P.id}`,children:P.prestige}),s.jsx(et,{variant:"outline",className:"border-white/20","data-testid":`badge-tier-${P.id}`,children:P.tier})]}),s.jsx("div",{className:"aspect-square bg-white/10 rounded-lg flex items-center justify-center mb-4 overflow-hidden",children:P.imageUrl?s.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-contain","data-testid":`img-award-${P.id}`}):s.jsx(Ai,{className:`h-20 w-20 ${hBe[P.prestige]}`})}),s.jsx(Ke,{className:"text-lg leading-tight","data-testid":`text-award-name-${P.id}`,children:P.name}),P.description&&s.jsx(zn,{className:"text-gray-400 text-sm mt-2","data-testid":`text-award-description-${P.id}`,children:P.description})]}),s.jsxs(we,{children:[s.jsxs("p",{className:"text-xs text-gray-400","data-testid":`text-earned-date-${P.id}`,children:["Earned: ",F(P.earnedDate)]}),P.year&&s.jsxs("p",{className:"text-xs text-gray-400","data-testid":`text-award-year-${P.id}`,children:["Year: ",P.year]})]})]},P.id))})}),s.jsx(Gr,{value:"available",className:"mt-6",children:I?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((P,T)=>s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-6",children:[s.jsx(Um,{className:"h-32 w-full mb-4 bg-white/10"}),s.jsx(Um,{className:"h-4 w-3/4 mb-2 bg-white/10"}),s.jsx(Um,{className:"h-3 w-full bg-white/10"})]})},T))}):_.length===0?s.jsx(ye,{className:"bg-white/5 border-white/10",children:s.jsxs(we,{className:"pt-12 pb-12 text-center",children:[s.jsx($u,{className:"h-16 w-16 mx-auto mb-4 text-gray-500"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"All Awards Earned!"}),s.jsx("p",{className:"text-gray-400",children:"Congratulations! You've earned all available awards."})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:_.map(P=>s.jsxs(ye,{className:"bg-white/5 border-white/10 opacity-60 hover:opacity-80 transition-opacity duration-200","data-testid":`card-available-award-${P.id}`,children:[s.jsxs(Ve,{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx(et,{className:`${JL[P.prestige]} opacity-50`,"data-testid":`badge-prestige-available-${P.id}`,children:P.prestige}),s.jsx(et,{variant:"outline",className:"border-white/20","data-testid":`badge-tier-available-${P.id}`,children:P.tier})]}),s.jsx("div",{className:"aspect-square bg-white/10 rounded-lg flex items-center justify-center mb-4 overflow-hidden grayscale",children:P.imageUrl?s.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-contain","data-testid":`img-available-award-${P.id}`}):s.jsx(Ai,{className:"h-20 w-20 text-gray-500"})}),s.jsx(Ke,{className:"text-lg leading-tight text-gray-400","data-testid":`text-available-award-name-${P.id}`,children:P.name}),P.description&&s.jsx(zn,{className:"text-gray-500 text-sm mt-2","data-testid":`text-available-award-description-${P.id}`,children:P.description})]}),s.jsx(we,{children:s.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ”’ Not yet earned"})})]},P.id))})})]})]})})}const jB=[{name:"SHOOTING",skills:["LAYUP","2PT RANGE","3PT RANGE"],averageScore:72},{name:"DRIBBLING",skills:["LEFT","RIGHT","CONTROL","SPEED"],averageScore:85},{name:"PASSING",skills:["BOUNCE","CHEST","OVERHEAD","CATCHING"],averageScore:68},{name:"DEFENSE",skills:["TALKING","STANCE","CLOSEOUT"],averageScore:74},{name:"REBOUNDING",skills:["BOX OUT","BALL PROTECTION","ANTICIPATION"],averageScore:78},{name:"ATHLETIC ABILITY",skills:["STAMINA","QUICKNESS","COORDINATION"],averageScore:82},{name:"COACHABILITY",skills:["ATTITUDE","FOCUS","WORK ETHIC","ACCEPTS CRITICISM"],averageScore:88}],pBe=(e,t)=>{var r;const n=((r=jB.find(i=>i.name===e))==null?void 0:r.averageScore)||75;return Math.min(100,Math.max(0,n+Math.floor(Math.random()*20-10)))};function gBe(){const[,e]=Wt(),[t,n]=j.useState(null);return s.jsxs("div",{className:"min-h-screen-safe bg-background safe-bottom",children:[s.jsx("div",{className:"bg-card border-b sticky top-0 z-40",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-dashboard"),"data-testid":"button-back",children:s.jsx(vn,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(uj,{className:"w-5 h-5 text-red-600"}),s.jsx("h1",{className:"text-xl font-semibold",children:"Skills Assessment"})]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:t?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>n(null),children:s.jsx(vn,{className:"w-4 h-4"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t})]}),(()=>{const r=jB.find(i=>i.name===t);return r?s.jsxs("div",{className:"space-y-4",children:[s.jsx(ye,{children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-red-600 mb-2",children:[r.averageScore,"%"]}),s.jsxs("div",{className:"text-gray-600",children:["Overall ",r.name.toLowerCase()," score"]}),s.jsx(xd,{value:r.averageScore,className:"mt-4 h-4"})]})})}),r.skills.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Individual Skills"}),r.skills.map(i=>{const a=pBe(r.name);return s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"font-medium text-gray-700",children:i}),s.jsxs("span",{className:"text-red-600 font-semibold",children:[a,"%"]})]}),s.jsx(xd,{value:a,className:"h-2"})]})},i)})]}),s.jsx(ye,{children:s.jsxs(we,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Coach Notes"}),s.jsx("p",{className:"text-gray-600 text-sm",children:r.averageScore>=80?`Excellent work on ${r.name.toLowerCase()}! Keep practicing to maintain this high level.`:`Good progress on ${r.name.toLowerCase()}. Focus on the specific skills below to improve your overall score.`})]})})]}):null})()]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Skills Progress"}),s.jsx("p",{className:"text-gray-600",children:"Track your development across all basketball fundamentals"})]}),jB.map(r=>s.jsx(ye,{className:"cursor-pointer hover:shadow-md transition-shadow",children:s.jsxs(we,{className:"p-4",onClick:()=>n(r.name),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:r.name}),s.jsxs("span",{className:"text-red-600 font-bold text-lg",children:[r.averageScore,"%"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(xd,{value:r.averageScore,className:"h-3"}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsxs("span",{children:[r.skills.length," skills assessed"]}),s.jsx("span",{children:r.averageScore>=90?"Excellent":r.averageScore>=80?"Very Good":r.averageScore>=70?"Good":r.averageScore>=60?"Developing":"Needs Work"})]})]})]})},r.name))]})})]})}function xBe(){return s.jsxs("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom p-8",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Test Route Works!"}),s.jsx("p",{children:"If you can see this, routing is working correctly."})]})}function yBe(){return s.jsx("div",{className:"min-h-screen-safe w-full flex items-center justify-center bg-gray-50 safe-bottom",children:s.jsx(ye,{className:"w-full max-w-md mx-4",children:s.jsxs(we,{className:"pt-6",children:[s.jsxs("div",{className:"flex mb-4 gap-2",children:[s.jsx(jd,{className:"h-8 w-8 text-red-500"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),s.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const vBe="#d82428",wBe=q.object({firstName:q.string().min(1,"First name is required"),lastName:q.string().min(1,"Last name is required"),phoneNumber:q.string().optional(),dateOfBirth:q.string().min(1,"Date of birth is required"),jerseyNumber:q.string().min(1,"Jersey number is required"),height:q.string().min(1,"Height is required"),city:q.string().min(1,"City is required"),position:q.string().min(1,"Position is required")});function bBe(){const{user:e}=dn(),[,t]=Wt();Pee();const n=os(),{toast:r}=Tt();j.useState(!1),j.useState((e==null?void 0:e.email)||""),j.useState(null);const[i,a]=j.useState(!1),o=Dr({resolver:Qr(wBe),defaultValues:{firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phoneNumber:"",dateOfBirth:"",jerseyNumber:"",height:"",city:"",position:""}}),l=ot({mutationFn:async d=>{const u=d.jerseyNumber&&d.jerseyNumber.trim()!==""?parseInt(d.jerseyNumber,10):void 0;if(d.dateOfBirth){const m=new Date(d.dateOfBirth),y=new Date;let x=y.getFullYear()-m.getFullYear();const b=y.getMonth()-m.getMonth();(b<0||b===0&&y.getDate()<m.getDate())&&x--,x.toString()}const h=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({organizationId:(e==null?void 0:e.organizationId)||"default-org",email:(e==null?void 0:e.email)||"",role:"player",firstName:d.firstName,lastName:d.lastName,phoneNumber:d.phoneNumber,dateOfBirth:d.dateOfBirth,jerseyNumber:u,position:d.position,program:void 0,isActive:!0,verified:i})});if(!h.ok){const m=await h.json();throw new Error(m.message||"Failed to create profile")}return await h.json()},onSuccess:d=>{n.invalidateQueries({queryKey:["/api/users"]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),r({title:"Profile Created!",description:"Your profile has been successfully created."}),d.role==="player"?t("/player-dashboard"):d.role==="coach"?t("/coach-dashboard"):d.role==="admin"?t("/admin"):t("/player-dashboard")},onError:d=>{r({title:"Error",description:d.message||"Failed to create profile",variant:"destructive"})}}),c=d=>{l.mutate(d)};return s.jsx("div",{className:"min-h-screen-safe text-white safe-bottom p-4",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(216,36,40,0.15), transparent 60%), #000"},children:s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>t("/select-profile-type"),className:"p-2 rounded-md border border-white/15 hover:bg-white/5 transition","data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Create Player Profile"}),s.jsx("p",{className:"text-sm text-white/70",children:"Complete your profile information"})]})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-white",children:"Profile Information"})}),s.jsx(we,{children:s.jsx(Mr,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(c),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"firstName",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"First Name"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter first name",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-first-name"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"lastName",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Last Name"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter last name",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-last-name"})}),s.jsx(ft,{})]})})]}),s.jsx(it,{control:o.control,name:"phoneNumber",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Phone Number (Optional)"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"Enter phone number",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-phone"})}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"dateOfBirth",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Date of Birth"}),s.jsx(ut,{children:s.jsx(qe,{...d,type:"date",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-dob"})}),s.jsx(ft,{})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"jerseyNumber",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Jersey Number"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-jersey",children:s.jsx(Mt,{placeholder:"Select number"})})}),s.jsx(Dt,{className:"max-h-[200px]",children:Array.from({length:99},(u,h)=>h+1).map(u=>s.jsx(xe,{value:u.toString(),children:u},u))})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"position",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Position"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-position",children:s.jsx(Mt,{placeholder:"Select position"})})}),s.jsxs(Dt,{children:[s.jsx(xe,{value:"PG",children:"PG - Point Guard"}),s.jsx(xe,{value:"SG",children:"SG - Shooting Guard"}),s.jsx(xe,{value:"SF",children:"SF - Small Forward"}),s.jsx(xe,{value:"PF",children:"PF - Power Forward"}),s.jsx(xe,{value:"C",children:"C - Center"})]})]}),s.jsx(ft,{})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(it,{control:o.control,name:"height",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"Height"}),s.jsxs(Qt,{value:d.value||"",onValueChange:d.onChange,children:[s.jsx(ut,{children:s.jsx(Ut,{className:"bg-white/10 border-white/20 text-white","data-testid":"select-height",children:s.jsx(Mt,{placeholder:"Select height"})})}),s.jsx(Dt,{className:"max-h-[200px]",children:(()=>{const u=[];for(let h=3;h<=7;h++)for(let f=0;f<12;f++)u.push(`${h}'${f}"`);return u.map(h=>s.jsx(xe,{value:h,children:h},h))})()})]}),s.jsx(ft,{})]})}),s.jsx(it,{control:o.control,name:"city",render:({field:d})=>s.jsxs(rt,{children:[s.jsx(at,{className:"text-white",children:"City"}),s.jsx(ut,{children:s.jsx(qe,{...d,placeholder:"City",className:"bg-white/10 border-white/20 text-white placeholder:text-white/50","data-testid":"input-city"})}),s.jsx(ft,{})]})})]}),s.jsx(te,{type:"submit",disabled:l.isPending,className:"w-full",style:{backgroundColor:vBe},"data-testid":"button-create-profile",children:l.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Profile..."]}):"Create Profile"})]})})})]})]})})}function jBe(){dn();const[,e]=Wt(),[t,n]=j.useState(!1),r=()=>{e("/create-profile?type=player")},i=a=>{n(!1),e(a==="admin"?"/admin":"/coach-dashboard")};return s.jsxs("div",{className:"min-h-screen-safe text-white safe-bottom flex items-center justify-center p-4",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(59,130,246,0.15), transparent 60%), #000"},children:[s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:s.jsx(Fi,{className:"w-10 h-10 text-white"})}),s.jsx("h1",{className:"text-3xl font-bold mb-3",children:"Welcome"}),s.jsx("p",{className:"text-white/70",children:"Create your player profile to get started"})]}),s.jsx(ye,{onClick:r,className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-player-type",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-lg bg-white/10 grid place-items-center text-white",children:s.jsx(Us,{className:"h-7 w-7"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg mb-1",children:"Player Profile"}),s.jsx("p",{className:"text-sm text-white/70",children:"Access your team information, training programs, and track your progress"})]})]})})}),s.jsxs("div",{className:"mt-8 text-center text-sm text-white/50",children:[s.jsx("p",{children:"Your profile will be automatically synced with our system if you're using a registered email."}),s.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-white/60 hover:text-white/90 underline transition-colors","data-testid":"button-staff-login",children:"Staff login (Admin/Coach)"})]})]}),s.jsx($n,{open:t,onOpenChange:n,children:s.jsxs(Qn,{className:"bg-gray-900 border-gray-800 text-white",children:[s.jsx(es,{children:s.jsx(qn,{className:"text-2xl",children:"Select Your Role"})}),s.jsxs("div",{className:"space-y-3 mt-4",children:[s.jsx(ye,{onClick:()=>i("admin"),className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-admin-role",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-600 grid place-items-center text-white",children:s.jsx(Fi,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:"Administrator"}),s.jsx("p",{className:"text-sm text-white/60",children:"Full access to all features and settings"})]})]})})}),s.jsx(ye,{onClick:()=>i("coach"),className:"cursor-pointer bg-white/5 border-white/10 hover:bg-white/[0.07] transition","data-testid":"card-coach-role",children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-600 grid place-items-center text-white",children:s.jsx(Une,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:"Coach"}),s.jsx("p",{className:"text-sm text-white/60",children:"Manage teams, events, and player progress"})]})]})})})]})]})})]})}function NBe(){const{data:e,isLoading:t}=Ge({queryKey:["/api/account/me"]}),{data:n=[],isLoading:r}=Ge({queryKey:["/api/profiles/me"]});if(t||r)return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center","data-testid":"loading-registration",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading registration status..."})]})});if(!e)return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center",children:s.jsx(ye,{className:"w-full max-w-md",children:s.jsxs(we,{className:"p-6 text-center",children:[s.jsx(qi,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Account Not Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"We couldn't find your account information. Please contact support for assistance."})]})})});const a=u=>{switch(u){case"active":return{icon:s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),label:"Active",variant:"default",description:"Your registration is complete and active"};case"payment_required":return{icon:s.jsx(ba,{className:"w-5 h-5 text-orange-600"}),label:"Payment Required",variant:"destructive",description:"Payment is needed to complete registration"};default:return{icon:s.jsx(Ar,{className:"w-5 h-5 text-gray-600"}),label:"Pending",variant:"secondary",description:"Registration is being processed"}}},o=u=>{switch(u){case"paid":return{icon:s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),label:"Paid",variant:"default"};case"overdue":return{icon:s.jsx(qi,{className:"w-5 h-5 text-red-600"}),label:"Overdue",variant:"destructive"};default:return{icon:s.jsx(Ar,{className:"w-5 h-5 text-yellow-600"}),label:"Pending",variant:"secondary"}}},l=a(e.registrationStatus),c=o(e.paymentStatus),d=n.filter(u=>u.profileType==="player");return s.jsx("div",{className:"scrollable-page bg-gray-50 safe-bottom p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2","data-testid":"title-registration",children:"Registration Status"}),s.jsx("p",{className:"text-gray-600",children:"View your registration and payment status for BoxStat"})]}),e.registrationStatus==="payment_required"&&s.jsxs(_c,{className:"border-orange-200 bg-orange-50","data-testid":"alert-payment-required",children:[s.jsx(qi,{className:"h-4 w-4 text-orange-600"}),s.jsxs(Bc,{className:"text-orange-700",children:[s.jsx("strong",{children:"Payment Required:"})," Your registration is pending payment. You should have received payment instructions via email. Please complete payment to activate your account."]})]}),e.paymentStatus==="overdue"&&s.jsxs(_c,{className:"border-red-200 bg-red-50","data-testid":"alert-payment-overdue",children:[s.jsx(qi,{className:"h-4 w-4 text-red-600"}),s.jsxs(Bc,{className:"text-red-700",children:[s.jsx("strong",{children:"Payment Overdue:"})," Your payment is overdue. Please complete payment immediately to avoid service interruption."]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs(ye,{"data-testid":"card-registration-status",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[l.icon,"Registration Status"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx(et,{variant:l.variant,"data-testid":"badge-registration-status",children:l.label})]}),s.jsx("p",{className:"text-sm text-gray-600",children:l.description}),s.jsx("div",{className:"pt-2 border-t",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Account Email:"}),s.jsx("span",{className:"font-medium","data-testid":"text-account-email",children:e.email})]})})]})]}),s.jsxs(ye,{"data-testid":"card-payment-status",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[c.icon,"Payment Status"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx(et,{variant:c.variant,"data-testid":"badge-payment-status",children:c.label})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Payments are processed through our registration system.",e.paymentStatus==="pending"&&" You will receive payment instructions via email.",e.paymentStatus==="overdue"&&" Please check your email for payment details."]}),e.paymentStatus!=="paid"&&s.jsx(_c,{className:"bg-blue-50 border-blue-200",children:s.jsxs(Bc,{className:"text-blue-700 text-sm",children:[s.jsx("strong",{children:"Need Help?"})," If you have questions about payment or haven't received instructions, please contact our support team."]})})]})]})]}),s.jsxs(ye,{"data-testid":"card-players-info",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(vs,{className:"w-5 h-5"}),"Registered Players (",d.length,")"]})}),s.jsx(we,{children:d.length>0?s.jsx("div",{className:"grid gap-4",children:d.map((u,h)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg","data-testid":`player-card-${h}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-semibold",children:[u.firstName.charAt(0),u.lastName.charAt(0)]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium","data-testid":`player-name-${h}`,children:[u.firstName," ",u.lastName]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[u.jerseyNumber&&`#${u.jerseyNumber} â€¢ `,"Player Profile"]})]})]}),s.jsx(et,{variant:"outline","data-testid":`player-status-${h}`,children:"Registered"})]},u.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(vs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No player profiles found"}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Player profiles will appear here once registration is complete"})]})})]}),e.registrationStatus==="active"&&s.jsxs(ye,{"data-testid":"card-next-steps",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-5 h-5"}),"What's Next?"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Check the schedule for upcoming practices and games"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Complete player profiles with emergency contacts"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ra,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Download the team communication app if available"})]})]})})]})]})})}function CBe(){const e=async()=>{try{const t=await fetch("/api/auth/user");if(!t.ok){console.error("Failed to get user info");return}const n=await t.json();(await fetch("/api/ghl/sync?email="+encodeURIComponent(n.email))).ok&&window.location.reload()}catch(t){console.error("Sync failed:",t)}};return s.jsx("div",{className:"min-h-screen-safe bg-gray-50 safe-bottom flex items-center justify-center p-4",children:s.jsxs(ye,{className:"w-full max-w-md",children:[s.jsxs(Ve,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(jd,{className:"w-6 h-6 text-yellow-600"})}),s.jsx(Ke,{children:"No Profiles Found"})]}),s.jsxs(we,{className:"text-center space-y-4",children:[s.jsx("p",{className:"text-muted-foreground",children:"We couldn't find your family profiles. This usually means your data is still being processed from GoHighLevel."}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(te,{onClick:e,className:"w-full gap-2","data-testid":"button-retry-sync",children:[s.jsx(Pne,{className:"w-4 h-4"}),"Retry Sync"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"If this problem persists, please contact support."})]})]})]})})}function _Be(){const{user:e}=dn(),[,t]=Wt(),{toast:n}=Tt(),r=os(),[i,a]=j.useState(1),[o,l]=j.useState([]),[c,d]=j.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phone:(e==null?void 0:e.phoneNumber)||""}),[u,h]=j.useState([{firstName:"",lastName:""}]),[f,m]=j.useState({}),{data:y=[],isLoading:x}=Ge({queryKey:["/api/programs"],enabled:i===2}),b=y.reduce((T,$)=>{const D=$.category||"Other";return T[D]||(T[D]=[]),T[D].push($),T},{}),g=ot({mutationFn:async T=>await bt("POST","/api/onboarding/complete",T),onSuccess:T=>{var D;n({title:"Players Created!",description:"Now let's select packages for each player."});const $=((D=T.players)==null?void 0:D.map(O=>O.id))||[];l($),h(O=>O.map((V,K)=>({...V,id:$[K]}))),r.invalidateQueries({queryKey:["/api/auth/user"]}),r.invalidateQueries({queryKey:["/api/profiles"]}),a(2)},onError:T=>{n({title:"Setup Failed",description:T.message||"Failed to create player profiles. Please try again.",variant:"destructive"})}}),v=ot({mutationFn:async T=>await bt("POST","/api/family/package-selections",{selections:T}),onSuccess:()=>{n({title:"Package Selections Saved!",description:"Redirecting to payment..."}),r.invalidateQueries({queryKey:["/api/family/package-selections"]}),setTimeout(()=>t("/payments"),500)},onError:T=>{n({title:"Failed to Save Selections",description:T.message||"Please try again.",variant:"destructive"})}}),_=()=>{h(T=>[...T,{firstName:"",lastName:""}])},B=T=>{if(u.length>1){h(O=>O.filter((V,K)=>K!==T));const $={...f};delete $[T];const D={};Object.keys($).forEach(O=>{const V=parseInt(O);V>T?D[V-1]=$[V]:D[V]=$[V]}),m(D)}},I=(T,$,D)=>{h(O=>O.map((V,K)=>K===T?{...V,[$]:D}:V))},Q=(T,$)=>{d(D=>({...D,[T]:$}))},F=()=>{if(!c.firstName||!c.lastName){n({title:"Missing Information",description:"Please fill in parent's first and last name.",variant:"destructive"});return}const T=u.filter(D=>D.firstName&&D.lastName);if(T.length===0){n({title:"Missing Information",description:"Please add at least one player with first and last name.",variant:"destructive"});return}const $={parent:c,players:T};g.mutate($)},P=()=>{const T=u.filter(O=>O.firstName&&O.lastName);if(!T.every((O,V)=>f[V])){n({title:"Missing Selections",description:"Please select a package for each player.",variant:"destructive"});return}const D=T.map((O,V)=>({childUserId:O.id,programId:f[V]}));v.mutate(D)};return s.jsxs("div",{className:"min-h-screen-safe text-white safe-bottom",style:{background:"radial-gradient(1200px 600px at 50% -10%, rgba(216,36,40,0.15), transparent 60%), #000"},children:[s.jsx("header",{className:"sticky top-0 z-10 bg-black/50 backdrop-blur-sm border-b border-white/10",children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>i===1?t("/profile-selection"):a(1),className:"p-2 rounded-md border border-white/15 hover:bg-white/5 transition","data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(vs,{className:"h-6 w-6 text-red-500"}),s.jsx("h1",{className:"text-xl font-bold",children:"Family Setup"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsxs("div",{className:`flex items-center gap-2 ${i===1?"text-red-500":"text-white/50"}`,children:[s.jsx(Zp,{className:`h-4 w-4 ${i>1?"text-green-500":""}`}),s.jsx("span",{children:"Player Info"})]}),s.jsx(Gs,{className:"h-4 w-4 text-white/30"}),s.jsxs("div",{className:`flex items-center gap-2 ${i===2?"text-red-500":"text-white/50"}`,children:[s.jsx(Zp,{className:`h-4 w-4 ${i>2?"text-green-500":""}`}),s.jsx("span",{children:"Packages"})]})]})]})})}),s.jsx("main",{className:"max-w-4xl mx-auto px-6 pb-16",children:s.jsxs("div",{className:"space-y-6 pt-6",children:[i===1&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to BoxStat!"}),s.jsx("p",{className:"text-white/70 max-w-2xl mx-auto",children:"Let's set up your family profiles. You'll be able to manage all your players, register for programs, and track their progress from one account."})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-white",children:"Parent / Guardian Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"First name *"}),s.jsx(qe,{value:c.firstName,onChange:T=>Q("firstName",T.target.value),placeholder:"First name","data-testid":"input-parent-first-name",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Last name *"}),s.jsx(qe,{value:c.lastName,onChange:T=>Q("lastName",T.target.value),placeholder:"Last name","data-testid":"input-parent-last-name",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Phone number"}),s.jsx(qe,{value:c.phone,onChange:T=>Q("phone",T.target.value),placeholder:"(555) 123-4567","data-testid":"input-parent-phone",className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]})]})})]}),s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsxs(Ve,{className:"flex flex-row items-center justify-between",children:[s.jsx(Ke,{className:"text-white",children:"Your Players"}),s.jsxs(te,{variant:"outline",size:"sm",onClick:_,className:"gap-2 border-white/20 text-white hover:bg-white/10","data-testid":"button-add-player",children:[s.jsx(sl,{className:"h-4 w-4"})," Add Player"]})]}),s.jsx(we,{className:"space-y-4",children:u.map((T,$)=>s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"First name *"}),s.jsx(qe,{value:T.firstName,onChange:D=>I($,"firstName",D.target.value),placeholder:"First name","data-testid":`input-player-first-name-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Last name *"}),s.jsx(qe,{value:T.lastName,onChange:D=>I($,"lastName",D.target.value),placeholder:"Last name","data-testid":`input-player-last-name-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Date of Birth"}),s.jsx(qe,{type:"date",value:T.dob??"",onChange:D=>I($,"dob",D.target.value),"data-testid":`input-player-dob-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Grade"}),s.jsx(qe,{value:T.grade??"",onChange:D=>I($,"grade",D.target.value),placeholder:"9th","data-testid":`input-player-grade-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Current Team (if any)"}),s.jsx(qe,{value:T.teamName??"",onChange:D=>I($,"teamName",D.target.value),placeholder:"Team name","data-testid":`input-player-team-${$}`,className:"bg-white/5 border-white/20 text-white placeholder-white/40"})]}),s.jsx("div",{className:"flex items-end justify-end",children:u.length>1&&s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>B($),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","data-testid":`button-remove-player-${$}`,children:s.jsx(Lne,{className:"h-4 w-4"})})})]})]},$))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end pt-4",children:[s.jsx(te,{variant:"outline",onClick:()=>t("/profile-selection"),className:"border-white/20 text-white hover:bg-white/10","data-testid":"button-cancel",children:"Cancel"}),s.jsx(te,{onClick:F,disabled:g.isPending,className:"bg-red-600 hover:bg-red-700 text-white gap-2","data-testid":"button-next-to-packages",children:g.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 animate-spin"}),"Creating Players..."]}):s.jsxs(s.Fragment,{children:["Continue to Package Selection",s.jsx(Gs,{className:"h-4 w-4"})]})})]})]}),i===2&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Select Packages for Your Players"}),s.jsx("p",{className:"text-white/70 max-w-2xl mx-auto",children:"Choose the right program for each of your players. You'll complete payment on the next page."})]}),x?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Nc,{className:"h-8 w-8 animate-spin text-red-500","data-testid":"loader-programs"})}):s.jsx(s.Fragment,{children:u.filter(T=>T.firstName&&T.lastName).map((T,$)=>{const D=f[$],O=y.find(V=>V.id===D);return s.jsxs(ye,{className:"bg-white/5 border-white/10 shadow-[0_8px_30px_rgba(0,0,0,.35)]",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-white flex items-center justify-between",children:[s.jsxs("span",{children:["Package for ",T.firstName," ",T.lastName]}),O&&s.jsx("span",{className:"text-sm font-normal text-green-400","data-testid":`text-selected-program-${$}`,children:"âœ“ Selected"})]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(yt,{className:"text-white/80",children:"Select Program *"}),s.jsxs(Qt,{value:f[$]||"",onValueChange:V=>m(K=>({...K,[$]:V})),children:[s.jsx(Ut,{className:"bg-white/5 border-white/20 text-white","data-testid":`select-package-${$}`,children:s.jsx(Mt,{placeholder:"Choose a program..."})}),s.jsx(Dt,{className:"bg-zinc-900 border-white/20",children:Object.entries(b).map(([V,K])=>s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-white/60 uppercase",children:V}),K.map(oe=>s.jsx(xe,{value:oe.id,className:"text-white hover:bg-white/10","data-testid":`option-program-${oe.id}`,children:s.jsxs("div",{className:"flex items-center justify-between w-full gap-4",children:[s.jsx("span",{children:oe.name}),oe.price&&s.jsxs("span",{className:"text-white/60 text-sm",children:["$",(oe.price/100).toFixed(2),oe.pricingModel==="monthly"&&"/mo"]})]})},oe.id))]},V))})]})]}),O&&s.jsx("div",{className:"rounded-lg bg-white/5 p-4 space-y-2 border border-white/10",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-white",children:O.name}),O.description&&s.jsx("p",{className:"text-sm text-white/60 mt-1",children:O.description})]}),O.price&&s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-white",children:["$",(O.price/100).toFixed(2)]}),O.pricingModel&&s.jsx("p",{className:"text-xs text-white/60",children:O.pricingModel})]})]})})]})]},$)})}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between pt-4",children:[s.jsxs(te,{variant:"outline",onClick:()=>a(1),className:"border-white/20 text-white hover:bg-white/10","data-testid":"button-back-to-players",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Player Info"]}),s.jsx(te,{onClick:P,disabled:v.isPending||x,className:"bg-red-600 hover:bg-red-700 text-white gap-2","data-testid":"button-complete-package-selection",children:v.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"h-4 w-4 animate-spin"}),"Saving Selections..."]}):s.jsxs(s.Fragment,{children:["Continue to Payment",s.jsx(Gs,{className:"h-4 w-4"})]})})]}),s.jsx("div",{className:"text-center text-sm text-white/60 pt-4",children:s.jsx("p",{children:"You'll complete payment on the next page. All selections can be modified later if needed."})})]})]})})]})}const e6=[{id:"parent-profile-001",accountId:"demo-account-001",profileType:"parent",firstName:"Sarah",lastName:"Johnson",email:"sarah.johnson@email.com",description:"Manage family profiles, payments, and communication"},{id:"player-profile-001",accountId:"demo-account-001",profileType:"player",firstName:"Emma",lastName:"Johnson",teamName:"U12 Thunder",jerseyNumber:15,position:"Point Guard",grade:"6th Grade",description:"Track progress and team communication"},{id:"player-profile-002",accountId:"demo-account-001",profileType:"player",firstName:"Jake",lastName:"Johnson",teamName:"U10 Lightning",jerseyNumber:8,position:"Forward",grade:"4th Grade",description:"Skills development and team activities"}];function BBe(){const[,e]=Wt(),[t,n]=j.useState(null),[r,i]=j.useState(!1);Ft.useEffect(()=>{const d=new URLSearchParams(window.location.search).get("demo")==="active"||window.location.pathname.includes("demo");i(d),fetch("/api/auth/demo-status").then(u=>u.json()).then(u=>{u.isDemoMode&&(console.log("Demo mode confirmed:",u),i(!0))}).catch(u=>{console.log("Not in demo mode:",u),i(!1)})},[]);const a=c=>{switch(console.log("Profile selected:",c),n(c),sessionStorage.setItem("demoProfile",JSON.stringify(c)),sessionStorage.setItem("currentProfile",JSON.stringify(c)),sessionStorage.setItem("isDemoMode","true"),console.log("Session storage set, navigating to:",c.profileType),c.profileType){case"player":console.log("Navigating to player dashboard"),e("/player-dashboard?demo=true");break;case"parent":console.log("Navigating to parent dashboard"),e("/parent-dashboard?demo=true");break;case"coach":console.log("Navigating to admin dashboard"),e("/admin-dashboard?demo=true");break;default:console.log("Navigating to home"),e("/?demo=true")}},o=c=>{switch(c){case"parent":return s.jsx(vs,{className:"h-6 w-6 text-blue-600"});case"player":return s.jsx(Us,{className:"h-6 w-6 text-green-600"});case"coach":return s.jsx(hne,{className:"h-6 w-6 text-purple-600"});default:return s.jsx(Us,{className:"h-6 w-6"})}},l=c=>{switch(c){case"parent":return"bg-blue-100 border-blue-500";case"player":return"bg-green-100 border-green-500";case"coach":return"bg-purple-100 border-purple-500";default:return"bg-gray-100 border-gray-500"}};return s.jsxs("div",{className:"scrollable-page bg-gray-50 safe-bottom",children:[s.jsx("div",{className:"bg-white border-b",children:s.jsx("div",{className:"max-w-2xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Select Profile"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Choose which profile to use"})]}),s.jsx(te,{variant:"outline",size:"sm",onClick:()=>e("/settings"),"data-testid":"button-settings",children:s.jsx(dj,{className:"h-4 w-4"})})]})})}),s.jsxs("main",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[r&&s.jsx(ye,{className:"bg-orange-50 border-orange-200",children:s.jsx(we,{className:"p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"text-orange-600 text-lg",children:"ðŸŽ­"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:"Demo Mode Active"}),s.jsx("p",{className:"text-sm text-orange-800",children:"You're experiencing the unified account system demo. This shows how Sarah Johnson's account contains multiple family member profiles with profile switching capabilities."}),s.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[s.jsx(te,{size:"sm",variant:"outline",onClick:()=>window.location.href="/",className:"text-orange-800 border-orange-300 hover:bg-orange-100",children:"Exit Demo"}),s.jsx(te,{size:"sm",variant:"outline",onClick:()=>e("/test-accounts"),className:"text-orange-800 border-orange-300 hover:bg-orange-100",children:"Back to Test Accounts"})]})]})]})})}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-lg flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Account: sarah.johnson@email.com"]})}),s.jsx(we,{children:s.jsxs("p",{className:"text-sm text-gray-600",children:["You have ",e6.length," profiles in this account"]})})]}),s.jsx(ye,{className:"bg-blue-50 border-blue-200",children:s.jsxs(we,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Demo: Unified Account System"}),s.jsx("p",{className:"text-sm text-blue-800",children:"This demonstrates the new unified profile system where one account can contain multiple profiles. Sarah's account includes herself as a parent and her two children on different teams."})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Your Profiles"}),s.jsxs(te,{onClick:()=>alert("Create Profile functionality would open here"),size:"sm","data-testid":"button-create-profile",children:[s.jsx(sl,{className:"h-4 w-4 mr-2"}),"Add Profile"]})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e6.map(c=>s.jsx(ye,{className:`cursor-pointer hover:shadow-md transition-shadow border-l-4 ${l(c.profileType)}`,onClick:()=>a(c),"data-testid":`profile-card-${c.id}`,children:s.jsxs(we,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${l(c.profileType)} border`,children:o(c.profileType)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:[c.firstName," ",c.lastName]}),s.jsx("p",{className:"text-sm text-gray-600 capitalize",children:c.profileType})]})]}),s.jsx(et,{variant:c.profileType==="player"?"default":c.profileType==="parent"?"secondary":"outline",className:"capitalize",children:c.profileType})]}),c.profileType==="player"&&s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Team:"})," ",c.teamName]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Jersey:"})," #",c.jerseyNumber]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Position:"})," ",c.position]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Grade:"})," ",c.grade]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:c.description}),s.jsx(te,{className:"w-full","data-testid":`button-select-${c.id}`,onClick:()=>a(c),children:"Select Profile"})]})},c.id))})]}),s.jsx(ye,{className:"bg-green-50 border-green-200",children:s.jsxs(we,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Family Account Benefits"}),s.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[s.jsx("li",{children:"â€¢ Single login for entire family"}),s.jsx("li",{children:"â€¢ Unified payment management"}),s.jsx("li",{children:"â€¢ Cross-team communication and scheduling"}),s.jsx("li",{children:"â€¢ Centralized progress tracking"}),s.jsx("li",{children:"â€¢ Seamless profile switching"})]})]})})]})]})}const ff=sj("PushNotifications",{}),SBe=Pc.isNativePlatform()?"https://boxstat.replit.app":"";function kBe(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${SBe}${e}`}const sY=()=>Pc.isNativePlatform(),PBe=async()=>{if(!sY()){console.log("[Push Init] Not running on native platform, skipping push notification setup");return}console.log("[Push Init] ðŸ”” Initializing push notification listeners..."),console.log("[Push Init] Platform:",Pc.getPlatform()),await ff.addListener("registration",async e=>{console.log("[Push Registration] âœ… FCM token received:",e.value),console.log("[Push Registration] Token length:",e.value.length);try{const t=kBe("/api/push/register");console.log("[Push Registration] Sending token to backend:",t);const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e.value})});if(console.log("[Push Registration] Backend response status:",n.status),n.ok){const r=await n.json();console.log("[Push Registration] âœ… Token successfully registered with backend"),console.log("[Push Registration] Backend response:",r)}else{const r=await n.text();console.error("[Push Registration] âŒ Failed to register token with backend"),console.error("[Push Registration] Status:",n.status),console.error("[Push Registration] Error:",r)}}catch(t){console.error("[Push Registration] âŒ Network error registering token:",t)}}),await ff.addListener("registrationError",e=>{console.error("[Push Registration] âŒ FCM registration failed:",e),console.error("[Push Registration] Error details:",JSON.stringify(e))}),await ff.addListener("pushNotificationReceived",e=>{console.log("[Push Notification] ðŸ“¬ Received in foreground"),console.log("[Push Notification] Title:",e.title),console.log("[Push Notification] Body:",e.body),console.log("[Push Notification] Data:",e.data)}),await ff.addListener("pushNotificationActionPerformed",e=>{console.log("[Push Notification] ðŸ‘† User tapped notification"),console.log("[Push Notification] Action:",e.actionId),console.log("[Push Notification] Data:",e.notification.data)}),console.log("[Push Init] âœ… All push notification listeners initialized successfully")},EBe=async()=>{if(!sY()){console.log("[Push Register] Not on native platform, skipping push notification registration");return}console.log("[Push Register] Starting push notification registration flow...");try{let e=await ff.checkPermissions();if(console.log("[Push Register] ðŸ” Current permission status:",e.receive),e.receive==="prompt"&&(console.log("[Push Register] ðŸ” Permission not yet requested, requesting now..."),e=await ff.requestPermissions(),console.log("[Push Register] Permission request result:",e.receive)),e.receive!=="granted"){console.error("[Push Register] âŒ Push notification permissions denied by user"),console.error("[Push Register] Final permission status:",e.receive);return}console.log("[Push Register] âœ… Push notification permissions granted"),console.log("[Push Register] ðŸ“± Calling PushNotifications.register() to get FCM token..."),await ff.register(),console.log("[Push Register] ðŸ“± Registration API called successfully, waiting for FCM token callback...")}catch(e){console.error("[Push Register] âŒ Error during push notification registration:",e),console.error("[Push Register] Error type:",e instanceof Error?e.name:typeof e),console.error("[Push Register] Error message:",e instanceof Error?e.message:String(e))}},FBe=sj("App",{web:()=>rb(()=>import("./web-DuY-3dpt.js"),[]).then(e=>new e.AppWeb)});let TBe=null;async function IBe(){if(Pc.isNativePlatform())try{FBe.addListener("appUrlOpen",e=>{console.log("[DeepLink] App opened with URL:",e.url),TBe||LBe(e.url)}),console.log("[DeepLink] Deep link listener initialized")}catch(e){console.error("[DeepLink] Failed to initialize deep links:",e)}}function LBe(e){try{const t=new URL(e),n=t.pathname,r=t.searchParams;if(console.log("[DeepLink] Handling URL:",{pathname:n,params:Object.fromEntries(r)}),n==="/magic-link-login"||n.startsWith("/magic-link-login")){const i=r.get("token");i&&(console.log("[DeepLink] Magic link token detected, navigating..."),window.location.href=`/magic-link-login?token=${i}`)}else if(n==="/claim-verify"||n.startsWith("/claim-verify")){const i=r.get("token");i&&(console.log("[DeepLink] Claim verify token detected, navigating..."),window.location.href=`/claim-verify?token=${i}`)}else console.log("[DeepLink] Unknown path, navigating to:",n),window.location.href=n+t.search}catch(t){console.error("[DeepLink] Error handling deep link:",t)}}function UBe(){var v,_;const{user:e}=dn(),[t,n]=Wt(),[r,i]=j.useState(null),[a,o]=j.useState(null),[l,c]=j.useState(!1),d=j.useRef(null),u=j.useRef(null),{toast:h}=Tt(),f=os(),m=ot({mutationFn:async B=>{const I=new FormData;I.append("photo",B);const Q=await fetch("/api/upload-profile-photo",{method:"POST",body:I});if(!Q.ok)throw new Error("Upload failed");return Q.json()},onSuccess:()=>{h({title:"Success",description:"Profile photo updated successfully!"}),f.invalidateQueries({queryKey:["/api/auth/user"]}),n("/player-dashboard")},onError:()=>{h({title:"Error",description:"Failed to upload photo. Please try again."})}}),y=B=>{var Q;const I=(Q=B.target.files)==null?void 0:Q[0];if(I){if(I.size>5*1024*1024){h({title:"Error",description:"File size must be less than 5MB"});return}if(!I.type.startsWith("image/")){h({title:"Error",description:"Please select an image file"});return}i(I);const F=URL.createObjectURL(I);o(F)}},x=()=>{r&&(c(!0),m.mutate(r))},b=()=>{i(null),a&&(URL.revokeObjectURL(a),o(null))},g=e?`${((v=e.firstName)==null?void 0:v[0])||""}${((_=e.lastName)==null?void 0:_[0])||""}`.toUpperCase():"";return s.jsx("div",{className:"min-h-screen-safe bg-gradient-to-br from-gray-900 to-gray-800 safe-bottom p-4",children:s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>n("/player-dashboard"),className:"text-white hover:bg-white/10",children:s.jsx(vn,{className:"h-6 w-6"})}),s.jsx("h1",{className:"text-xl font-semibold text-white",children:"Update Profile Photo"}),s.jsx("div",{className:"w-10"})]}),s.jsxs(ye,{className:"bg-white/10 border-white/20 backdrop-blur-sm",children:[s.jsx(Ve,{className:"text-center",children:s.jsx(Ke,{className:"text-white",children:"Choose New Photo"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsxs(wr,{className:"h-32 w-32",children:[s.jsx(Ur,{src:a||(e==null?void 0:e.profileImageUrl),alt:"Profile"}),s.jsx(br,{className:"text-2xl font-bold bg-gray-300",children:g})]}),a&&s.jsx(te,{variant:"outline",size:"icon",className:"absolute -top-2 -right-2 h-8 w-8 rounded-full bg-red-500 border-red-500 text-white hover:bg-red-600",onClick:b,children:s.jsx(Mf,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(te,{variant:"outline",className:"w-full h-14 bg-white/10 border-white/20 text-white hover:bg-white/20",onClick:()=>{var B;return(B=u.current)==null?void 0:B.click()},children:[s.jsx(oj,{className:"h-6 w-6 mr-3"}),"Take Selfie"]}),s.jsxs(te,{variant:"outline",className:"w-full h-14 bg-white/10 border-white/20 text-white hover:bg-white/20",onClick:()=>{var B;return(B=d.current)==null?void 0:B.click()},children:[s.jsx(hj,{className:"h-6 w-6 mr-3"}),"Upload from Gallery"]}),r&&s.jsx(te,{className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white",onClick:x,disabled:l,children:l?"Uploading...":"Save New Photo"})]}),r&&s.jsxs("div",{className:"text-center text-white/70 text-sm",children:["Selected: ",r.name,s.jsx("br",{}),"Size: ",(r.size/1024/1024).toFixed(2)," MB"]})]})]}),s.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:y,className:"hidden"}),s.jsx("input",{ref:u,type:"file",accept:"image/*",capture:"user",onChange:y,className:"hidden"})]})})}function DBe(){return s.jsxs("div",{className:"min-h-screen-safe bg-gradient-to-b from-orange-50 to-white safe-bottom",children:[s.jsx("div",{className:"bg-[#FF6B35] text-white py-12",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4","data-testid":"text-support-title",children:"Support Center"}),s.jsx("p",{className:"text-lg opacity-90","data-testid":"text-support-subtitle",children:"We're here to help! Get in touch with our team for any questions or assistance."})]})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[s.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-12",children:[s.jsxs(ye,{"data-testid":"card-email-support",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:s.jsx($i,{className:"h-6 w-6 text-[#FF6B35]"})}),s.jsxs("div",{children:[s.jsx(Ke,{children:"Email Support"}),s.jsx(zn,{children:"We typically respond within 24 hours"})]})]})}),s.jsx(we,{children:s.jsx("a",{href:"mailto:support@boxstat.app",className:"text-[#FF6B35] hover:underline font-medium","data-testid":"link-email-support",children:"support@boxstat.app"})})]}),s.jsxs(ye,{"data-testid":"card-general-contact",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:s.jsx(xa,{className:"h-6 w-6 text-[#FF6B35]"})}),s.jsxs("div",{children:[s.jsx(Ke,{children:"General Inquiries"}),s.jsx(zn,{children:"For general questions and feedback"})]})]})}),s.jsx(we,{children:s.jsx("a",{href:"mailto:info@boxstat.app",className:"text-[#FF6B35] hover:underline font-medium","data-testid":"link-general-contact",children:"info@boxstat.app"})})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"mb-12",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6","data-testid":"text-help-resources-title",children:"Help Resources"}),s.jsxs("div",{className:"grid gap-4",children:[s.jsxs(ye,{"data-testid":"card-getting-started",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(pne,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Getting Started"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"New to BoxStat? Learn how to set up your account, manage teams, and track player development."})})]}),s.jsxs(ye,{"data-testid":"card-event-checkins",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(wo,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Event Check-ins"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"Learn how to check in to events, track attendance, and manage your team's schedule."})})]}),s.jsxs(ye,{"data-testid":"card-player-development",children:[s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(wo,{className:"h-5 w-5 text-[#FF6B35]"}),s.jsx(Ke,{className:"text-lg",children:"Player Development"})]}),s.jsx(xA,{className:"h-4 w-4 text-gray-400"})]})}),s.jsx(we,{children:s.jsx("p",{className:"text-gray-600",children:"Track player progress, view skill assessments, and earn badges and trophies."})})]})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"mb-12",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6","data-testid":"text-faq-title",children:"Frequently Asked Questions"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{"data-testid":"faq-account",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I create an account?"}),s.jsx("p",{className:"text-gray-600",children:`Download the BoxStat app and click "Register" to create a new account. You'll need to verify your email address before you can access all features.`})]}),s.jsxs("div",{"data-testid":"faq-checkin",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How does event check-in work?"}),s.jsx("p",{className:"text-gray-600",children:`Event check-in uses geo-fencing technology. You must be within 200 meters of the event location and within the event's time window to check in. Simply tap the "Check In" button on the event card.`})]}),s.jsxs("div",{"data-testid":"faq-teams",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I join a team?"}),s.jsx("p",{className:"text-gray-600",children:"Your coach will add you to a team roster. Once added, the team will appear in your dashboard and you'll receive notifications about team events and activities."})]}),s.jsxs("div",{"data-testid":"faq-privacy",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Is my data secure?"}),s.jsx("p",{className:"text-gray-600",children:"Yes! We take privacy seriously. Your personal information is encrypted and stored securely. You can control your privacy settings in the app's Settings menu."})]}),s.jsxs("div",{"data-testid":"faq-payments",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"How do I make payments?"}),s.jsx("p",{className:"text-gray-600",children:"Payments for fees, uniforms, and tournaments can be made securely through the app using Stripe. Navigate to the Payments section in your dashboard to view and pay any outstanding balances."})]})]})]}),s.jsx(Fl,{className:"my-12"}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-8 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4","data-testid":"text-contact-cta",children:"Still need help?"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Our support team is ready to assist you with any questions or issues."}),s.jsx(te,{asChild:!0,className:"bg-[#FF6B35] hover:bg-[#E55A2B]","data-testid":"button-contact-support",children:s.jsxs("a",{href:"mailto:support@boxstat.app",children:[s.jsx($i,{className:"mr-2 h-4 w-4"}),"Contact Support"]})})]}),s.jsxs("div",{className:"mt-12 text-center text-sm text-gray-500",children:[s.jsx("p",{"data-testid":"text-support-hours",children:"Support Hours: Monday - Friday, 9:00 AM - 6:00 PM EST"}),s.jsx("p",{className:"mt-2","data-testid":"text-support-footer",children:"BoxStat - Empowering Youth Basketball Programs"})]})]})]})}function t6(e){switch(e){case"badge_earned":return s.jsx(Jp,{className:"h-5 w-5 text-yellow-500"});case"trophy_progress":return s.jsx(Ai,{className:"h-5 w-5 text-amber-500"});case"event_rsvp_available":case"event_checkin_available":case"event_reminder":return s.jsx(dr,{className:"h-5 w-5 text-blue-500"});case"training_reminder":return s.jsx(g8,{className:"h-5 w-5 text-green-500"});case"skills_evaluation":return s.jsx(Aj,{className:"h-5 w-5 text-purple-500"});case"improvement_recommendation":return s.jsx(uj,{className:"h-5 w-5 text-indigo-500"});case"payment_due":return s.jsx(ba,{className:"h-5 w-5 text-red-500"});case"team_message":return s.jsx(kS,{className:"h-5 w-5 text-cyan-500"});default:return s.jsx(Pi,{className:"h-5 w-5 text-gray-500"})}}function n6(e){switch(e){case"high":return"border-l-red-500 bg-red-50/50 dark:bg-red-950/20";case"normal":return"border-l-blue-500 bg-blue-50/50 dark:bg-blue-950/20";case"low":return"border-l-gray-400 bg-gray-50/50 dark:bg-gray-950/20";default:return"border-l-gray-400"}}function QBe(){Wt();const[e,t]=j.useState("all"),[n,r]=j.useState(null),[i,a]=j.useState(!1),{toast:o}=Tt(),l=os(),{data:c=[],isLoading:d}=Ge({queryKey:["/api/notifications",{hideReadAfterHours:24}],queryFn:()=>bt("/api/notifications?hideReadAfterHours=24"),enabled:e==="all"}),{data:u=[],isLoading:h}=Ge({queryKey:["/api/notifications",{unreadOnly:!0}],queryFn:()=>bt("/api/notifications?unreadOnly=true"),enabled:e==="unread"}),f=e==="all"?c:u,m=e==="all"?d:h,y=ot({mutationFn:_=>bt(`/api/notifications/${_}/read`,{method:"POST"}),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/notifications"]}),l.invalidateQueries({queryKey:["/api/notifications/unread-count"]})},onError:()=>{o({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}),x=ot({mutationFn:()=>bt("/api/notifications/read-all",{method:"POST"}),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/notifications"]}),l.invalidateQueries({queryKey:["/api/notifications/unread-count"]}),o({title:"Success",description:"All notifications marked as read"})},onError:()=>{o({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}}),b=_=>{r(_),a(!0),_.isRead||y.mutate(_.id)},g=()=>{x.mutate()},v=u.length;return s.jsxs("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b sticky top-0 z-10",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(te,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),"data-testid":"button-back",children:s.jsx(vn,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Notifications"}),v>0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[v," unread notification",v!==1?"s":""]})]})]}),v>0&&s.jsxs(te,{variant:"outline",size:"sm",onClick:g,disabled:x.isPending,"data-testid":"button-mark-all-read-page",children:[s.jsx(Ra,{className:"h-4 w-4 mr-2"}),"Mark all read"]})]})})}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsxs(My,{value:e,onValueChange:_=>t(_),children:[s.jsxs(Fg,{className:"grid w-full max-w-md grid-cols-2 mb-6","data-testid":"tabs-notifications",children:[s.jsxs(Wr,{value:"all","data-testid":"tab-all",children:["All",c.length>0&&s.jsx(et,{variant:"secondary",className:"ml-2",children:c.length})]}),s.jsxs(Wr,{value:"unread","data-testid":"tab-unread",children:["Unread",v>0&&s.jsx(et,{variant:"destructive",className:"ml-2",children:v})]})]}),s.jsx(Gr,{value:"all",className:"mt-0",children:m?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Loading notifications..."})]})}):f.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx(Pi,{className:"h-16 w-16 text-muted-foreground/30 mx-auto mb-4"}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You don't have any notifications at the moment."})]})}):s.jsx("div",{className:"space-y-2",children:f.map(_=>{var B;return s.jsxs(ye,{className:`cursor-pointer hover:shadow-md transition-all border-l-4 ${n6(_.priority)} ${_.isRead?"":"bg-accent/30"}`,onClick:()=>b(_),"data-testid":`notification-card-${_.id}`,children:[s.jsx(Ve,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:t6(((B=_.types)==null?void 0:B[0])||"notification")}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx(Ke,{className:`text-base leading-tight ${_.isRead?"":"font-bold"}`,children:_.title}),!_.isRead&&s.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full flex-shrink-0 mt-1"})]}),s.jsx(zn,{className:"mt-2 line-clamp-2",children:_.message})]})]})}),s.jsx(we,{className:"pt-0 pb-3",children:s.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground pl-8",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"h-3 w-3"}),L0(new Date(_.createdAt),{addSuffix:!0})]}),_.priority==="high"&&s.jsx(et,{variant:"destructive",className:"text-xs px-1.5 py-0",children:"Urgent"}),_.isRead&&s.jsx(et,{variant:"outline",className:"text-xs px-1.5 py-0",children:"Read"})]})})]},_.id)})})}),s.jsx(Gr,{value:"unread",className:"mt-0",children:m?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Loading notifications..."})]})}):f.length===0?s.jsx(ye,{children:s.jsxs(we,{className:"p-12 text-center",children:[s.jsx(Ra,{className:"h-16 w-16 text-green-500/30 mx-auto mb-4"}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:"All caught up!"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You've read all your notifications."})]})}):s.jsx("div",{className:"space-y-2",children:f.map(_=>{var B;return s.jsxs(ye,{className:`cursor-pointer hover:shadow-md transition-all border-l-4 ${n6(_.priority)} bg-accent/30`,onClick:()=>b(_),"data-testid":`notification-card-${_.id}`,children:[s.jsx(Ve,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:t6(((B=_.types)==null?void 0:B[0])||"notification")}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx(Ke,{className:"text-base leading-tight font-bold",children:_.title}),s.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full flex-shrink-0 mt-1"})]}),s.jsx(zn,{className:"mt-2 line-clamp-2",children:_.message})]})]})}),s.jsx(we,{className:"pt-0 pb-3",children:s.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground pl-8",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ar,{className:"h-3 w-3"}),L0(new Date(_.createdAt),{addSuffix:!0})]}),_.priority==="high"&&s.jsx(et,{variant:"destructive",className:"text-xs px-1.5 py-0",children:"Urgent"})]})})]},_.id)})})})]})}),s.jsx(PK,{notification:n,open:i,onOpenChange:a,onMarkAsRead:_=>y.mutate(_)})]})}function MBe(){return j.useEffect(()=>{fetch("/api/auth/logout",{method:"POST"}).then(()=>{hn.clear(),window.location.href="/"}).catch(()=>{window.location.href="/"})},[]),s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),s.jsx("p",{children:"Logging out..."})]})})}const RBe=[{value:"PG",label:"PG - Point Guard"},{value:"SG",label:"SG - Shooting Guard"},{value:"SF",label:"SF - Small Forward"},{value:"PF",label:"PF - Power Forward"},{value:"C",label:"C - Center"}],OBe=[`4'4"`,`4'5"`,`4'6"`,`4'7"`,`4'8"`,`4'9"`,`4'10"`,`4'11"`,`5'0"`,`5'1"`,`5'2"`,`5'3"`,`5'4"`,`5'5"`,`5'6"`,`5'7"`,`5'8"`,`5'9"`,`5'10"`,`5'11"`,`6'0"`,`6'1"`,`6'2"`,`6'3"`,`6'4"`,`6'5"`,`6'6"`,`6'7"`,`6'8"`,`6'9"`,`6'10"`],HBe=["9","10","11","12","13","14","15","16","17","18"],VBe=Array.from({length:99},(e,t)=>(t+1).toString());function KBe(){var v,_;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),i=typeof window<"u"?localStorage.getItem("selectedPlayerId"):null,a=(e==null?void 0:e.activeProfileId)||i||(e==null?void 0:e.id),{data:o,isLoading:l}=Ge({queryKey:[`/api/profile/${a}`],enabled:!!a}),[c,d]=j.useState({firstName:"",lastName:"",position:"",jerseyNumber:"",city:"",age:"",height:"",phoneNumber:"",emergencyContact:"",emergencyPhone:"",medicalInfo:"",allergies:""});Ft.useEffect(()=>{var B;o&&d({firstName:o.firstName||"",lastName:o.lastName||"",position:o.position||"",jerseyNumber:((B=o.jerseyNumber)==null?void 0:B.toString())||"",city:(o==null?void 0:o.city)||o.address||"",age:(o==null?void 0:o.age)||"",height:(o==null?void 0:o.height)||"",phoneNumber:o.phoneNumber||"",emergencyContact:o.emergencyContact||"",emergencyPhone:o.emergencyPhone||"",medicalInfo:o.medicalInfo||"",allergies:o.allergies||""})},[o,e]);const u=j.useRef(null),[h,f]=j.useState(null),[m,y]=j.useState(null),x=ot({mutationFn:async B=>{const I=e==null?void 0:e.id,Q=new FormData;Q.append("photo",B);const F=`/api/upload-profile-photo?profileId=${a}`,P=await fetch(F,{method:"POST",credentials:"include",body:Q});if(!P.ok)throw new Error("Upload failed");return{result:await P.json(),accountId:I}},onSuccess:async({accountId:B})=>{t({title:"Success",description:"Profile photo updated successfully!"}),await n.invalidateQueries({queryKey:[`/api/profile/${a}`],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profile/${B}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/child-profiles",B],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),f(null),m&&(URL.revokeObjectURL(m),y(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),b=B=>{var Q;const I=(Q=B.target.files)==null?void 0:Q[0];if(I){if(I.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!I.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}f(I);const F=URL.createObjectURL(I);y(F),x.mutate(I)}},g=ot({mutationFn:async B=>{const I={...B,address:B.city,jerseyNumber:B.jerseyNumber?parseInt(B.jerseyNumber):null};return await bt(`/api/profile/${a}`,{method:"PATCH",data:I})},onSuccess:B=>{var Q;d({firstName:B.firstName||"",lastName:B.lastName||"",position:B.position||"",jerseyNumber:((Q=B.jerseyNumber)==null?void 0:Q.toString())||"",city:B.address||"",age:B.age||"",height:B.height||"",phoneNumber:B.phoneNumber||"",emergencyContact:B.emergencyContact||"",emergencyPhone:B.emergencyPhone||"",medicalInfo:B.medicalInfo||"",allergies:B.allergies||""});const I=e==null?void 0:e.id;n.setQueryData([`/api/profile/${a}`],B),n.invalidateQueries({queryKey:[`/api/profile/${a}`]}),n.invalidateQueries({queryKey:[`/api/profile/${I}`]}),n.invalidateQueries({queryKey:[`/api/players/${a}/profile`]}),n.invalidateQueries({queryKey:[`/api/players/${I}/profile`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/child-profiles",I]}),n.invalidateQueries({queryKey:["/api/users",I]}),n.invalidateQueries({queryKey:["/api/users"]}),t({title:"Profile Updated",description:"Your player profile has been successfully updated."})},onError:B=>{t({title:"Failed to Update Profile",description:(B==null?void 0:B.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Player Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Basketball info and personal details"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:m||(o==null?void 0:o.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((v=c.firstName)==null?void 0:v[0])||""}${((_=c.lastName)==null?void 0:_[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var B;return(B=u.current)==null?void 0:B.click()},disabled:x.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),x.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:b,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:c.firstName,onChange:B=>d(I=>({...I,firstName:B.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:c.lastName,onChange:B=>d(I=>({...I,lastName:B.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Age"}),s.jsxs(Qt,{value:c.age,onValueChange:B=>d(I=>({...I,age:B})),children:[s.jsx(Ut,{"data-testid":"select-age",children:s.jsx(Mt,{placeholder:"Select age"})}),s.jsx(Dt,{children:HBe.map(B=>s.jsx(xe,{value:B,children:B},B))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Height"}),s.jsxs(Qt,{value:c.height,onValueChange:B=>d(I=>({...I,height:B})),children:[s.jsx(Ut,{"data-testid":"select-height",children:s.jsx(Mt,{placeholder:"Select height"})}),s.jsx(Dt,{children:OBe.map(B=>s.jsx(xe,{value:B,children:B},B))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"City (From)"}),s.jsx(qe,{value:c.city,onChange:B=>d(I=>({...I,city:B.target.value})),placeholder:"Enter your city","data-testid":"input-city"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone Number"}),s.jsx(qe,{value:c.phoneNumber,onChange:B=>d(I=>({...I,phoneNumber:B.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Basketball Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Position"}),s.jsxs(Qt,{value:c.position,onValueChange:B=>d(I=>({...I,position:B})),children:[s.jsx(Ut,{"data-testid":"select-position",children:s.jsx(Mt,{placeholder:"Select position"})}),s.jsx(Dt,{children:RBe.map(B=>s.jsx(xe,{value:B.value,children:B.label},B.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Jersey Number"}),s.jsxs(Qt,{value:c.jerseyNumber,onValueChange:B=>d(I=>({...I,jerseyNumber:B})),children:[s.jsx(Ut,{"data-testid":"select-jersey",children:s.jsx(Mt,{placeholder:"Select number"})}),s.jsx(Dt,{children:VBe.map(B=>s.jsxs(xe,{value:B,children:["#",B]},B))})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Emergency Contact Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:c.emergencyContact,onChange:B=>d(I=>({...I,emergencyContact:B.target.value})),placeholder:"Enter emergency contact name","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Phone"}),s.jsx(qe,{value:c.emergencyPhone,onChange:B=>d(I=>({...I,emergencyPhone:B.target.value})),placeholder:"Enter emergency phone number","data-testid":"input-emergency-phone"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Medical Information"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Medical Information"}),s.jsx(Vs,{value:c.medicalInfo,onChange:B=>d(I=>({...I,medicalInfo:B.target.value})),placeholder:"Enter any medical information coaches should know about",rows:3,"data-testid":"textarea-medical-info"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Include any conditions, medications, or medical notes"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allergies"}),s.jsx(Vs,{value:c.allergies,onChange:B=>d(I=>({...I,allergies:B.target.value})),placeholder:"Enter any allergies",rows:2,"data-testid":"textarea-allergies"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"List any known allergies or dietary restrictions"})]})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>g.mutate(c),disabled:g.isPending||l,className:"px-8","data-testid":"button-save-profile",children:g.isPending?"Saving Changes...":l?"Loading Profile...":"Save Changes"})})]})]})})}function zBe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState(!0),{data:i}=Ge({queryKey:["/api/privacy"],select:o=>(o==null?void 0:o.searchable)??!0});Ft.useEffect(()=>{i!==void 0&&r(i)},[i]);const a=ot({mutationFn:async o=>{const l=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:o})});if(!l.ok)throw new Error("Failed to update privacy settings");return l.json()},onSuccess:()=>{e({title:"Privacy settings updated"})},onError:()=>{e({title:"Failed to update privacy settings",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Privacy Settings"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Player Profile Visibility"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Allow other players and coaches to find your profile"})]}),s.jsx(cn,{checked:n,onCheckedChange:o=>{r(o),a.mutate({searchable:o})},"data-testid":"switch-profile-visibility"})]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.jsx("p",{children:"When enabled, your profile can be discovered by other players and coaches in the system. When disabled, your profile will only be visible to your team members and coaches."})})]})]})})]})})}function $Be(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({eventRsvp:!0,eventReminders:!0,eventCheckin:!0,trophyProgress:!0,badgeEarned:!0}),{data:i}=Ge({queryKey:["/api/notifications/preferences"]});Ft.useEffect(()=>{i&&r({eventRsvp:i.eventRsvp??!0,eventReminders:i.eventReminders??!0,eventCheckin:i.eventCheckin??!0,trophyProgress:i.trophyProgress??!0,badgeEarned:i.badgeEarned??!0})},[i]);const a=ot({mutationFn:async()=>{const l=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!l.ok)throw new Error("Failed to save preferences");return l.json()},onSuccess:()=>{e({title:"Notification settings saved"})},onError:()=>{e({title:"Failed to save notification settings",variant:"destructive"})}}),o=({label:l,checked:c,onChange:d,testId:u})=>s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:l}),s.jsx(cn,{checked:c,onCheckedChange:d,"data-testid":u})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notifications"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Event Notifications"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Event RSVP reminders",checked:n.eventRsvp,onChange:l=>r(c=>({...c,eventRsvp:l})),testId:"switch-event-rsvp"}),s.jsx(o,{label:"Event reminders",checked:n.eventReminders,onChange:l=>r(c=>({...c,eventReminders:l})),testId:"switch-event-reminders"}),s.jsx(o,{label:"Check-in availability",checked:n.eventCheckin,onChange:l=>r(c=>({...c,eventCheckin:l})),testId:"switch-event-checkin"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Achievement Notifications"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Trophy progress updates",checked:n.trophyProgress,onChange:l=>r(c=>({...c,trophyProgress:l})),testId:"switch-trophy-progress"}),s.jsx(o,{label:"Badge earned notifications",checked:n.badgeEarned,onChange:l=>r(c=>({...c,badgeEarned:l})),testId:"switch-badge-earned"})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>a.mutate(),disabled:a.isPending,"data-testid":"button-save-notifications",children:a.isPending?"Saving...":"Save Notification Settings"})})]})]})})}function qBe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(u=>u.profileType==="player"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your player profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:u=>{t({title:"Failed to Delete Profile",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),l=()=>{confirm("Are you sure you want to delete this player profile? This action cannot be undone and you will lose all your trophies and achievements.")&&o.mutate()},c=async()=>{try{await fetch("/api/logout",{method:"GET",credentials:"include"}),window.location.href="/"}catch(u){console.error("Logout error:",u),window.location.href="/"}},d=({icon:u,title:h,action:f,description:m})=>s.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(u,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium",children:h}),m&&s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m})]})]}),f]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Account & Security"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Password and device management"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-600 dark:text-red-400",children:"Danger Zone"})}),s.jsxs(we,{children:[s.jsx(d,{icon:Va,title:"Delete Player Profile",description:"Permanently delete this player profile and all associated data",action:s.jsx(te,{variant:"destructive",onClick:l,disabled:o.isPending||!a,"data-testid":"button-delete-player-profile",children:o.isPending?"Deleting...":"Delete Profile"})}),s.jsx(d,{icon:Hb,title:"Log Out",description:"Sign out of your account",action:s.jsx(te,{variant:"destructive",onClick:c,"data-testid":"button-logout",children:"Log Out"})})]})]})})]})})}function WBe(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState("unknown"),[i,a]=j.useState(!1),[o,l]=j.useState(null);Ft.useEffect(()=>{const h=navigator.userAgent,f=navigator.platform,m=navigator.language,y=`${screen.width}x${screen.height}`,x=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");l({platform:f,userAgent:h,language:m,screenSize:y,isPWA:x,cookiesEnabled:navigator.cookieEnabled,onlineStatus:navigator.onLine,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(b=>{r(b.state)})},[]);const c=async()=>{if(a(!0),!navigator.geolocation){e({title:"Location Not Supported",description:"Your browser doesn't support location services.",variant:"destructive"}),a(!1);return}navigator.geolocation.getCurrentPosition(h=>{r("granted"),e({title:"Location Permission Granted",description:`Location found: ${h.coords.latitude.toFixed(4)}, ${h.coords.longitude.toFixed(4)}`}),a(!1)},h=>{r("denied");let f="Unable to get location.";h.code===h.PERMISSION_DENIED?f="Location access was denied. Enable location in your browser settings and try again.":h.code===h.POSITION_UNAVAILABLE?f="Location information is unavailable.":h.code===h.TIMEOUT&&(f="Location request timed out."),e({title:"Location Permission Denied",description:f,variant:"destructive"}),a(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},d=()=>{switch(n){case"granted":return"text-green-600 dark:text-green-400";case"denied":return"text-red-600 dark:text-red-400";case"prompt":return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-600 dark:text-gray-400"}},u=()=>{switch(n){case"granted":return"Granted";case"denied":return"Denied";case"prompt":return"Not Set";default:return"Unknown"}};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Devices & Permissions"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage location access and device information"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"h-5 w-5"}),"Location Permission"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Location Access for Check-ins"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Status: ",s.jsx("span",{className:`font-medium ${d()}`,children:u()})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Location is required to check into events and verify attendance"})]}),s.jsx(te,{onClick:c,disabled:i,variant:n==="granted"?"outline":"default","data-testid":"button-test-location",children:i?"Testing...":n==="granted"?"Retest":"Enable Location"})]}),n==="denied"&&s.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-red-800 dark:text-red-200",children:"Location Permission Required"}),s.jsx("p",{className:"text-sm text-red-600 dark:text-red-300 mt-1",children:"To check into events, you need to enable location access:"}),s.jsxs("ul",{className:"text-xs text-red-600 dark:text-red-300 mt-2 ml-4 list-disc space-y-1",children:[s.jsx("li",{children:"Click the location icon in your browser's address bar"}),s.jsx("li",{children:'Select "Allow" for location access'}),s.jsx("li",{children:"Refresh the page and test again"})]})]}),n==="granted"&&s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-green-800 dark:text-green-200",children:"Location Permission Granted"}),s.jsx("p",{className:"text-sm text-green-600 dark:text-green-300 mt-1",children:"You can now check into events using your location."})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Current Device"]})}),s.jsx(we,{className:"space-y-4",children:o&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Platform"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-platform",children:o.platform})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Language"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-language",children:o.language})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Screen Size"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-screen",children:o.screenSize})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Timezone"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-timezone",children:o.timezone})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"App Mode"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-app-mode",children:o.isPWA?"Installed App":"Browser"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cookies Enabled"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-cookies",children:o.cookiesEnabled?"Yes":"No"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Online Status"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"device-online",children:o.onlineStatus?"Online":"Offline"})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Troubleshooting"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Location Issues"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 ml-4 list-disc space-y-1",children:[s.jsx("li",{children:"Make sure location services are enabled on your device"}),s.jsx("li",{children:"Check your browser's location settings"}),s.jsx("li",{children:"Try refreshing the page and testing again"}),s.jsx("li",{children:"For mobile: ensure the BoxStat app has location permission"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"App Installation"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:'Install the BoxStat app for the best experience: look for the "Install" or "Add to Home Screen" option in your browser.'})]})]})})]})]})]})})}function GBe(){Tt();const[,e]=Wt(),[t,n]=j.useState({termsAccepted:!0,privacyAccepted:!0,dataProcessingAccepted:!0,lastAccepted:new Date().toLocaleDateString()}),{data:r}=Ge({queryKey:["/api/legal/status"],initialData:{}});Ft.useEffect(()=>{r&&n({termsAccepted:r.termsAccepted??!0,privacyAccepted:r.privacyAccepted??!0,dataProcessingAccepted:r.dataProcessingAccepted??!0,lastAccepted:r.lastAccepted?new Date(r.lastAccepted).toLocaleDateString():new Date().toLocaleDateString()})},[r]);const i=o=>{const l={terms:"/terms-of-service",privacy:"/privacy-policy",data:"/data-processing-agreement"};window.open(l[o],"_blank")},a=({title:o,description:l,accepted:c,onView:d,testId:u})=>s.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-md font-medium text-gray-800 dark:text-gray-200",children:o}),c?s.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[s.jsx(Yp,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:"Accepted"})]}):s.jsxs("div",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[s.jsx(Fi,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:"Required"})]})]}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l})]}),s.jsxs(te,{variant:"outline",size:"sm",onClick:d,"data-testid":u,children:[s.jsx(wo,{className:"h-4 w-4 mr-2"}),"View"]})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>e("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal & Privacy"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Terms, privacy policy, and data agreements"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Agreement Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium text-green-800 dark:text-green-200",children:"All Agreements Accepted"}),s.jsxs("p",{className:"text-sm text-green-600 dark:text-green-300 mt-1",children:["Last updated: ",t.lastAccepted]})]}),s.jsx("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:s.jsx(Yp,{className:"h-5 w-5"})})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Legal Documents"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(a,{title:"Terms of Service",description:"Rules and conditions for using the BoxStat app",accepted:t.termsAccepted,onView:()=>i("terms"),testId:"button-view-terms"}),s.jsx(a,{title:"Privacy Policy",description:"How we collect, use, and protect your personal information",accepted:t.privacyAccepted,onView:()=>i("privacy"),testId:"button-view-privacy"}),s.jsx(a,{title:"Data Processing Agreement",description:"Details about how your data is processed and stored",accepted:t.dataProcessingAccepted,onView:()=>i("data"),testId:"button-view-data-processing"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(_y,{className:"h-5 w-5"}),"Your Data & Privacy"]})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Data We Collect"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Profile information (name, age, position)"}),s.jsx("li",{children:"â€¢ Basketball statistics and achievements"}),s.jsx("li",{children:"â€¢ Event attendance and check-ins"}),s.jsx("li",{children:"â€¢ Location data (only during check-ins)"}),s.jsx("li",{children:"â€¢ App usage and preferences"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"How We Use Your Data"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Track your basketball progress"}),s.jsx("li",{children:"â€¢ Verify event attendance"}),s.jsx("li",{children:"â€¢ Send relevant notifications"}),s.jsx("li",{children:"â€¢ Improve the app experience"}),s.jsx("li",{children:"â€¢ Team and coach communications"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Your Rights"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ View all your personal data"}),s.jsx("li",{children:"â€¢ Correct inaccurate information"}),s.jsx("li",{children:"â€¢ Delete your account and data"}),s.jsx("li",{children:"â€¢ Control notification preferences"}),s.jsx("li",{children:"â€¢ Opt out of data processing"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200",children:"Data Retention"}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1",children:[s.jsx("li",{children:"â€¢ Profile data: Until account deletion"}),s.jsx("li",{children:"â€¢ Basketball stats: 7 years"}),s.jsx("li",{children:"â€¢ Location data: 30 days"}),s.jsx("li",{children:"â€¢ Messages: 1 year"}),s.jsx("li",{children:"â€¢ Backup data: 90 days"})]})]})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($i,{className:"h-5 w-5"}),"Questions or Concerns?"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"If you have questions about our legal policies or your data privacy, please contact us:"}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:s.jsx("div",{className:"space-y-2 text-sm",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Email:"})," ",s.jsx("a",{href:"mailto:info@upyourperformance.org",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"info@upyourperformance.org"})]})})}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"For immediate concerns about data privacy or account security, please contact us as soon as possible."})]})})]})]})]})})}function ZBe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(l=>l.profileType==="player"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your player profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:l=>{t({title:"Failed to Delete Profile",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/player-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible profile actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Player Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your player profile while keeping your account and other profiles:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This player profile will be permanently removed"}),s.jsx("li",{children:"All your trophies, badges, and achievements will be lost"}),s.jsx("li",{children:"Your team statistics and progress data will be deleted"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new player profile anytime"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this player profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this player profile? This action cannot be undone and you will lose all your trophies and achievements.")&&o.mutate()},variant:"destructive",disabled:o.isPending||!a,"data-testid":"button-delete-player-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),o.isPending?"Deleting...":"Delete Player Profile"]})]})]})]})]})})}const YBe=["parent","guardian","grandparent","sibling"];function XBe(){var x,b;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[a,o]=j.useState({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",emergencyContact:"",emergencyPhone:"",occupation:"",workPhone:"",relationship:"parent"});Ft.useEffect(()=>{if(i){const g=i;o({firstName:g.firstName||"",lastName:g.lastName||"",email:(e==null?void 0:e.email)||"",phoneNumber:g.phoneNumber||"",address:g.address||"",emergencyContact:g.emergencyContact||"",emergencyPhone:g.emergencyPhone||"",occupation:g.occupation||"",workPhone:g.workPhone||"",relationship:g.relationship||"parent"})}},[i,e]);const l=j.useRef(null),[c,d]=j.useState(null),[u,h]=j.useState(null),f=ot({mutationFn:async g=>{const v=e==null?void 0:e.activeProfileId,_=e==null?void 0:e.id,B=v||_,I=new FormData;I.append("photo",g);const Q=`/api/upload-profile-photo?profileId=${B}`,F=await fetch(Q,{method:"POST",credentials:"include",body:I});if(!F.ok)throw new Error("Upload failed");return{result:await F.json(),activeProfileId:v,accountId:_}},onSuccess:async({activeProfileId:g,accountId:v})=>{t({title:"Success",description:"Profile photo updated successfully!"});try{const _=await fetch(`/api/profile/${g}`,{credentials:"include"});if(_.ok){const B=await _.json();n.setQueryData([`/api/profile/${g}`],B)}else await n.invalidateQueries({queryKey:[`/api/profile/${g}`],refetchType:"active"})}catch{await n.invalidateQueries({queryKey:[`/api/profile/${g}`],refetchType:"active"})}await n.invalidateQueries({queryKey:[`/api/players/${g}/profile`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/profiles/me"],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profiles/${v}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),d(null),u&&(URL.revokeObjectURL(u),h(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),m=g=>{var _;const v=(_=g.target.files)==null?void 0:_[0];if(v){if(v.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!v.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}d(v);const B=URL.createObjectURL(v);h(B),f.mutate(v)}},y=ot({mutationFn:async g=>await bt(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",data:g}),onSuccess:g=>{o({firstName:g.firstName||"",lastName:g.lastName||"",email:(e==null?void 0:e.email)||"",phoneNumber:g.phoneNumber||"",address:g.address||"",emergencyContact:g.emergencyContact||"",emergencyPhone:g.emergencyPhone||"",occupation:g.occupation||"",workPhone:g.workPhone||"",relationship:g.relationship||"parent"});const v=e==null?void 0:e.activeProfileId,_=e==null?void 0:e.id;n.setQueryData([`/api/profile/${v}`],g),n.invalidateQueries({queryKey:[`/api/profile/${v}`]}),n.invalidateQueries({queryKey:[`/api/players/${v}/profile`]}),n.invalidateQueries({queryKey:[`/api/players/${_}/profile`]}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${_}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:["/api/users"]}),t({title:"Profile Updated",description:"Your parent profile has been successfully updated."})},onError:g=>{t({title:"Failed to Update Profile",description:(g==null?void 0:g.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Parent Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Personal information and contact details"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:u||(e==null?void 0:e.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((x=a.firstName)==null?void 0:x[0])||""}${((b=a.lastName)==null?void 0:b[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var g;return(g=l.current)==null?void 0:g.click()},disabled:f.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),f.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:m,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:a.firstName,onChange:g=>o(v=>({...v,firstName:g.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:a.lastName,onChange:g=>o(v=>({...v,lastName:g.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx($i,{className:"h-4 w-4"}),"Email Address"]}),s.jsx(qe,{value:a.email,onChange:g=>o(v=>({...v,email:g.target.value})),placeholder:"Enter email address",type:"email","data-testid":"input-email"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(bg,{className:"h-4 w-4"}),"Phone Number"]}),s.jsx(qe,{value:a.phoneNumber,onChange:g=>o(v=>({...v,phoneNumber:g.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Work Phone"}),s.jsx(qe,{value:a.workPhone,onChange:g=>o(v=>({...v,workPhone:g.target.value})),placeholder:"Enter work phone number","data-testid":"input-work-phone"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(Yi,{className:"h-4 w-4"}),"Address"]}),s.jsx(Vs,{value:a.address,onChange:g=>o(v=>({...v,address:g.target.value})),placeholder:"Enter home address",rows:2,"data-testid":"textarea-address"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Occupation"}),s.jsx(qe,{value:a.occupation,onChange:g=>o(v=>({...v,occupation:g.target.value})),placeholder:"Enter your occupation","data-testid":"input-occupation"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Relationship to Child"}),s.jsxs(Qt,{value:a.relationship,onValueChange:g=>o(v=>({...v,relationship:g})),children:[s.jsx(Ut,{"data-testid":"select-relationship",children:s.jsx(Mt,{placeholder:"Select relationship"})}),s.jsx(Dt,{children:YBe.map(g=>s.jsx(xe,{value:g,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]})]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Emergency Contact Information"})}),s.jsx(we,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:a.emergencyContact,onChange:g=>o(v=>({...v,emergencyContact:g.target.value})),placeholder:"Enter emergency contact name","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Phone"}),s.jsx(qe,{value:a.emergencyPhone,onChange:g=>o(v=>({...v,emergencyPhone:g.target.value})),placeholder:"Enter emergency phone number","data-testid":"input-emergency-phone"})]})]})})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>y.mutate(a),disabled:y.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-profile",children:y.isPending?"Saving...":"Save Changes"})})]})]})})}function JBe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/privacy"],enabled:!!(e!=null&&e.id),initialData:{}}),[a,o]=j.useState({profileVisible:!0,contactInfoVisible:!1,allowCoachMessages:!0,shareProgressReports:!0,shareAttendanceData:!0,allowPhotoSharing:!1,showOnTeamDirectory:!0});Ft.useEffect(()=>{r&&o({profileVisible:r.profileVisible??!0,contactInfoVisible:r.contactInfoVisible??!1,allowCoachMessages:r.allowCoachMessages??!0,shareProgressReports:r.shareProgressReports??!0,shareAttendanceData:r.shareAttendanceData??!0,allowPhotoSharing:r.allowPhotoSharing??!1,showOnTeamDirectory:r.showOnTeamDirectory??!0})},[r]);const l=ot({mutationFn:async c=>{const d=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:c})});if(!d.ok)throw new Error("Failed to update privacy settings");return d.json()},onSuccess:()=>{t({title:"Privacy Settings Updated",description:"Your privacy preferences have been saved."})},onError:c=>{t({title:"Failed to Update Settings",description:(c==null?void 0:c.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing preferences"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Profile Visibility"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Make profile visible to other parents"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow other parents in your children's teams to see your profile"})]}),s.jsx(cn,{checked:a.profileVisible,onCheckedChange:c=>o(d=>({...d,profileVisible:c})),"data-testid":"switch-profile-visible"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Show contact information"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow coaches and other parents to see your contact details"})]}),s.jsx(cn,{checked:a.contactInfoVisible,onCheckedChange:c=>o(d=>({...d,contactInfoVisible:c})),"data-testid":"switch-contact-visible"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Show on team directory"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Appear in the team parent directory for communication"})]}),s.jsx(cn,{checked:a.showOnTeamDirectory,onCheckedChange:c=>o(d=>({...d,showOnTeamDirectory:c})),"data-testid":"switch-team-directory"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication Preferences"})}),s.jsx(we,{className:"space-y-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Allow coach messages"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive direct messages from your children's coaches"})]}),s.jsx(cn,{checked:a.allowCoachMessages,onCheckedChange:c=>o(d=>({...d,allowCoachMessages:c})),"data-testid":"switch-coach-messages"})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Data Sharing"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Share progress reports"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow sharing of children's progress reports with other family members"})]}),s.jsx(cn,{checked:a.shareProgressReports,onCheckedChange:c=>o(d=>({...d,shareProgressReports:c})),"data-testid":"switch-share-progress"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Share attendance data"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow coaches to share attendance information with other family members"})]}),s.jsx(cn,{checked:a.shareAttendanceData,onCheckedChange:c=>o(d=>({...d,shareAttendanceData:c})),"data-testid":"switch-share-attendance"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Allow photo sharing"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Permission for coaches to share photos/videos of your children"})]}),s.jsx(cn,{checked:a.allowPhotoSharing,onCheckedChange:c=>o(d=>({...d,allowPhotoSharing:c})),"data-testid":"switch-photo-sharing"})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-privacy",children:l.isPending?"Saving...":"Save Privacy Settings"})})]})]})})}function eSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/notifications/preferences"],enabled:!!(e!=null&&e.id),initialData:{}}),[a,o]=j.useState({childScheduleChanges:!0,practiceReminders:!0,gameReminders:!0,childAttendance:!0,childProgress:!0,badgeEarned:!0,trophyEarned:!0,paymentReminders:!0,paymentConfirmation:!0,coachMessages:!0,teamAnnouncements:!0,emergencyAlerts:!0,emailNotifications:!0,pushNotifications:!0,smsNotifications:!1,quietHoursStart:"22:00",quietHoursEnd:"07:00"});Ft.useEffect(()=>{r&&o({childScheduleChanges:r.childScheduleChanges??!0,practiceReminders:r.practiceReminders??!0,gameReminders:r.gameReminders??!0,childAttendance:r.childAttendance??!0,childProgress:r.childProgress??!0,badgeEarned:r.badgeEarned??!0,trophyEarned:r.trophyEarned??!0,paymentReminders:r.paymentReminders??!0,paymentConfirmation:r.paymentConfirmation??!0,coachMessages:r.coachMessages??!0,teamAnnouncements:r.teamAnnouncements??!0,emergencyAlerts:r.emergencyAlerts??!0,emailNotifications:r.emailNotifications??!0,pushNotifications:r.pushNotifications??!0,smsNotifications:r.smsNotifications??!1,quietHoursStart:r.quietHoursStart??"22:00",quietHoursEnd:r.quietHoursEnd??"07:00"})},[r]);const l=ot({mutationFn:async c=>{const d=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!d.ok)throw new Error("Failed to update notification preferences");return d.json()},onSuccess:()=>{t({title:"Notification Preferences Updated",description:"Your notification settings have been saved."})},onError:c=>{t({title:"Failed to Update Settings",description:(c==null?void 0:c.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notification Preferences"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications about your children"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"h-5 w-5"}),"Schedule & Activity Updates"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Schedule changes"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get notified when practice or game times change"})]}),s.jsx(cn,{checked:a.childScheduleChanges,onCheckedChange:c=>o(d=>({...d,childScheduleChanges:c})),"data-testid":"switch-schedule-changes"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Practice reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders 2 hours before practices"})]}),s.jsx(cn,{checked:a.practiceReminders,onCheckedChange:c=>o(d=>({...d,practiceReminders:c})),"data-testid":"switch-practice-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Game reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders 4 hours before games"})]}),s.jsx(cn,{checked:a.gameReminders,onCheckedChange:c=>o(d=>({...d,gameReminders:c})),"data-testid":"switch-game-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Attendance notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child checks in or misses practice/games"})]}),s.jsx(cn,{checked:a.childAttendance,onCheckedChange:c=>o(d=>({...d,childAttendance:c})),"data-testid":"switch-attendance"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Progress & Achievements"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Progress updates"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Weekly and monthly progress reports"})]}),s.jsx(cn,{checked:a.childProgress,onCheckedChange:c=>o(d=>({...d,childProgress:c})),"data-testid":"switch-progress"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Badge earned"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child earns new badges"})]}),s.jsx(cn,{checked:a.badgeEarned,onCheckedChange:c=>o(d=>({...d,badgeEarned:c})),"data-testid":"switch-badges"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Trophy earned"}),s.jsx("div",{className:"text-sm text-gray-500",children:"When your child earns trophies"})]}),s.jsx(cn,{checked:a.trophyEarned,onCheckedChange:c=>o(d=>({...d,trophyEarned:c})),"data-testid":"switch-trophies"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment & Billing"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Payment reminders"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Reminders for upcoming payments"})]}),s.jsx(cn,{checked:a.paymentReminders,onCheckedChange:c=>o(d=>({...d,paymentReminders:c})),"data-testid":"switch-payment-reminders"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Payment confirmations"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Confirmation when payments are processed"})]}),s.jsx(cn,{checked:a.paymentConfirmation,onCheckedChange:c=>o(d=>({...d,paymentConfirmation:c})),"data-testid":"switch-payment-confirmation"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Coach messages"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Direct messages from coaches"})]}),s.jsx(cn,{checked:a.coachMessages,onCheckedChange:c=>o(d=>({...d,coachMessages:c})),"data-testid":"switch-coach-messages"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Team announcements"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Important team announcements and updates"})]}),s.jsx(cn,{checked:a.teamAnnouncements,onCheckedChange:c=>o(d=>({...d,teamAnnouncements:c})),"data-testid":"switch-announcements"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Emergency alerts"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Urgent safety or emergency notifications (always enabled)"})]}),s.jsx(cn,{checked:!0,disabled:!0,"data-testid":"switch-emergency"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Delivery Methods"})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Email notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications via email"})]}),s.jsx(cn,{checked:a.emailNotifications,onCheckedChange:c=>o(d=>({...d,emailNotifications:c})),"data-testid":"switch-email"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Push notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications on your device"})]}),s.jsx(cn,{checked:a.pushNotifications,onCheckedChange:c=>o(d=>({...d,pushNotifications:c})),"data-testid":"switch-push"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"SMS notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications via text message"})]}),s.jsx(cn,{checked:a.smsNotifications,onCheckedChange:c=>o(d=>({...d,smsNotifications:c})),"data-testid":"switch-sms"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"h-5 w-5"}),"Quiet Hours"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Set hours when you don't want to receive non-emergency notifications"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Start Time"}),s.jsx(qe,{type:"time",value:a.quietHoursStart,onChange:c=>o(d=>({...d,quietHoursStart:c.target.value})),"data-testid":"input-quiet-start"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"End Time"}),s.jsx(qe,{type:"time",value:a.quietHoursEnd,onChange:c=>o(d=>({...d,quietHoursEnd:c.target.value})),"data-testid":"input-quiet-end"})]})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-notifications",children:l.isPending?"Saving...":"Save Notification Settings"})})]})]})})}function tSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),[r,i]=j.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,o]=j.useState(!1),[l,c]=j.useState([{id:"1",name:"iPhone 12",location:"New York, NY",lastActive:"Today"},{id:"2",name:"MacBook Pro",location:"New York, NY",lastActive:"2 hours ago"}]),d=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/password`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(f)});if(!m.ok)throw new Error("Failed to change password");return m.json()},onSuccess:()=>{i({currentPassword:"",newPassword:"",confirmPassword:""}),t({title:"Password Changed",description:"Your password has been successfully updated."})},onError:f=>{t({title:"Failed to Change Password",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),u=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/2fa`,{method:f?"POST":"DELETE",credentials:"include"});if(!m.ok)throw new Error(`Failed to ${f?"enable":"disable"} 2FA`);return m.json()},onSuccess:(f,m)=>{o(m),t({title:m?"2FA Enabled":"2FA Disabled",description:m?"Two-factor authentication has been enabled.":"Two-factor authentication has been disabled."})},onError:f=>{t({title:"Failed to Update 2FA",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),h=ot({mutationFn:async f=>{const m=await fetch(`/api/users/${e==null?void 0:e.id}/devices/${f}`,{method:"DELETE",credentials:"include"});if(!m.ok)throw new Error("Failed to remove device");return m.json()},onSuccess:(f,m)=>{c(y=>y.filter(x=>x.id!==m)),t({title:"Device Removed",description:"Device has been removed from your trusted devices."})},onError:f=>{t({title:"Failed to Remove Device",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Account & Security"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage your account security and access"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(jh,{className:"h-5 w-5"}),"Change Password"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),s.jsx(qe,{type:"password",value:r.currentPassword,onChange:f=>i(m=>({...m,currentPassword:f.target.value})),placeholder:"Enter current password","data-testid":"input-current-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),s.jsx(qe,{type:"password",value:r.newPassword,onChange:f=>i(m=>({...m,newPassword:f.target.value})),placeholder:"Enter new password","data-testid":"input-new-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),s.jsx(qe,{type:"password",value:r.confirmPassword,onChange:f=>i(m=>({...m,confirmPassword:f.target.value})),placeholder:"Confirm new password","data-testid":"input-confirm-password"})]}),s.jsx(te,{onClick:()=>d.mutate(r),disabled:d.isPending||!r.currentPassword||!r.newPassword||r.newPassword!==r.confirmPassword,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-change-password",children:d.isPending?"Changing...":"Change Password"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Two-Factor Authentication"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Enable Two-Factor Authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),s.jsx(cn,{checked:a,onCheckedChange:f=>u.mutate(f),"data-testid":"switch-2fa"})]}),a&&s.jsx("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg",children:s.jsx("div",{className:"text-green-800 dark:text-green-200 text-sm",children:"Two-factor authentication is enabled for your account. You'll need both your password and authentication code to sign in."})})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Trusted Devices"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:l.map(f=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:f.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[f.location," â€¢ Last active ",f.lastActive]})]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>h.mutate(f.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50","data-testid":`button-remove-device-${f.id}`,children:s.jsx(Va,{className:"h-4 w-4"})})]},f.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Session Management"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Sign out of all devices"}),s.jsx("div",{className:"text-sm text-gray-500",children:"This will sign you out of all devices except this one"})]}),s.jsx(te,{variant:"outline",className:"text-red-600 hover:text-red-800 border-red-300 hover:bg-red-50","data-testid":"button-signout-all",children:"Sign Out All"})]})})]})]})]})})}function nSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({googleCalendar:!1,appleCalendar:!1,stripePayments:!1,venmoPayments:!1}),i=ot({mutationFn:async({service:a,connect:o})=>{const l=await fetch(`/api/integrations/${a}`,{method:o?"POST":"DELETE",credentials:"include"});if(!l.ok)throw new Error(`Failed to ${o?"connect":"disconnect"} ${a}`);return l.json()},onSuccess:(a,o)=>{r(l=>({...l,[o.service]:o.connect})),e({title:o.connect?"Connected":"Disconnected",description:`${o.service} has been ${o.connect?"connected":"disconnected"}.`})},onError:a=>{e({title:"Connection Failed",description:(a==null?void 0:a.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Connections"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Connect external apps and services"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"h-5 w-5"}),"Calendar Sync"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:s.jsx(_y,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Google Calendar"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Export your visible BoxStat events to your personal Google Calendar"})]})]}),s.jsx(cn,{checked:n.googleCalendar,onCheckedChange:a=>i.mutate({service:"googleCalendar",connect:a}),"data-testid":"switch-google-calendar"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:s.jsx(BA,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Apple Calendar"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Sync with iPhone and Mac calendars"})]})]}),s.jsx(cn,{checked:n.appleCalendar,onCheckedChange:a=>i.mutate({service:"appleCalendar",connect:a}),"data-testid":"switch-apple-calendar"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment Methods"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center",children:s.jsx(ba,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Stripe Payments"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Credit cards and bank transfers"})]})]}),s.jsx(cn,{checked:n.stripePayments,onCheckedChange:a=>i.mutate({service:"stripePayments",connect:a}),"data-testid":"switch-stripe"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx(bg,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Venmo"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Quick mobile payments"})]})]}),s.jsx(cn,{checked:n.venmoPayments,onCheckedChange:a=>i.mutate({service:"venmoPayments",connect:a}),"data-testid":"switch-venmo"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Connected Services"})}),s.jsxs(we,{children:[s.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["You have ",Object.values(n).filter(Boolean).length," services connected"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(n).map(([a,o])=>o&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-sm text-green-700 dark:text-green-300 capitalize",children:a.replace(/([A-Z])/g," $1").trim()})]},a))}),Object.values(n).every(a=>!a)&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(V_,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("div",{className:"text-gray-500 mb-2",children:"No services connected"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Connect services to sync data and automate tasks"})]})]})]})]})]})})}function sSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState([{id:"liability-waiver",title:"Liability Waiver",description:"Release of liability for sports activities",signed:!0,signedDate:"2025-01-15",required:!0},{id:"photo-consent",title:"Photo & Video Consent",description:"Permission to use child's image in promotional materials",signed:!1,signedDate:null,required:!1},{id:"medical-emergency",title:"Medical Emergency Authorization",description:"Authorization for emergency medical treatment",signed:!0,signedDate:"2025-01-15",required:!0},{id:"code-of-conduct",title:"Parent Code of Conduct",description:"Agreement to follow team and league conduct standards",signed:!0,signedDate:"2025-01-15",required:!0}]),i=ot({mutationFn:async a=>{const o=await fetch(`/api/legal/agreements/${a}/sign`,{method:"POST",credentials:"include"});if(!o.ok)throw new Error("Failed to sign agreement");return o.json()},onSuccess:(a,o)=>{r(l=>l.map(c=>c.id===o?{...c,signed:!0,signedDate:new Date().toISOString().split("T")[0]}:c)),e({title:"Agreement Signed",description:"The legal agreement has been digitally signed."})},onError:a=>{e({title:"Failed to Sign Agreement",description:(a==null?void 0:a.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal Agreements"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage consent forms and legal agreements"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(wo,{className:"h-5 w-5"}),"Agreement Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(a=>a.signed).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Completed"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(a=>!a.signed&&a.required).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-600",children:n.filter(a=>!a.signed&&!a.required).length}),s.jsx("div",{className:"text-sm text-gray-500",children:"Optional"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Legal Documents"})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:n.map(a=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${a.signed?"bg-green-500":a.required?"bg-orange-500":"bg-gray-400"}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.title,a.required&&s.jsx("span",{className:"ml-2 text-red-500 text-sm",children:"*Required"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[a.description,a.signed&&a.signedDate&&s.jsxs("span",{className:"ml-2 text-green-600",children:["â€¢ Signed ",new Date(a.signedDate).toLocaleDateString()]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(te,{variant:"outline",size:"sm","data-testid":`button-view-${a.id}`,children:"View"}),!a.signed&&s.jsx(te,{onClick:()=>i.mutate(a.id),disabled:i.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":`button-sign-${a.id}`,children:i.isPending?"Signing...":"Sign"}),a.signed&&s.jsxs("div",{className:"flex items-center gap-1 text-green-600 text-sm font-medium",children:[s.jsx(wo,{className:"h-4 w-4"}),"Signed"]})]})]},a.id))})})]}),s.jsxs(ye,{className:"border-amber-200 bg-amber-50 dark:bg-amber-950 dark:border-amber-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Important Information"]})}),s.jsxs(we,{className:"space-y-3 text-amber-800 dark:text-amber-200 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"All required agreements must be signed before your child can participate in team activities."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"Digital signatures are legally binding and equivalent to handwritten signatures."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"You can download copies of all signed agreements at any time."})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-2 flex-shrink-0"}),s.jsx("div",{children:"Contact the team administrator if you have questions about any legal documents."})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Document Downloads"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Download all signed agreements"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get a PDF copy of all your signed legal documents"})]}),s.jsx(te,{variant:"outline",disabled:n.filter(a=>a.signed).length===0,"data-testid":"button-download-agreements",children:"Download PDF"})]})})]})]})]})})}function rSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),{data:r,isLoading:i}=Ge({queryKey:["/api/devices"],enabled:!!(e!=null&&e.id)}),[a,o]=j.useState({locationPermissions:!0,notificationPermissions:!0,cameraPermissions:!1,microphonePermissions:!1,autoLogin:!0,biometricLogin:!1,twoFactorEnabled:!1,trustedDevicesOnly:!1});Ft.useEffect(()=>{const u=r;u!=null&&u.settings&&o(h=>({...h,...u.settings}))},[r]);const l=ot({mutationFn:async u=>bt("/api/devices/settings",{method:"POST",data:u}),onSuccess:()=>{t({title:"Device Settings Updated",description:"Your device preferences have been saved."}),hn.invalidateQueries({queryKey:["/api/devices"]})},onError:u=>{t({title:"Failed to Update Settings",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),c=ot({mutationFn:async u=>bt(`/api/devices/${u}/revoke`,{method:"POST"}),onSuccess:()=>{t({title:"Device Access Revoked",description:"The device has been removed from your trusted devices."}),hn.invalidateQueries({queryKey:["/api/devices"]})},onError:u=>{t({title:"Failed to Revoke Access",description:(u==null?void 0:u.message)||"Please try again later.",variant:"destructive"})}}),d=(r==null?void 0:r.devices)||[{id:"current",name:"Current Device",type:"mobile",lastUsed:new Date().toISOString(),location:"Current Location",isCurrent:!0}];return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Device Management"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage trusted devices and app permissions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"App Permissions"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Location Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow app to access your location for check-ins and event notifications"})]}),s.jsx(cn,{checked:a.locationPermissions,onCheckedChange:u=>o(h=>({...h,locationPermissions:u})),"data-testid":"switch-location-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Receive notifications about your children's activities"})]}),s.jsx(cn,{checked:a.notificationPermissions,onCheckedChange:u=>o(h=>({...h,notificationPermissions:u})),"data-testid":"switch-notification-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Camera Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow taking photos for profile pictures and event sharing"})]}),s.jsx(cn,{checked:a.cameraPermissions,onCheckedChange:u=>o(h=>({...h,cameraPermissions:u})),"data-testid":"switch-camera-permissions"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Microphone Access"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Allow recording audio for voice messages (future feature)"})]}),s.jsx(cn,{checked:a.microphonePermissions,onCheckedChange:u=>o(h=>({...h,microphonePermissions:u})),"data-testid":"switch-microphone-permissions"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(jh,{className:"h-5 w-5"}),"Security & Access"]})}),s.jsxs(we,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Auto-login on trusted devices"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Stay logged in on devices you use regularly"})]}),s.jsx(cn,{checked:a.autoLogin,onCheckedChange:u=>o(h=>({...h,autoLogin:u})),"data-testid":"switch-auto-login"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Biometric authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Use fingerprint or face recognition for quick access"})]}),s.jsx(cn,{checked:a.biometricLogin,onCheckedChange:u=>o(h=>({...h,biometricLogin:u})),"data-testid":"switch-biometric-login"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Two-factor authentication"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Require additional verification for sensitive actions"})]}),s.jsx(cn,{checked:a.twoFactorEnabled,onCheckedChange:u=>o(h=>({...h,twoFactorEnabled:u})),"data-testid":"switch-two-factor"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Trusted devices only"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Restrict access to explicitly trusted devices"})]}),s.jsx(cn,{checked:a.trustedDevicesOnly,onCheckedChange:u=>o(h=>({...h,trustedDevicesOnly:u})),"data-testid":"switch-trusted-devices-only"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(BA,{className:"h-5 w-5"}),"Trusted Devices"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:d.map(u=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:u.type==="mobile"?s.jsx(BA,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):s.jsx(Bne,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[u.name,u.isCurrent&&s.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-full",children:"Current"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Last used: ",new Date(u.lastUsed).toLocaleDateString(),u.location&&` â€¢ ${u.location}`]})]})]}),!u.isCurrent&&s.jsx(te,{variant:"outline",size:"sm",onClick:()=>c.mutate(u.id),disabled:c.isPending,"data-testid":`button-revoke-${u.id}`,children:"Remove"})]},u.id))})})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(te,{onClick:()=>l.mutate(a),disabled:l.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-save-device-settings",children:l.isPending?"Saving...":"Save Device Settings"})})]})]})})}function iSe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),[i,a]=j.useState(!1),[o,l]=j.useState(""),{data:c=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),d=c.find(f=>f.profileType==="parent"),u=ot({mutationFn:async()=>{if(!(d!=null&&d.id))throw new Error("No profile found");return await bt(`/api/profiles/${d.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your parent profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:f=>{t({title:"Failed to Delete Profile",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}}),h=ot({mutationFn:async()=>{const f=await fetch(`/api/users/${e==null?void 0:e.id}`,{method:"DELETE",credentials:"include"});if(!f.ok)throw new Error("Failed to delete account");return f.json()},onSuccess:()=>{t({title:"Account Deleted",description:"Your account has been permanently deleted."}),window.location.href="/api/logout"},onError:f=>{t({title:"Failed to Delete Account",description:(f==null?void 0:f.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/parent-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible account actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Parent Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your parent profile while keeping your account and other profiles (like player profiles):"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This parent profile will be permanently removed"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new parent profile anytime"}),s.jsx("li",{children:"Your children's player profiles are not affected"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this parent profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this parent profile? This action cannot be undone.")&&u.mutate()},variant:"destructive",disabled:u.isPending||!d,"data-testid":"button-delete-parent-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),u.isPending?"Deleting...":"Delete Parent Profile"]})]})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Account"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Permanently delete your account and all associated data, including:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"All child profiles and their progress data"}),s.jsx("li",{children:"Payment history and billing information"}),s.jsx("li",{children:"Messages and communication history"}),s.jsx("li",{children:"Trophies, badges, and achievements"}),s.jsx("li",{children:"Photos and videos shared within the app"})]}),s.jsx("p",{className:"font-medium text-red-600 dark:text-red-400",children:"This action cannot be reversed. Your children will lose access to their accounts."})]}),i?s.jsxs("div",{className:"space-y-4 p-4 bg-red-50 dark:bg-red-950 border border-red-300 dark:border-red-700 rounded-lg",children:[s.jsx("div",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:'Type "DELETE MY ACCOUNT" to confirm account deletion:'}),s.jsx(qe,{value:o,onChange:f=>l(f.target.value),placeholder:"Type DELETE MY ACCOUNT",className:"border-red-300 focus:border-red-500","data-testid":"input-delete-confirm"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{onClick:()=>h.mutate(),disabled:o!=="DELETE MY ACCOUNT"||h.isPending,variant:"destructive","data-testid":"button-delete-account-confirm",children:h.isPending?"Deleting...":"Permanently Delete Account"}),s.jsx(te,{variant:"outline",onClick:()=>{a(!1),l("")},"data-testid":"button-cancel-delete",children:"Cancel"})]})]}):s.jsxs(te,{onClick:()=>a(!0),variant:"destructive","data-testid":"button-delete-account-initial",children:[s.jsx(qi,{className:"h-4 w-4 mr-2"}),"Delete Account"]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Export Your Data"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Download your data"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Get a copy of all your account data before deletion"})]}),s.jsx(te,{variant:"outline","data-testid":"button-export-data",children:"Export Data"})]})})]})]})]})})}function aSe({title:e,description:t,backPath:n,userType:r,category:i}){const[,a]=Wt();return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>a(n),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:e}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:t})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:e})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsxs("div",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["This ",i," settings page is currently under development."]}),s.jsxs("div",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Settings for ",r," users will be available here soon."]})]})})})]})})]})})}const oSe=["0-1 years","2-3 years","4-5 years","6-10 years","10+ years"];function lSe(){var b,g;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i}=Ge({queryKey:[`/api/profile/${e==null?void 0:e.activeProfileId}`],enabled:!!(e!=null&&e.activeProfileId)}),[a,o]=j.useState({firstName:"",lastName:"",phoneNumber:"",email:"",city:"",coachingExperience:"",yearsExperience:"",bio:"",previousTeams:"",playingExperience:"",philosophy:""});Ft.useEffect(()=>{i&&o({firstName:i.firstName||"",lastName:i.lastName||"",phoneNumber:i.phoneNumber||"",email:(e==null?void 0:e.email)||"",city:i.city||i.address||"",coachingExperience:(i==null?void 0:i.coachingExperience)||"",yearsExperience:(i==null?void 0:i.yearsExperience)||"",bio:(i==null?void 0:i.bio)||"",previousTeams:(i==null?void 0:i.previousTeams)||"",playingExperience:(i==null?void 0:i.playingExperience)||"",philosophy:(i==null?void 0:i.philosophy)||""})},[i,e]);const l=j.useRef(null),[c,d]=j.useState(null),[u,h]=j.useState(null),f=ot({mutationFn:async v=>{const _=e==null?void 0:e.activeProfileId,B=e==null?void 0:e.id,I=_||B,Q=new FormData;Q.append("photo",v);const F=`/api/upload-profile-photo?profileId=${I}`,P=await fetch(F,{method:"POST",credentials:"include",body:Q});if(!P.ok)throw new Error("Upload failed");return{result:await P.json(),activeProfileId:_,accountId:B}},onSuccess:async({activeProfileId:v,accountId:_})=>{t({title:"Success",description:"Profile photo updated successfully!"});try{const B=await fetch(`/api/profile/${v}`,{credentials:"include"});if(B.ok){const I=await B.json();n.setQueryData([`/api/profile/${v}`],I)}else await n.invalidateQueries({queryKey:[`/api/profile/${v}`],refetchType:"active"})}catch{await n.invalidateQueries({queryKey:[`/api/profile/${v}`],refetchType:"active"})}await n.invalidateQueries({queryKey:[`/api/players/${v}/profile`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/profiles/me"],refetchType:"active"}),await n.invalidateQueries({queryKey:[`/api/profiles/${_}`],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/auth/user"],refetchType:"active"}),await n.invalidateQueries({queryKey:["/api/account/players"],refetchType:"active"}),d(null),u&&(URL.revokeObjectURL(u),h(null))},onError:()=>{t({title:"Error",description:"Failed to upload photo. Please try again.",variant:"destructive"})}}),m=v=>{var B;const _=(B=v.target.files)==null?void 0:B[0];if(_){if(_.size>5*1024*1024){t({title:"Error",description:"File size must be less than 5MB",variant:"destructive"});return}if(!_.type.startsWith("image/")){t({title:"Error",description:"Please select an image file",variant:"destructive"});return}d(_);const I=URL.createObjectURL(_);h(I),f.mutate(_)}},y=ot({mutationFn:async v=>{const _={...v,address:v.city},B=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(_)});if(!B.ok)throw new Error("Failed to update coach profile");return B.json()},onSuccess:v=>{o({firstName:v.firstName||"",lastName:v.lastName||"",phoneNumber:v.phoneNumber||"",email:(e==null?void 0:e.email)||"",city:v.city||v.address||"",coachingExperience:v.coachingExperience||"",yearsExperience:v.yearsExperience||"",bio:v.bio||"",previousTeams:v.previousTeams||"",playingExperience:v.playingExperience||"",philosophy:v.philosophy||""});const _=e==null?void 0:e.activeProfileId,B=e==null?void 0:e.id;n.setQueryData([`/api/profile/${_}`],v),n.invalidateQueries({queryKey:[`/api/players/${_}/profile`]}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${B}`]}),n.invalidateQueries({queryKey:["/api/auth/user"]}),t({title:"Saved",description:"Your profile changes have been saved."})},onError:v=>{t({title:"Failed to Save",description:(v==null?void 0:v.message)||"Please try again.",variant:"destructive"})}}),x=()=>{y.mutate(a)};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/unified-account"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-account",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Account"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Coach Profile"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Personal information and coaching credentials"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Us,{className:"h-5 w-5"}),"Personal Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center py-4 border-b border-gray-200 dark:border-gray-700 mb-4",children:[s.jsxs(wr,{className:"h-16 w-16 mb-4",children:[s.jsx(Ur,{src:u||(e==null?void 0:e.profileImageUrl),alt:"Profile",className:"object-cover w-full h-full"}),s.jsx(br,{className:"text-sm font-bold bg-gray-300 dark:bg-gray-600",children:`${((b=a.firstName)==null?void 0:b[0])||""}${((g=a.lastName)==null?void 0:g[0])||""}`.toUpperCase()})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(te,{type:"button",variant:"outline",size:"sm",onClick:()=>{var v;return(v=l.current)==null?void 0:v.click()},disabled:f.isPending,"data-testid":"button-upload-profile-photo",children:[s.jsx(oj,{className:"h-4 w-4 mr-2"}),f.isPending?"Uploading...":"Change Photo"]})}),s.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:m,className:"hidden","data-testid":"input-profile-photo"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"First Name"}),s.jsx(qe,{value:a.firstName,onChange:v=>o(_=>({..._,firstName:v.target.value})),placeholder:"Enter first name","data-testid":"input-first-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Last Name"}),s.jsx(qe,{value:a.lastName,onChange:v=>o(_=>({..._,lastName:v.target.value})),placeholder:"Enter last name","data-testid":"input-last-name"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx($i,{className:"h-4 w-4"}),"Email Address"]}),s.jsx(qe,{value:a.email,onChange:v=>o(_=>({..._,email:v.target.value})),placeholder:"Enter email address",type:"email","data-testid":"input-email"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(bg,{className:"h-4 w-4"}),"Phone Number"]}),s.jsx(qe,{value:a.phoneNumber,onChange:v=>o(_=>({..._,phoneNumber:v.target.value})),placeholder:"Enter phone number","data-testid":"input-phone"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[s.jsx(Yi,{className:"h-4 w-4"}),"City"]}),s.jsx(qe,{value:a.city,onChange:v=>o(_=>({..._,city:v.target.value})),placeholder:"Enter your city","data-testid":"input-city"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx($u,{className:"h-5 w-5"}),"Coaching Experience"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Years of Experience"}),s.jsxs(Qt,{value:a.yearsExperience,onValueChange:v=>o(_=>({..._,yearsExperience:v})),children:[s.jsx(Ut,{"data-testid":"select-years-experience",children:s.jsx(Mt,{placeholder:"Select experience level"})}),s.jsx(Dt,{children:oSe.map(v=>s.jsx(xe,{value:v,children:v},v))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Coaching Bio"}),s.jsx(Vs,{value:a.bio,onChange:v=>o(_=>({..._,bio:v.target.value})),placeholder:"Tell players and parents about your coaching background and approach",rows:4,"data-testid":"textarea-bio"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This will be visible to players and parents"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Previous Teams/Organizations"}),s.jsx(Vs,{value:a.previousTeams,onChange:v=>o(_=>({..._,previousTeams:v.target.value})),placeholder:"List previous teams or organizations you've coached",rows:3,"data-testid":"textarea-previous-teams"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Playing Experience"}),s.jsx(Vs,{value:a.playingExperience,onChange:v=>o(_=>({..._,playingExperience:v.target.value})),placeholder:"Describe your playing background",rows:3,"data-testid":"textarea-playing-experience"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Coaching Philosophy"}),s.jsx(Vs,{value:a.philosophy,onChange:v=>o(_=>({..._,philosophy:v.target.value})),placeholder:"Share your coaching philosophy and what's important to you",rows:4,"data-testid":"textarea-philosophy"})]})]})]}),s.jsx("div",{className:"flex justify-end pb-6",children:s.jsx(te,{onClick:x,disabled:y.isPending,className:"bg-red-600 hover:bg-red-700 text-white px-8","data-testid":"button-save-profile",children:y.isPending?"Saving...":"Save Changes"})})]})]})})}function cSe(){var c,d,u,h;const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),[i,a]=j.useState({specialties:((c=e==null?void 0:e.specialties)==null?void 0:c.join(", "))||"",coachingLicense:(e==null?void 0:e.coachingLicense)||"",availability:(e==null?void 0:e.availability)||"",ageGroups:((d=e==null?void 0:e.ageGroups)==null?void 0:d.join(", "))||"",coachingStyle:(e==null?void 0:e.coachingStyle)||"",emergencyContact:(e==null?void 0:e.emergencyContact)||"",emergencyPhone:(e==null?void 0:e.emergencyPhone)||"",medicalCertifications:((u=e==null?void 0:e.medicalCertifications)==null?void 0:u.join(", "))||"",languages:((h=e==null?void 0:e.languages)==null?void 0:h.join(", "))||""}),o=ot({mutationFn:async f=>{const m={...f,specialties:f.specialties.split(",").map(x=>x.trim()).filter(Boolean),ageGroups:f.ageGroups.split(",").map(x=>x.trim()).filter(Boolean),medicalCertifications:f.medicalCertifications.split(",").map(x=>x.trim()).filter(Boolean),languages:f.languages.split(",").map(x=>x.trim()).filter(Boolean)},y=await fetch(`/api/profile/${e==null?void 0:e.activeProfileId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});if(!y.ok)throw new Error("Failed to update coaching info");return y.json()},onSuccess:f=>{var m,y,x,b;a({specialties:((m=f.specialties)==null?void 0:m.join(", "))||"",coachingLicense:f.coachingLicense||"",availability:f.availability||"",ageGroups:((y=f.ageGroups)==null?void 0:y.join(", "))||"",coachingStyle:f.coachingStyle||"",emergencyContact:f.emergencyContact||"",emergencyPhone:f.emergencyPhone||"",medicalCertifications:((x=f.medicalCertifications)==null?void 0:x.join(", "))||"",languages:((b=f.languages)==null?void 0:b.join(", "))||""}),n.invalidateQueries({queryKey:["/api/auth/user"]}),n.invalidateQueries({queryKey:[`/api/users/${e==null?void 0:e.id}`]}),t({title:"Saved",description:"Your changes have been saved."})},onError:f=>{t({title:"Failed to Save",description:(f==null?void 0:f.message)||"Please try again.",variant:"destructive"})}}),l=()=>{o.mutate(i)};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Coaching Information"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Coaching experience and qualifications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Availability & Emergency Contact"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Availability"}),s.jsx(Vs,{value:i.availability,onChange:f=>a(m=>({...m,availability:f.target.value})),onBlur:l,placeholder:"Describe your general availability (days, times, etc.)",rows:3,"data-testid":"textarea-availability"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Name"}),s.jsx(qe,{value:i.emergencyContact,onChange:f=>a(m=>({...m,emergencyContact:f.target.value})),onBlur:l,placeholder:"Emergency contact person","data-testid":"input-emergency-contact"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact Phone"}),s.jsx(qe,{value:i.emergencyPhone,onChange:f=>a(m=>({...m,emergencyPhone:f.target.value})),onBlur:l,placeholder:"Emergency contact phone","data-testid":"input-emergency-phone"})]})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Additional Information"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Medical/Safety Certifications"}),s.jsx(qe,{value:i.medicalCertifications,onChange:f=>a(m=>({...m,medicalCertifications:f.target.value})),onBlur:l,placeholder:"First Aid, CPR, etc. (comma separated)","data-testid":"input-medical-certs"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Languages Spoken"}),s.jsx(qe,{value:i.languages,onChange:f=>a(m=>({...m,languages:f.target.value})),onBlur:l,placeholder:"Languages (comma separated)","data-testid":"input-languages"})]})]})]})]})]})})}function dSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({profileVisible:!0,contactVisible:!0,scheduleVisible:!0,allowMessages:!0,allowPhoneCalls:!1,shareWithParents:!0,shareWithOtherCoaches:!0,dataSharing:!0}),{data:i}=Ge({queryKey:["/api/privacy"],select:l=>l||{}});Ft.useEffect(()=>{i&&r({profileVisible:i.profileVisible??!0,contactVisible:i.contactVisible??!0,scheduleVisible:i.scheduleVisible??!0,allowMessages:i.allowMessages??!0,allowPhoneCalls:i.allowPhoneCalls??!1,shareWithParents:i.shareWithParents??!0,shareWithOtherCoaches:i.shareWithOtherCoaches??!0,dataSharing:i.dataSharing??!0})},[i]);const a=ot({mutationFn:async l=>{const c=await fetch("/api/privacy",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({settings:l})});if(!c.ok)throw new Error("Failed to update privacy settings");return c.json()},onSuccess:()=>{e({title:"Privacy settings updated"})},onError:()=>{e({title:"Failed to update privacy settings",variant:"destructive"})}}),o=({label:l,description:c,checked:d,onChange:u,testId:h})=>s.jsxs("div",{className:"flex items-start justify-between py-3 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:l}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]}),s.jsx(cn,{checked:d,onCheckedChange:u,"data-testid":h,className:"ml-4"})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Privacy Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Control your visibility and data sharing"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Profile Visibility"})}),s.jsxs(we,{children:[s.jsx(o,{label:"Coach Profile Visible",description:"Allow players, parents, and other coaches to view your profile",checked:n.profileVisible,onChange:l=>{r(c=>({...c,profileVisible:l})),a.mutate({...n,profileVisible:l})},testId:"switch-profile-visible"}),s.jsx(o,{label:"Contact Information Visible",description:"Show your contact details to team members",checked:n.contactVisible,onChange:l=>{r(c=>({...c,contactVisible:l})),a.mutate({...n,contactVisible:l})},testId:"switch-contact-visible"}),s.jsx(o,{label:"Schedule Information Visible",description:"Allow others to see your coaching schedule and availability",checked:n.scheduleVisible,onChange:l=>{r(c=>({...c,scheduleVisible:l})),a.mutate({...n,scheduleVisible:l})},testId:"switch-schedule-visible"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Communication Preferences"})}),s.jsx(we,{children:s.jsx(o,{label:"Allow Messages",description:"Receive messages from players and parents through the app",checked:n.allowMessages,onChange:l=>{r(c=>({...c,allowMessages:l})),a.mutate({...n,allowMessages:l})},testId:"switch-allow-messages"})})]})]})]})})}function ASe(){const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({teamUpdates:!0,eventChanges:!0,playerCheckIn:!0,playerRsvp:!0,teamMessages:!0,playerAwards:!0,playerProgress:!0,pushNotifications:!0,emailNotifications:!0,smsNotifications:!1}),{data:i}=Ge({queryKey:["/api/notifications/preferences"]});Ft.useEffect(()=>{i&&r({teamUpdates:i.teamUpdates??!0,eventChanges:i.eventChanges??!0,playerCheckIn:i.playerCheckIn??!0,playerRsvp:i.playerRsvp??!0,teamMessages:i.teamMessages??!0,playerAwards:i.playerAwards??!0,playerProgress:i.playerProgress??!0,pushNotifications:i.pushNotifications??!0,emailNotifications:i.emailNotifications??!0,smsNotifications:i.smsNotifications??!1})},[i]);const a=ot({mutationFn:async()=>{const l=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!l.ok)throw new Error("Failed to save preferences");return l.json()},onSuccess:()=>{e({title:"Notification settings saved"})},onError:()=>{e({title:"Failed to save notification settings",variant:"destructive"})}}),o=({label:l,description:c,checked:d,onChange:u,testId:h})=>s.jsxs("div",{className:"flex items-start justify-between py-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:l}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]}),s.jsx(cn,{checked:d,onCheckedChange:u,"data-testid":h,className:"ml-4"})]});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Notifications"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage alerts and communications"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Pi,{className:"h-5 w-5"}),"Team Notifications"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Team Updates",description:"When a player sets one of your teams as their team",checked:n.teamUpdates,onChange:l=>r(c=>({...c,teamUpdates:l})),testId:"switch-team-updates"}),s.jsx(o,{label:"Event Changes",description:"Any changes to events in the calendar that you can see",checked:n.eventChanges,onChange:l=>r(c=>({...c,eventChanges:l})),testId:"switch-event-changes"}),s.jsx(o,{label:"Player Check-In Alerts",description:"When players in your roster check in to events",checked:n.playerCheckIn,onChange:l=>r(c=>({...c,playerCheckIn:l})),testId:"switch-player-checkin"}),s.jsx(o,{label:"Player RSVP Alerts",description:"When players in your roster RSVP to events",checked:n.playerRsvp,onChange:l=>r(c=>({...c,playerRsvp:l})),testId:"switch-player-rsvp"}),s.jsx(o,{label:"Team Messages",description:"Notifications for messages in teams you're a part of",checked:n.teamMessages,onChange:l=>r(c=>({...c,teamMessages:l})),testId:"switch-team-messages"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Player Development"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Player Awards",description:"When players earn badges or trophies",checked:n.playerAwards,onChange:l=>r(c=>({...c,playerAwards:l})),testId:"switch-player-awards"}),s.jsx(o,{label:"Player Progress",description:"When players make progress toward achievements",checked:n.playerProgress,onChange:l=>r(c=>({...c,playerProgress:l})),testId:"switch-player-progress"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Delivery Methods"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsx(o,{label:"Push Notifications",description:"Receive push notifications on your mobile device",checked:n.pushNotifications,onChange:l=>r(c=>({...c,pushNotifications:l})),testId:"switch-push-notifications"}),s.jsx(o,{label:"Email Notifications",description:"Receive notifications via email",checked:n.emailNotifications,onChange:l=>r(c=>({...c,emailNotifications:l})),testId:"switch-email-notifications"}),s.jsx(o,{label:"SMS Notifications",description:"Receive critical notifications via text message",checked:n.smsNotifications,onChange:l=>r(c=>({...c,smsNotifications:l})),testId:"switch-sms-notifications"})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>a.mutate(),disabled:a.isPending,className:"px-8","data-testid":"button-save-notifications",children:a.isPending?"Saving Settings...":"Save Settings"})})]})]})})}function uSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,a]=j.useState(!1),[o,l]=j.useState([{id:1,name:"iPhone 14",lastActive:"2025-09-15",current:!0},{id:2,name:"MacBook Pro",lastActive:"2025-09-14",current:!1}]),c=ot({mutationFn:async f=>{const m=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(f)});if(!m.ok)throw new Error("Failed to update password");return m.json()},onSuccess:()=>{r({currentPassword:"",newPassword:"",confirmPassword:""}),e({title:"Password updated successfully"})},onError:f=>{e({title:"Failed to update password",description:f.message,variant:"destructive"})}}),d=ot({mutationFn:async f=>{const m=await fetch("/api/auth/2fa",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({enabled:f})});if(!m.ok)throw new Error("Failed to update 2FA settings");return m.json()},onSuccess:f=>{a(f.enabled),e({title:f.enabled?"Two-factor authentication enabled":"Two-factor authentication disabled"})},onError:()=>{e({title:"Failed to update 2FA settings",variant:"destructive"})}}),u=async f=>{l(m=>m.filter(y=>y.id!==f)),e({title:"Device removed from trusted devices"})},h=n.currentPassword&&n.newPassword&&n.newPassword===n.confirmPassword&&n.newPassword.length>=8;return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Security Settings"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Password and account security management"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Change Password"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),s.jsx(qe,{type:"password",value:n.currentPassword,onChange:f=>r(m=>({...m,currentPassword:f.target.value})),placeholder:"Enter current password","data-testid":"input-current-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),s.jsx(qe,{type:"password",value:n.newPassword,onChange:f=>r(m=>({...m,newPassword:f.target.value})),placeholder:"Enter new password","data-testid":"input-new-password"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Password must be at least 8 characters long"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),s.jsx(qe,{type:"password",value:n.confirmPassword,onChange:f=>r(m=>({...m,confirmPassword:f.target.value})),placeholder:"Confirm new password","data-testid":"input-confirm-password"})]}),s.jsx(te,{onClick:()=>c.mutate(n),disabled:!h||c.isPending,"data-testid":"button-change-password",children:c.isPending?"Updating Password...":"Update Password"})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Two-Factor Authentication"})}),s.jsxs(we,{children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Two-Factor Authentication (2FA)"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Add an extra layer of security to your account"})]}),s.jsx(cn,{checked:i,onCheckedChange:f=>{a(f),d.mutate(f)},"data-testid":"switch-2fa"})]}),i&&s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[s.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Two-factor authentication is enabled. You'll need to use an authenticator app to sign in."}),s.jsx(te,{variant:"outline",size:"sm",className:"mt-2","data-testid":"button-2fa-setup",children:"View Recovery Codes"})]})]})]}),s.jsxs(ye,{children:[s.jsxs(Ve,{children:[s.jsx(Ke,{children:"Trusted Devices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Devices that you've used to sign in to your account"})]}),s.jsx(we,{className:"space-y-3",children:o.map(f=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",children:[f.name,f.current&&s.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Current"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Last active: ",f.lastActive]})]})]}),!f.current&&s.jsx(te,{variant:"outline",size:"sm",onClick:()=>u(f.id),"data-testid":`button-remove-device-${f.id}`,children:"Remove"})]},f.id))})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Activity"})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("span",{className:"text-sm",children:"Last login"}),s.jsx("span",{className:"text-sm text-gray-500",children:"September 15, 2025 - 11:43 PM"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("span",{className:"text-sm",children:"Password changed"}),s.jsx("span",{className:"text-sm text-gray-500",children:"September 10, 2025"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-sm",children:"Account created"}),s.jsx("span",{className:"text-sm text-gray-500",children:"August 1, 2025"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Session Management"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Log Out"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sign out of your account on this device"})]}),s.jsx(te,{variant:"outline",className:"text-red-600 hover:text-red-800 border-red-300 hover:bg-red-50",onClick:()=>window.location.href="/api/logout","data-testid":"button-logout",children:"Log Out"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Sign Out All Devices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This will sign you out of all devices except this one"})]}),s.jsx(te,{variant:"outline",className:"text-orange-600 hover:text-orange-800 border-orange-300 hover:bg-orange-50","data-testid":"button-signout-all",children:"Sign Out All"})]})]})]})]})]})})}function hSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({googleCalendar:!1,slack:!1,zoom:!1,stripeConnect:!1,syncEnabled:!0}),{data:i}=Ge({queryKey:["/api/connections"],select:l=>l||{}});Ft.useEffect(()=>{i&&r({googleCalendar:i.googleCalendar??!1,slack:i.slack??!1,zoom:i.zoom??!1,stripeConnect:i.stripeConnect??!1,syncEnabled:i.syncEnabled??!0})},[i]);const a=async(l,c)=>{try{if(!(await fetch(`/api/connections/${l}`,{method:c?"POST":"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error(`Failed to ${c?"connect":"disconnect"} ${l}`);r(u=>({...u,[l]:c})),e({title:`${l} ${c?"Connected":"Disconnected"}`,description:`Successfully ${c?"connected to":"disconnected from"} ${l}`})}catch(d){e({title:"Connection Error",description:d.message,variant:"destructive"})}},o=({title:l,description:c,icon:d,service:u,connected:h,testId:f})=>s.jsx(ye,{children:s.jsx(we,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:d}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:l}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:c}),h&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"Connected"})]})]})]}),s.jsx(te,{variant:h?"outline":"default",onClick:()=>a(u,!h),"data-testid":f,children:h?"Disconnect":"Connect"})]})})});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Connections & Integrations"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Connect external apps and services"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Calendar Integrations"}),s.jsx("div",{className:"space-y-4",children:s.jsx(o,{title:"Google Calendar",description:"Export your visible BoxStat events to your personal Google Calendar",icon:s.jsx(dr,{className:"h-5 w-5"}),service:"googleCalendar",connected:n.googleCalendar,testId:"button-google-calendar"})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Communication Tools"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(o,{title:"Slack",description:"Receive team notifications and updates in your Slack workspace",icon:s.jsx(V_,{className:"h-5 w-5"}),service:"slack",connected:n.slack,testId:"button-slack"}),s.jsx(o,{title:"Zoom",description:"Schedule and manage team meetings with Zoom integration",icon:s.jsx(V_,{className:"h-5 w-5"}),service:"zoom",connected:n.zoom,testId:"button-zoom"})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Payment Processing"}),s.jsx("div",{className:"space-y-4",children:s.jsx(o,{title:"Stripe Connect",description:"Receive direct payments for private coaching and camps",icon:s.jsx(ba,{className:"h-5 w-5"}),service:"stripeConnect",connected:n.stripeConnect,testId:"button-stripe"})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Sync Settings"})}),s.jsx(we,{children:s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Auto-sync Data"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically sync schedule and attendance data with connected services"})]}),s.jsx(cn,{checked:n.syncEnabled,onCheckedChange:l=>r(c=>({...c,syncEnabled:l})),"data-testid":"switch-auto-sync"})]})})]})]})]})})}function fSe(){const{user:e}=dn(),{toast:t}=Tt(),[,n]=Wt(),[r,i]=j.useState({paypalEmail:(e==null?void 0:e.paypalEmail)||"",venmoUsername:(e==null?void 0:e.venmoUsername)||"",bankAccount:(e==null?void 0:e.bankAccount)||"",routingNumber:(e==null?void 0:e.routingNumber)||"",taxId:(e==null?void 0:e.taxId)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||"",invoicePrefix:(e==null?void 0:e.invoicePrefix)||"COACH",autoInvoicing:!0});j.useState([{id:1,type:"PayPal",email:"coach@example.com",isDefault:!0},{id:2,type:"Bank Account",last4:"1234",isDefault:!1}]);const[a]=j.useState([{id:1,date:"2025-09-10",description:"Private lesson - John Smith",amount:75,status:"paid"},{id:2,date:"2025-09-08",description:"Team camp - Eagles",amount:200,status:"pending"},{id:3,date:"2025-09-05",description:"Skills training - Sarah Johnson",amount:50,status:"paid"}]),o=ot({mutationFn:async l=>{const c=await fetch(`/api/users/${e==null?void 0:e.id}/billing`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to update billing information");return c.json()},onSuccess:()=>{t({title:"Billing Information Updated",description:"Your payment and billing settings have been saved."})},onError:l=>{t({title:"Failed to Update Billing",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>n("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Billing & Payments"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage payment methods and billing settings"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(ba,{className:"h-5 w-5"}),"Payment Information"]})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PayPal Email"}),s.jsx(qe,{type:"email",value:r.paypalEmail,onChange:l=>i(c=>({...c,paypalEmail:l.target.value})),placeholder:"your@paypal.com","data-testid":"input-paypal-email"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Venmo Username"}),s.jsx(qe,{value:r.venmoUsername,onChange:l=>i(c=>({...c,venmoUsername:l.target.value})),placeholder:"@your-venmo","data-testid":"input-venmo"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Bank Account Number"}),s.jsx(qe,{value:r.bankAccount,onChange:l=>i(c=>({...c,bankAccount:l.target.value})),placeholder:"Account number","data-testid":"input-bank-account"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Routing Number"}),s.jsx(qe,{value:r.routingNumber,onChange:l=>i(c=>({...c,routingNumber:l.target.value})),placeholder:"Routing number","data-testid":"input-routing-number"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tax ID / SSN"}),s.jsx(qe,{value:r.taxId,onChange:l=>i(c=>({...c,taxId:l.target.value})),placeholder:"Tax ID or Social Security Number","data-testid":"input-tax-id"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Required for tax reporting purposes"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Coaching Rates & Invoicing"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Hourly Rate ($)"}),s.jsx(qe,{type:"number",value:r.hourlyRate,onChange:l=>i(c=>({...c,hourlyRate:l.target.value})),placeholder:"75","data-testid":"input-hourly-rate"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Invoice Prefix"}),s.jsx(qe,{value:r.invoicePrefix,onChange:l=>i(c=>({...c,invoicePrefix:l.target.value})),placeholder:"COACH","data-testid":"input-invoice-prefix"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"e.g., COACH-001, COACH-002"})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium",children:"Auto-generate Invoices"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically create invoices after coaching sessions"})]}),s.jsx(cn,{checked:r.autoInvoicing,onCheckedChange:l=>i(c=>({...c,autoInvoicing:l})),"data-testid":"switch-auto-invoicing"})]})]})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsx(Ke,{children:"Recent Transactions"})}),s.jsxs(we,{children:[s.jsx("div",{className:"space-y-3",children:a.map(l=>s.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:l.description}),s.jsx("div",{className:"text-xs text-gray-500",children:l.date})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-medium",children:["$",l.amount]}),s.jsx("div",{className:`text-xs px-2 py-1 rounded ${l.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:l.status})]})]},l.id))}),s.jsx("div",{className:"mt-4 pt-4 border-t",children:s.jsx(te,{variant:"outline",className:"w-full","data-testid":"button-view-all-transactions",children:"View All Transactions"})})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(te,{onClick:()=>o.mutate(r),disabled:o.isPending,className:"px-8","data-testid":"button-save-billing",children:o.isPending?"Saving Changes...":"Save Changes"})})]})]})})}function mSe(){return s.jsx(aSe,{title:"Devices",description:"Trusted devices and app permissions",backPath:"/coach-settings",userType:"coach",category:"devices"})}function pSe(){dn();const{toast:e}=Tt(),[,t]=Wt(),[n,r]=j.useState({coachingAgreement:!1,liabilityWaiver:!1,backgroundCheck:!1,safeSportTrained:!1,privacyPolicy:!1,codeOfConduct:!1}),[i]=j.useState([{id:"coaching-agreement",title:"Coaching Service Agreement",description:"Terms and conditions for coaching services",required:!0,signed:!0,signedDate:"2025-08-01"},{id:"liability-waiver",title:"Liability Waiver",description:"Release of liability for coaching activities",required:!0,signed:!0,signedDate:"2025-08-01"},{id:"background-check",title:"Background Check Authorization",description:"Consent for background check verification",required:!0,signed:!1,signedDate:null},{id:"safe-sport",title:"SafeSport Training Certificate",description:"Completion of mandatory SafeSport education",required:!0,signed:!1,signedDate:null},{id:"code-of-conduct",title:"Coach Code of Conduct",description:"Ethical guidelines and professional behavior standards",required:!0,signed:!0,signedDate:"2025-08-01"}]),{data:a}=Ge({queryKey:["/api/legal/status"],select:c=>c||{}});Ft.useEffect(()=>{a&&r({coachingAgreement:a.coachingAgreement??!1,liabilityWaiver:a.liabilityWaiver??!1,backgroundCheck:a.backgroundCheck??!1,safeSportTrained:a.safeSportTrained??!1,privacyPolicy:a.privacyPolicy??!1,codeOfConduct:a.codeOfConduct??!1})},[a]);const o=async c=>{try{if(!(await fetch(`/api/legal/sign/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error("Failed to sign document");e({title:"Document Signed",description:"Your signature has been recorded."})}catch(d){e({title:"Signing Error",description:d.message,variant:"destructive"})}},l=(c,d)=>{e({title:"Download Started",description:`Downloading ${d}...`})};return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>t("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Legal Documents & Agreements"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Manage coaching agreements and legal compliance"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(Fi,{className:"h-5 w-5"}),"Compliance Status"]})}),s.jsx(we,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Agreements"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"3/3"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Required agreements signed"})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Certifications"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"1/2"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Required certifications"})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Background Check"})]}),s.jsx("div",{className:"text-2xl font-bold",children:"0/1"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Verification pending"})]})]})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(wo,{className:"h-5 w-5"}),"Legal Documents"]})}),s.jsx(we,{children:s.jsx("div",{className:"space-y-4",children:i.map(c=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-1 rounded-full ${c.signed?"bg-green-100 text-green-600":c.required?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:s.jsx(wo,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c.title}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:c.description}),c.signed&&c.signedDate&&s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Signed on ",c.signedDate]}),!c.signed&&c.required&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Signature required"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{variant:"outline",size:"sm",onClick:()=>l(c.id,c.title),"data-testid":`button-download-${c.id}`,children:"View"}),!c.signed&&s.jsx(te,{size:"sm",onClick:()=>o(c.id),"data-testid":`button-sign-${c.id}`,children:"Sign"})]})]},c.id))})})]}),s.jsxs(ye,{children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Important Notices"]})}),s.jsx(we,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Background Check Required"}),s.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:"You must complete a background check authorization to continue coaching. This is required for all youth sports coaches."})]}),s.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"SafeSport Training"}),s.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:"Complete your SafeSport training to stay compliant with league requirements. Training must be renewed annually."}),s.jsx(te,{size:"sm",variant:"outline",className:"mt-2","data-testid":"button-safesport-training",children:"Start Training"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"Document Retention"}),s.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:"All signed documents are stored securely and maintained for legal compliance. You can request copies at any time."})]})]})})]})]})]})})}function gSe(){const{user:e}=dn(),{toast:t}=Tt(),n=os(),[,r]=Wt(),{data:i=[]}=Ge({queryKey:["/api/profiles/me"],enabled:!!(e!=null&&e.id)}),a=i.find(l=>l.profileType==="coach"),o=ot({mutationFn:async()=>{if(!(a!=null&&a.id))throw new Error("No profile found");return await bt(`/api/profiles/${a.id}`,{method:"DELETE"})},onSuccess:()=>{t({title:"Profile Deleted",description:"Your coach profile has been deleted successfully."}),n.invalidateQueries({queryKey:["/api/profiles/me"]}),n.invalidateQueries({queryKey:[`/api/profiles/${e==null?void 0:e.id}`]}),r("/profile-selection")},onError:l=>{t({title:"Failed to Delete Profile",description:(l==null?void 0:l.message)||"Please try again later.",variant:"destructive"})}});return s.jsx("div",{className:"scrollable-page bg-gray-50 dark:bg-gray-900 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>r("/coach-settings"),className:"text-gray-600 hover:text-gray-900","data-testid":"button-back-to-settings",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Back to Settings"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100","data-testid":"page-title",children:"Danger Zone"}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400","data-testid":"page-description",children:"Irreversible profile actions"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs(ye,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800",children:[s.jsx(Ve,{children:s.jsxs(Ke,{className:"text-red-800 dark:text-red-200 flex items-center gap-2",children:[s.jsx(qi,{className:"h-5 w-5"}),"Warning"]})}),s.jsx(we,{className:"text-red-800 dark:text-red-200 text-sm",children:"The actions in this section are permanent and cannot be undone. Please proceed with extreme caution."})]}),s.jsxs(ye,{className:"border-red-300",children:[s.jsx(Ve,{children:s.jsx(Ke,{className:"text-red-700 dark:text-red-300",children:"Delete Coach Profile"})}),s.jsxs(we,{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[s.jsx("p",{children:"Delete only your coach profile while keeping your account and other profiles:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[s.jsx("li",{children:"This coach profile will be permanently removed"}),s.jsx("li",{children:"Your team rosters and player evaluations will be reassigned"}),s.jsx("li",{children:"Your coaching history and statistics will be archived"}),s.jsx("li",{children:"Your account and other profiles will remain active"}),s.jsx("li",{children:"You can create a new coach profile anytime"})]}),s.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"This will delete only this coach profile, not your entire account."})]}),s.jsxs(te,{onClick:()=>{confirm("Are you sure you want to delete this coach profile? This action cannot be undone.")&&o.mutate()},variant:"destructive",disabled:o.isPending||!a,"data-testid":"button-delete-coach-profile",children:[s.jsx(Va,{className:"h-4 w-4 mr-2"}),o.isPending?"Deleting...":"Delete Coach Profile"]})]})]})]})]})})}function Fn({component:e}){const{user:t,isLoading:n}=dn(),[,r]=Wt();return n?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):t?s.jsx(e,{}):(r("/"),null)}const xSe=()=>s.jsx(Fn,{component:QBe}),s6=()=>s.jsx(Fn,{component:Z_e}),ySe=()=>s.jsx(Fn,{component:Y_e}),vSe=()=>s.jsx(Fn,{component:X_e}),wSe=()=>s.jsx(Fn,{component:f5e}),bSe=()=>s.jsx(Fn,{component:_fe}),r6=()=>s.jsx(Fn,{component:Vge}),jSe=()=>s.jsx(Fn,{component:v_e}),NSe=()=>s.jsx(Fn,{component:C5e}),CSe=()=>s.jsx(Fn,{component:cBe}),_Se=()=>s.jsx(Fn,{component:dBe}),BSe=()=>s.jsx(Fn,{component:ABe}),SSe=()=>s.jsx(Fn,{component:uBe}),kSe=()=>s.jsx(Fn,{component:KBe}),PSe=()=>s.jsx(Fn,{component:zBe}),ESe=()=>s.jsx(Fn,{component:$Be}),FSe=()=>s.jsx(Fn,{component:qBe}),TSe=()=>s.jsx(Fn,{component:WBe}),ISe=()=>s.jsx(Fn,{component:GBe}),LSe=()=>s.jsx(Fn,{component:ZBe}),USe=()=>s.jsx(Fn,{component:XBe}),DSe=()=>s.jsx(Fn,{component:JBe}),QSe=()=>s.jsx(Fn,{component:eSe}),MSe=()=>s.jsx(Fn,{component:tSe}),RSe=()=>s.jsx(Fn,{component:nSe}),OSe=()=>s.jsx(Fn,{component:sSe}),HSe=()=>s.jsx(Fn,{component:rSe}),VSe=()=>s.jsx(Fn,{component:iSe}),KSe=()=>s.jsx(Fn,{component:lSe}),zSe=()=>s.jsx(Fn,{component:cSe}),$Se=()=>s.jsx(Fn,{component:dSe}),qSe=()=>s.jsx(Fn,{component:ASe}),WSe=()=>s.jsx(Fn,{component:uSe}),GSe=()=>s.jsx(Fn,{component:hSe}),ZSe=()=>s.jsx(Fn,{component:fSe}),YSe=()=>s.jsx(Fn,{component:mSe}),XSe=()=>s.jsx(Fn,{component:pSe}),JSe=()=>s.jsx(Fn,{component:gSe}),e4e=()=>s.jsx(Fn,{component:P_e}),t4e=()=>s.jsx(Fn,{component:E_e}),n4e=()=>s.jsx(Fn,{component:F_e}),s4e=()=>s.jsx(Fn,{component:j5e}),r4e=()=>s.jsx(Fn,{component:N5e}),i4e=()=>s.jsx(Fn,{component:xBe}),a4e=()=>s.jsx(Fn,{component:mBe}),o4e=()=>s.jsx(Fn,{component:gBe});function l4e(){const{user:e,isLoading:t}=dn(),[,n]=Wt();return t?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e?(n("/home"),null):(n("/login"),null)}function c4e(){const[,e]=Wt();return j.useEffect(()=>{e("/home")},[e]),s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})}function d4e(){const{user:e,isLoading:t,isAuthenticated:n}=dn();return Wt(),n&&e&&(e!=null&&e.profileCompleted),j.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(i=>{console.log("SW registered: ",i)}).catch(i=>{console.log("SW registration failed: ",i)}),IBe().then(()=>{console.log("Deep link listeners initialized")});const r=i=>{console.error("Unhandled promise rejection:",i.reason),i.preventDefault()};return window.addEventListener("unhandledrejection",r),()=>{window.removeEventListener("unhandledrejection",r)}},[]),j.useEffect(()=>{n&&e&&(console.log("User authenticated, initializing push notifications..."),PBe().then(()=>{console.log("Push notification listeners set up"),EBe()}))},[n,e]),t?s.jsx("div",{className:"min-h-screen-safe bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):s.jsxs(Fee,{children:[s.jsx(Ct,{path:"/privacy",component:Ose}),s.jsx(Ct,{path:"/privacy-policy",component:Hse}),s.jsx(Ct,{path:"/support",component:DBe}),s.jsx(Ct,{path:"/notifications",component:xSe}),s.jsx(Ct,{path:"/teams",component:Fse}),s.jsx(Ct,{path:"/registration",component:WL}),s.jsx(Ct,{path:"/login",component:J_e}),s.jsx(Ct,{path:"/register",component:WL}),s.jsx(Ct,{path:"/verify-email",component:v5e}),s.jsx(Ct,{path:"/magic-link-login",component:w5e}),s.jsx(Ct,{path:"/logout",component:MBe}),s.jsx(Ct,{path:"/",component:zse}),s.jsx(Ct,{path:"/home",component:vSe}),s.jsx(Ct,{path:"/profile-gateway",component:ySe}),s.jsx(Ct,{path:"/parent-dashboard",component:s6}),s.jsx(Ct,{path:"/account",component:l4e}),s.jsx(Ct,{path:"/unified-account",component:s6}),s.jsx(Ct,{path:"/add-player",component:wSe}),s.jsx(Ct,{path:"/dashboard",component:c4e}),s.jsx(Ct,{path:"/player-dashboard",component:bSe}),s.jsx(Ct,{path:"/admin-dashboard",component:r6}),s.jsx(Ct,{path:"/coach-dashboard",component:jSe}),s.jsx(Ct,{path:"/admin",component:r6}),s.jsx(Ct,{path:"/search",component:C_e}),s.jsx(Ct,{path:"/teams/:slug",component:__e}),s.jsx(Ct,{path:"/players/:id",component:k_e}),s.jsx(Ct,{path:"/profile",component:NSe}),s.jsx(Ct,{path:"/settings",component:CSe}),s.jsx(Ct,{path:"/player-settings",component:_Se}),s.jsx(Ct,{path:"/coach-settings",component:BSe}),s.jsx(Ct,{path:"/parent-settings",component:SSe}),s.jsx(Ct,{path:"/player-settings/profile",component:kSe}),s.jsx(Ct,{path:"/player-settings/privacy",component:PSe}),s.jsx(Ct,{path:"/player-settings/notifications",component:ESe}),s.jsx(Ct,{path:"/player-settings/security",component:FSe}),s.jsx(Ct,{path:"/player-settings/devices",component:TSe}),s.jsx(Ct,{path:"/player-settings/legal",component:ISe}),s.jsx(Ct,{path:"/player-settings/danger",component:LSe}),s.jsx(Ct,{path:"/parent-settings/profile",component:USe}),s.jsx(Ct,{path:"/parent-settings/privacy",component:DSe}),s.jsx(Ct,{path:"/parent-settings/notifications",component:QSe}),s.jsx(Ct,{path:"/parent-settings/security",component:MSe}),s.jsx(Ct,{path:"/parent-settings/connections",component:RSe}),s.jsx(Ct,{path:"/parent-settings/legal",component:OSe}),s.jsx(Ct,{path:"/parent-settings/devices",component:HSe}),s.jsx(Ct,{path:"/parent-settings/danger",component:VSe}),s.jsx(Ct,{path:"/coach-settings/profile",component:KSe}),s.jsx(Ct,{path:"/coach-settings/coaching",component:zSe}),s.jsx(Ct,{path:"/coach-settings/privacy",component:$Se}),s.jsx(Ct,{path:"/coach-settings/notifications",component:qSe}),s.jsx(Ct,{path:"/coach-settings/security",component:WSe}),s.jsx(Ct,{path:"/coach-settings/connections",component:GSe}),s.jsx(Ct,{path:"/coach-settings/billing",component:ZSe}),s.jsx(Ct,{path:"/coach-settings/devices",component:YSe}),s.jsx(Ct,{path:"/coach-settings/legal",component:XSe}),s.jsx(Ct,{path:"/coach-settings
jackmeadows@Jacks-MacBook-Air ~ % 
